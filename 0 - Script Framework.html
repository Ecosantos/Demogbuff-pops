<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel Santos">
<meta name="dcterms.date" content="2025-04-25">

<title>A general framework to run analyses in Santos et al.xxxxx</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="0 - Script Framework_files/libs/clipboard/clipboard.min.js"></script>
<script src="0 - Script Framework_files/libs/quarto-html/quarto.js"></script>
<script src="0 - Script Framework_files/libs/quarto-html/popper.min.js"></script>
<script src="0 - Script Framework_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="0 - Script Framework_files/libs/quarto-html/anchor.min.js"></script>
<link href="0 - Script Framework_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="0 - Script Framework_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="0 - Script Framework_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="0 - Script Framework_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="0 - Script Framework_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A general framework to run analyses in Santos et al.xxxxx</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel Santos </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 25, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setting" class="level1">
<h1>0 - Setting</h1>
<section id="sessioninfo-and-package-versions" class="level2">
<h2 class="anchored" data-anchor-id="sessioninfo-and-package-versions">0.1. SessionInfo and package versions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Matrix products: default


locale:
[1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   
[3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      
[5] LC_TIME=Portuguese_Brazil.utf8    

time zone: America/Sao_Paulo
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] MCMCglmm_2.36     ape_5.8           coda_0.19-4.1     Matrix_1.7-0     
 [5] ggtree_3.14.0     treeio_1.30.0     tidybayes_3.0.7   rstatix_0.7.2    
 [9] vegan_2.6-8       lattice_0.22-6    permute_0.9-7     Rage_1.6.0       
[13] Rcompadre_1.3.0   factoextra_1.0.7  FactoMineR_2.11   viridis_0.6.5    
[17] viridisLite_0.4.2 scales_1.3.0      popdemo_1.3-1     popbio_2.8       
[21] lubridate_1.9.3   forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4      
[25] purrr_1.0.2       readr_2.1.5       tidyr_1.3.1       tibble_3.2.1     
[29] ggplot2_3.5.1     tidyverse_2.0.0  

loaded via a namespace (and not attached):
 [1] gridExtra_2.3        sandwich_3.1-1       rlang_1.1.4         
 [4] magrittr_2.0.3       multcomp_1.4-26      compiler_4.4.1      
 [7] mgcv_1.9-1           vctrs_0.6.5          pkgconfig_2.0.3     
[10] arrayhelpers_1.1-0   fastmap_1.2.0        backports_1.5.0     
[13] utf8_1.2.4           rmarkdown_2.29       tzdb_0.4.0          
[16] xfun_0.49            aplot_0.2.3          jsonlite_1.8.8      
[19] flashClust_1.01-2    broom_1.0.7          parallel_4.4.1      
[22] cluster_2.1.6        R6_2.5.1             stringi_1.8.4       
[25] RColorBrewer_1.1-3   car_3.1-3            estimability_1.5.1  
[28] Rcpp_1.0.13          knitr_1.49           zoo_1.8-12          
[31] splines_4.4.1        timechange_0.3.0     tidyselect_1.2.1    
[34] abind_1.4-8          yaml_2.3.10          codetools_0.2-20    
[37] withr_3.0.2          posterior_1.6.0      evaluate_1.0.1      
[40] gridGraphics_0.5-1   survival_3.6-4       ggdist_3.3.2        
[43] pillar_1.9.0         carData_3.0-5        DiagrammeR_1.0.11   
[46] tensorA_0.36.2.1     checkmate_2.3.2      DT_0.33             
[49] ggfun_0.1.7          distributional_0.5.0 generics_0.1.3      
[52] hms_1.1.3            munsell_0.5.1        tidytree_0.4.6      
[55] xtable_1.8-4         leaps_3.2            glue_1.7.0          
[58] cubature_2.1.1       lazyeval_0.2.2       emmeans_1.10.5      
[61] scatterplot3d_0.3-44 tools_4.4.1          fs_1.6.5            
[64] visNetwork_2.1.2     mvtnorm_1.2-5        grid_4.4.1          
[67] colorspace_2.1-1     patchwork_1.2.0      nlme_3.1-165        
[70] Formula_1.2-5        cli_3.6.3            fansi_1.0.6         
[73] expm_0.999-9         svUnit_1.0.6         corpcor_1.6.10      
[76] gtable_0.3.6         yulab.utils_0.1.8    digest_0.6.36       
[79] ggplotify_0.1.2      ggrepel_0.9.5        TH.data_1.1-2       
[82] htmlwidgets_1.6.4    htmltools_0.5.8.1    lifecycle_1.0.4     
[85] multcompView_0.1-10  MASS_7.3-61         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check package versions</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cbind(unlist(loadedNamespaces()),</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  unlist(lapply(</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   lapply(loadedNamespaces(),packageVersion),</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#       as.character)))%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#       data.frame()%&gt;%arrange(-desc(X1))%&gt;%as_tibble()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="readme" class="level1">
<h1>1. Readme</h1>
<!--# TODO: FALTA AJUSTAR A ORDEM DIREITO PARA REFLETIR AS MUDANÇAS NOS ARQUIVOS. Ex. TidyMCMC e Run MCMC in Google colab -->
<p>The following script provide the general framework used to analyse demographic buffering continuum in Santos et al.&nbsp;(<em>in review</em>). Population responses to environmental stochasticity are primarily driven by survival-reproduction trade-offs and mediated by aridity</p>
<ul>
<li>Intermediary code and data steps are sourced along the framework</li>
<li>Intermediary code and data include:
<ul>
<li>1 - Data cleaning and selection and its intermediary data</li>
<li>2 - Life history traits calculation and its intermediary data</li>
<li>3 - Climatic variables calculation</li>
<li>4 - Analyses with MCMCglmm
<ul>
<li>It includes a separate model selection analyses to decide the most plausible model to use along the analyses</li>
</ul></li>
<li>5 - Core function: Stochastic elasticities of variance</li>
</ul></li>
</ul>
</section>
<section id="data-selection-and-cleaning---load-population-models-phylogenetic-information" class="level1">
<h1>2. Data selection and cleaning - load population models &amp; phylogenetic information</h1>
<ul>
<li>Script avaliable in “1 - Data cleaning and selection.R”</li>
</ul>
<pre><code>file.edit("1 - Data cleaning and selection.R")</code></pre>
<ul>
<li>Produce two datasets:
<ul>
<li><code>CleanData.RDS</code>: Filter matrix singularity, presence of fecundity,individual matrices only</li>
<li><code>supertree.RDS</code>: extract supertree from MOSAIC database (<span class="citation" data-cites="bernard2023">Bernard et al. (<a href="#ref-bernard2023" role="doc-biblioref">2023</a>)</span>)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load cleaned data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>CleanData<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">"Data/CleanData.RDS"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>supertree<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">"Data/supertree.RDS"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Metadata<span class="ot">&lt;-</span>CleanData<span class="sc">$</span>Metadata</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>MetadataClean<span class="ot">&lt;-</span>CleanData<span class="sc">$</span>MetadataClean</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Reduce data to improve redability</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>MedatadaFinal<span class="ot">&lt;-</span>MetadataClean<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(lambda,Ecoregion,Binomial))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>MedatadaFinal<span class="ot">&lt;-</span>MedatadaFinal<span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(.,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            Metadata<span class="sc">%&gt;%</span><span class="fu">select</span>(ID,StudyStart, StudyDuration, StudyEnd)<span class="sc">%&gt;%</span><span class="fu">distinct</span>(),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(CleanData)   <span class="co">#Remove non-used data to improve memory usage</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="life-history-traits-calculate-life-history-traits" class="level1">
<h1>3. Life history traits <br> (Calculate life history traits)</h1>
<p>Script available in “2 - Life history traits calculation.R”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">file.edit</span>(<span class="st">"2 - Life history traits calculation.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Produces dataset <code>LHtraits.RDS</code>:</li>
<li>Calculate life history traits and detect outliers</li>
<li>Life history traits include:
<ul>
<li><code>D</code>: Reproductive window (<span class="math inline">\(L\)</span>)
<ul>
<li>Temporal spread of reproduction throughout life span as quantified by <span class="citation" data-cites="demetrius1974">Demetrius (<a href="#ref-demetrius1974" role="doc-biblioref">1974</a>)</span> ’s entropy (<span class="math inline">\(S\)</span>).
<ul>
<li>High/low <span class="math inline">\(S\)</span> values correspond to iteroparous/semelparous populations</li>
</ul></li>
</ul></li>
<li><code>La</code>: Mean age at first reproduction (<span class="math inline">\(L_a\)</span>)
<ul>
<li>Average amount of time from birth to reproduction</li>
</ul></li>
<li><code>LaProp</code>: Probability of an individual become reproductive along their lifetime (<span class="math inline">\(p_a\)</span>)</li>
<li><code>e</code>: Mean life expectancy (<span class="math inline">\(\eta _e\)</span>)</li>
<li><code>growth</code>: individual development (<span class="math inline">\(\gamma\)</span>)</li>
<li><code>H</code>: Distribution of mortality risk along the life cycle (<span class="math inline">\(H\)</span>)</li>
</ul></li>
<li><strong><code>mahal.dist</code></strong> The mahalanobis distance</li>
<li><code>is.outlier</code>: TRUE or FALSE to indicate outliers detected with Mahalanobis distance</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>LHtraits<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">"Data/LHtraits.RDS"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>LHtraits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               ID            La       LaProb           e            D
1    Drc2.151_550 -0.1380041113  1.086110513 -0.05901093  0.670785792
2    Drc2.151_548 -0.1120904829 -0.198418968 -0.05907052  0.494801325
3    Drc2.151_546 -0.0797205365 -0.941194722 -0.05923442  0.683458564
4    Drc2.151_547 -0.0742251260 -0.944478284 -0.05923672  0.740478128
5   Pnx2.399_1046 -0.1249452534 -0.704693154 -0.05920869 -0.384237106
6   Prm4.582_1157 -0.0871013034  0.339904139 -0.05843889 -0.101927419
7   Trll.304_1438 -0.0712299164 -0.802265318 -0.05893404  0.880116693
8   Trll.304_1442 -0.1192825597 -0.890646306 -0.05913522  0.840366358
9   Trll.304_1445 -0.1019075599 -0.922024551 -0.05907916  0.788866557
10  Trll.304_1446 -0.0952340710 -0.941512053 -0.05905617  0.781769435
11  Trll.304_1443 -0.0356065599 -0.683587487 -0.05879205  0.874264260
12  Trll.304_1437 -0.0326354300 -0.858014220 -0.05880436  0.825899908
13  Trll.304_1435 -0.1075783119 -0.926552371 -0.05907917  0.891351612
14  Trll.304_1439 -0.0823720096 -0.921123132 -0.05899872  0.815616187
15  Trll.304_1441 -0.1070046589 -0.933335247 -0.05909717  0.793383112
16  Trll.304_1444 -0.0781299964 -0.818548613 -0.05897730  0.832988230
17   Grcl.173_696 -0.1124764824 -0.797688162 -0.05908080  0.980535266
18   Grcl.173_695 -0.0952310644 -0.732436761 -0.05902468  0.905406684
19    Andr.152_83 -0.0446132797 -0.911234268 -0.05923574 -0.217622204
20   Arnr.152_129 -0.0960914317 -0.364341627 -0.05888691 -0.636401589
21   Clln.286_450 -0.1095820446 -0.253272099 -0.05906957 -0.015872850
22   Myst.152_983 -0.1860750425  3.183154991 -0.05897231  0.917081879
23  Sxfr.152_1302 -0.1860750425  3.183154991 -0.05915766  0.399007314
24   Ccrb.457_472 -0.1706326892  1.709132996 -0.05906999  0.514817636
25   Ccrb.457_473 -0.1690446005  1.218306880 -0.05908854 -0.020978271
26   Ctps.143_328 -0.0442124369 -0.792440377 -0.05915029  0.608983973
27   Ctps.625_329 -0.0184795471 -0.629422647 -0.05910830  0.302457458
28  Tlln.385_1404 -0.0804904028 -0.809988075 -0.05915751  0.976233750
29  Tlln.625_1405 -0.0785428729 -0.851361446 -0.05918180  0.609868852
30  Tlln.625_1407 -0.1033570065  0.460180420 -0.05905239  1.079947259
31  Tll2.579_1409 -0.0529625390 -0.912064121 -0.05921268 -0.161311822
32  Tll2.579_1411 -0.0659088714 -0.691292939 -0.05913411  0.739798325
33  Tlln.593_1412 -0.1497364060 -0.580933205 -0.05924532 -0.600968692
34    Aspl.74_164  0.0414428932 -0.757022261 -0.05880298 -2.162836494
35    Aspl.74_162 -0.1706326892 -0.532866845 -0.05923026 -2.287091916
36    Aspl.74_163 -0.1448398196 -0.690558253 -0.05921747 -0.273792958
37    Actl.367_25 -0.1334072494 -0.865803115 -0.05918809  0.566892595
38    Acts.204_27 -0.1376009175  0.936540482 -0.05903905  0.732031700
39    Acts.204_28 -0.1355762686 -0.245366077 -0.05915388  0.845107911
40    Agrm.300_46 -0.1126481743  0.592257363 -0.05887972  0.366335293
41    Agrp.242_47  0.5011671805 -0.910664532 -0.05901238 -1.176083204
42    All4.185_57 -0.0872742006  0.113144169 -0.05869065 -0.216077221
43    All4.185_58 -0.0637579004 -0.002778226 -0.05879534 -0.042665884
44    All4.185_56 -0.0949345645  0.167793226 -0.05786475 -0.389712043
45    All4.185_61 -0.1237295818  1.340248836 -0.05710243  0.276358857
46    All4.185_62 -0.1551903359  0.402037061 -0.05917357  0.311533381
47    All4.185_55 -0.1422128821  1.519294344 -0.05819287  0.375217528
48    All4.185_59 -0.0225941638 -0.805775555 -0.05872115  0.957942157
49    All4.185_65 -0.1216375597  1.630391680 -0.05885407  1.038414695
50    All4.185_63 -0.1406475372 -0.913688932 -0.05921963  0.779003003
51    Allm.402_69 -0.0534427693 -0.823842614 -0.05921317 -0.625413868
52     Anth.97_90  0.4325961565 -0.887943318 -0.05808859 -0.201024811
53     Anth.97_96 -0.1607181406  0.667840083 -0.05917507  0.744289621
54     Anth.97_95 -0.1637272085  0.163650728 -0.05906402 -0.485371500
55     Anth.97_91  1.1113131141 -0.938367753 -0.05916868 -1.914380774
56     Anth.97_92 -0.1662494949 -0.257266299 -0.05925146  1.224931962
57   Ant..355_100 -0.1676594904 -0.595597430 -0.05926127  1.004815126
58   Armr.208_139 -0.1087596361 -0.346280613 -0.05879944 -1.063097430
59   Armr.267_142 -0.0962858818 -0.378702152 -0.05910800 -0.527647460
60   Armr.267_143 -0.0158174910  0.543891133 -0.05856200  0.562983244
61   Artm.355_146 -0.1608011419  2.054630447 -0.05911144  0.791611005
62   Asrm.131_148 -0.0860305384  0.905133942 -0.05875288  1.101307710
63   Astr.409_177  0.1101373707  0.416783180 -0.05778012  0.182314219
64   Astr.358_187 -0.1551903359 -0.367710319 -0.05907213 -0.691080493
65   Astr.326_188 -0.1266813760  2.786144111 -0.05732253  0.583271612
66   Astr.326_189 -0.0608149408 -0.026133603 -0.05899388  0.397535234
67   Astr.267_196 -0.1689363418 -0.813490492 -0.05926472  1.733238993
68   Clch.192_286 -0.1656092731  0.805298983 -0.05920967  1.060329851
69   Clch.382_287 -0.1661351315  1.921378088 -0.05918179  1.300815575
70   Clch.192_290 -0.0926538856 -0.471896666 -0.05897343  0.570877456
71   Clch.192_292 -0.1211666392 -0.428822687 -0.05912485  1.429840489
72   Crl2.284_312 -0.1246705018  0.008276466 -0.05912113  1.541611694
73   Crl2.284_313 -0.1153506726  0.396868959 -0.05914586  1.353373430
74   Crl2.284_314 -0.1146131694  0.126906464 -0.05915231  0.712932753
75   Crl2.284_315 -0.1360435257 -0.794799052 -0.05923811  0.507120175
76   Crmc.301_320 -0.1049755794  0.225027246 -0.05910660  0.932212145
77   Crmc.301_319 -0.1442438615  0.179459476 -0.05920679  1.157669076
78   Crmc.301_318 -0.0757725190  3.183154991 -0.05884982  0.975053961
79   Cntr.282_346 -0.1165399971  0.421537741 -0.05917215  1.174818154
80   Cntr.282_347 -0.0545209196 -0.544692554 -0.05916426 -0.009428161
81   Chrl.267_374 -0.0756587005 -0.486785538 -0.05916467  0.230022191
82   Crsm.283_383  0.1073685636 -0.941264697 -0.05922072 -1.852758862
83   Crsm.283_384 -0.1412152807  1.731497942 -0.05915001  2.423814624
84   Crsm.283_386 -0.1177357565  0.512109262 -0.05914133  1.061833917
85   Crsm.474_389 -0.1172910322  0.873089585 -0.05913320  1.802217278
86    Crs3.41_395 -0.1172449963 -0.826298792 -0.05922303  0.410883509
87   Crs5.166_400 -0.1301482696 -0.845875087 -0.05922515  0.619162438
88   Crsm.129_409 -0.1278507513 -0.824571575 -0.05922728  1.085630402
89   Cyp3.211_478  0.2276928803 -0.898935527 -0.05908725 -1.296868915
90   Cypr.576_483  0.0147155700 -0.487690175 -0.05877978 -0.670100913
91   Cypr.576_482  0.2916827224 -0.697431518 -0.05819789 -1.494999243
92   Cypr.576_484  0.0377723737 -0.935801091 -0.05912013  0.101369814
93   Dnth.384_499  0.1287393895 -0.827316158 -0.05879514 -1.614046597
94   Dcnt.331_511  0.1325490670 -0.310125204 -0.05830833 -0.616716103
95   Dcnt.331_510 -0.0207609214 -0.408354677 -0.05890153  0.923156009
96   Dcnt.331_509 -0.0649078804 -0.939735941 -0.05922418  0.188303918
97   Dryc.267_540 -0.1667490390  2.667947978 -0.05873376  0.698334246
98   Dryc.267_539 -0.1678069485  3.100818294 -0.05860044  0.779079440
99   Drc2.151_549 -0.1024121884  0.175660010 -0.05891968  0.221329162
100  Echn.129_555 -0.1069608700  0.340439351 -0.05886873  0.197975508
101  Ech2.263_557 -0.0823139496  0.240998440 -0.05887278  0.391706381
102  Ech2.263_556 -0.1263805175 -0.894950598 -0.05918748  0.602863374
103  Erdm.267_599 -0.0408315562 -0.240726854 -0.05894440  0.535182583
104  Erdm.267_598 -0.0481563829 -0.165475363 -0.05897617  0.515696695
105  Eryn.127_608  0.0035453730 -0.221521119 -0.05880655  0.225635846
106  Gntn.423_679  0.6717584494 -0.850436545 -0.05893686 -1.754763347
107  Gmrv.300_693  1.0369444959 -0.863627752 -0.05870800 -1.272804001
108  Hlnt.267_711  0.5399870233 -0.539781576 -0.05744130 -1.112495105
109  Hlnt.267_712  0.0526640243  0.370875624 -0.05815746 -0.121722374
110   Hlcn.72_716 16.5937150526  1.121961914 16.91163166 -3.661576232
111  Hlrm.601_725 -0.1686588546  0.823776047 -0.05913819 -1.298202874
112  Hypr.463_756 -0.1294638868 -0.897601954 -0.05917590 -0.426216000
113  Hypc.282_760 -0.1342977403 -0.926606513 -0.05914864  0.381072579
114  Hypc.282_759 -0.1317629128 -0.849586871 -0.05912951 -2.269312279
115  Hyp2.284_766 -0.1334272035 -0.778686592 -0.05917634 -1.207489107
116  Hyp2.284_765 -0.1315010975 -0.907452995 -0.05918707  0.075479611
117  Hyp2.284_767 -0.1609246300  0.348730083 -0.05919673  0.723461541
118  Hyp2.284_764 -0.1064217539  0.391793833 -0.05878011  0.161077723
119  Jrnf.267_786 -0.1139350378  0.742846940 -0.05850775  0.130427701
120  Ltrs.166_862 -0.1559436215  1.759183480 -0.05872549  0.536443879
121  Lmnm.267_871 -0.1706326892  2.245891706 -0.05829930  0.357316791
122  Lmnm.267_872 -0.1706326892  1.124478894 -0.05890620 -0.211887267
123  Lmnm.267_873  0.0269319239 -0.819226461 -0.05877981  0.040259462
124  Lnmf.395_880 -0.1553491506 -0.107305037 -0.05921401 -0.049736156
125  Lnmt.395_881  0.1499749059 -0.124444056 -0.05818572 -0.438983327
126  Ltsr.267_895  0.7969542229 -0.944157760 -0.05915767 -0.888265816
127   Lpn..55_899 -0.1633643134  0.098176766 -0.05921265  0.526854299
128  Lpns.132_902 -0.0361488106 -0.664522661 -0.05914579 -0.755607927
129  Lpns.132_901 -0.1273290091  0.900134543 -0.05873175  0.314956945
130 Ont..575_1014 -0.1706326892  2.440275038 -0.05703892  0.513161929
131 Orch.273_1029 -0.1099839969 -0.940590237 -0.05914876  0.776649407
132 Oxyt.267_1036 -0.1659153124  0.748569560 -0.05919888  0.804919254
133 Pnxq.598_1044 -0.1670303939 -0.057190183 -0.05921845 -0.454652147
134 Prln.267_1064 -0.1491655696 -0.896588933 -0.05925818  0.430088292
135 Prny.129_1065 -0.1446771167 -0.245737987 -0.05917325  0.207446678
136 Pngc.298_1099 -0.1554466346 -0.416895990 -0.05923717  0.459567951
137 Pln2.608_1122 -0.1494802721 -0.914777214 -0.05926656 -0.159137299
138 Pln2.608_1123 -0.1063643458 -0.759938645 -0.05919595  0.144888836
139 Pln2.608_1124 -0.0941849608 -0.608932635 -0.05916359  0.025240961
140 Pln2.608_1125 -0.1062214295 -0.936634218 -0.05911244  0.780532634
141 Pln2.608_1127 -0.1457028770  0.751683913 -0.05912761  0.887063456
142 Pln2.608_1128 -0.1655835971 -0.036257652 -0.05858766 -0.762976734
143 Pln2.608_1130 -0.0696560151 -0.943454293 -0.05901261  0.777778082
144 Pln2.608_1129 -0.0382395011 -0.942285968 -0.05890916  0.778070236
145 Pln2.608_1126 -0.1616486691  0.926033218 -0.05914970  0.550037267
146 Plnt.178_1133 -0.1414881423  0.471192289 -0.05908711  0.268456024
147 Plpn.355_1136 -0.1436119485 -0.519501160 -0.05921770 -0.424651347
148 Ptnt.180_1147 -0.1548751859 -0.792398529 -0.05926004 -1.698827737
149 Prml.272_1153 -0.1535748364 -0.003486067 -0.05919500  0.255477362
150 Prml.332_1155 -0.1588040237 -0.154279362 -0.05917082 -0.446531419
151 Prm4.171_1163 -0.1860750425  3.183154991 -0.05927142 -0.746273892
152  Prm5.73_1164 -0.1292970889 -0.106991331 -0.05911160  0.813608353
153 Prml.596_1165 -0.1169681323  0.125568969 -0.05906626  1.058645558
154 Prml.596_1166 -0.1397479826  0.852300939 -0.05907947  0.895620580
155 Prml.596_1167 -0.1129357803  0.485543265 -0.05895785  0.366831374
156 Prm2.170_1169 -0.1215456493 -0.202385726 -0.05911875  0.426005763
157 Prm3.591_1170 -0.1706326892  0.181435130 -0.05923918  0.177368564
158 Rmnd.445_1217 -0.0938314603  2.164651816 -0.05825119  0.853977609
159 Rmnd.445_1214 -0.1196728724  0.310868299 -0.05902568  0.407543595
160 Rnnc.266_1222 -0.1436072197 -0.530193240 -0.05922024 -0.745642803
161 Rtbd.129_1225  0.0137011830 -0.912980341 -0.05912885  0.220350730
162 Rmxr.267_1261 -0.1077080768 -0.895632405 -0.05914632  0.493297236
163 Spnr.126_1284 -0.1706326892 -0.429644017 -0.05924554 -0.829907755
164 Spnr.126_1281 -0.1455313347 -0.454879246 -0.05922288 -0.608379613
165 Srcc.497_1287 -0.0663850858 -0.942200191 -0.05909108  0.762007952
166 Srcc.497_1288 -0.0571662081 -0.945339999 -0.05908516  0.783400861
167 Srcc.497_1290 -0.1706326892 -0.757204460 -0.05923903 -2.295825715
168 Srr2.571_1298  0.6155152614 -0.945182375 -0.05909991 -0.170082326
169 Slnr.375_1347  0.5416550218 -0.934004895 -0.05922682 -1.765689465
170 Sldg.129_1354  0.3689517125 -0.937716973 -0.05923670 -1.738077371
171 Sphr.129_1358  0.4676400804 -0.932272292 -0.05924239 -2.069030073
172 Sccs.282_1371  0.3689517125 -0.937716973 -0.05923670 -1.738077371
173 Sccs.282_1370  0.5416550218 -0.934004895 -0.05922668 -1.765882484
174 Sccs.282_1368  0.4676400804 -0.932272292 -0.05923961 -2.069174634
175 Scc3.381_1377 -0.0873304533 -0.241464532 -0.05898854  0.921427946
176 Trgp.380_1421 -0.1614702309 -0.268269025 -0.05924133  0.736581356
177 Trg..284_1427 -0.1692959553  0.720462424 -0.05922925  0.735726620
178 Trg..284_1426 -0.1681859220  0.017799332 -0.05924834  0.747799637
179 Trll.304_1440 -0.1698903514  1.121871839 -0.05922282  0.846601534
180 Trll.304_1436 -0.1701902991  1.296974535 -0.05916568  0.525296553
181 Trl3.514_1449 -0.1705715279  1.604969233 -0.05921393  1.079131177
182 Trll.481_1451 -0.1628243164 -0.176521038 -0.05923050  0.971955832
183 Trll.320_1468 -0.1703127140  0.810199443 -0.05915848  0.021767995
184 Trll.320_1467 -0.1706326892  1.259769615 -0.05919429  0.574130949
185 Trll.320_1465 -0.1706326892  1.144710568 -0.05919617  0.568345343
186 Trll.320_1460 -0.1706326892 -0.059074061 -0.05924294 -0.196282680
187 Trll.320_1463 -0.1706326892 -0.024735267 -0.05923592 -0.207561446
188 Trl2.508_1475 -0.1669157953  1.270330958 -0.05895101  0.076628851
189 Trl2.508_1481 -0.1656392508  1.712537095 -0.05890644  0.539771047
190 Trl2.508_1472  1.0332303098 -0.920212653 -0.05911362 -1.809540616
191 Trl2.508_1478 -0.1229402257 -0.893345628 -0.05926209 -2.061405240
192 Trl2.508_1471 -0.1207132807 -0.416444926 -0.05914568 -0.021558257
193 Trl2.508_1474 -0.1660070070  2.152938844 -0.05893033  0.675210191
194 Trl2.508_1473 -0.1473528461  0.287221404 -0.05910866  0.040858575
195 Trl2.508_1482 -0.0615065329 -0.415869609 -0.05902375  0.008690507
196 Trl2.508_1476 -0.1061232891  0.149266593 -0.05886295 -0.396941418
197 Trl2.508_1477 -0.0790465491 -0.927888461 -0.05925054 -0.426012871
198 Vrbs.267_1502 -0.1498889271 -0.653204316 -0.05924154 -0.855367744
199 Vrbs.267_1503 -0.1436600679 -0.853883018 -0.05925911 -0.859163411
200 Vrbs.267_1504 -0.1296486917 -0.936117142 -0.05919454  0.805806161
201 Zdpl.500_1534 -0.1089620181  0.270208520 -0.05901458  0.361120504
202   Alyx.627_75 -0.1254892385 -0.525390068 -0.05910471 -1.190281334
203   Alyx.627_74 -0.1016813101  0.744360947 -0.05884818  0.464527498
204  Astr.464_202 -0.1539260595  0.320303562 -0.05875689 -0.391345715
205   Brss.36_238 -0.1540068923  0.482484473 -0.05895868 -0.117926038
206  Chmd.594_367 -0.1579888355  0.062034997 -0.05883488 -0.669046922
207  Chmd.172_368 -0.0809799700 -0.529481246 -0.05908014  0.137415194
208  Erms.306_591 -0.0765636078  2.291602337 -0.05828605  0.965070640
209  Etrp.646_638  0.0783446181 -0.944897970 -0.05843657  0.777131694
210 Zmmb.405_1532 -0.0693577532 -0.944299894 -0.05902755  0.773791603
211  Ards.305_126 -0.0777076510  2.452989297 -0.04995071 -0.681740193
212  Ards.431_127 -0.1240477264 -0.852992494 -0.05925433 -0.955339613
213  Atrp.603_216  0.2043265299 -0.878043849 -0.05921830 -1.784965617
214  Atrp.603_217  0.0572047324 -0.930440798 -0.05924178 -1.444042685
215 Prsh.362_1204 -0.1448954337 -0.583446031 -0.05922261 -1.098412200
216  Ttrm.21_1392 -0.1479233461 -0.883824463 -0.05926787 -2.373645337
217  Arcr.350_132 -0.1391176825 -0.402258368 -0.05921147 -0.659603736
218  Arcr.350_131 -0.1496289716  0.826148840 -0.05203713 -1.034336838
219  Astr.359_207 -0.1548024962  0.213586052 -0.05693603 -1.257060012
220  Astr.359_204 -0.1496083825 -0.147773319 -0.05911970 -0.509671481
221  Astr.359_205 -0.1391176825 -0.402258368 -0.05921147 -0.659603736
222  Astr.359_206 -0.0982469962 -0.603549356 -0.05904062 -1.020682765
223  Ast2.351_210 -0.0646850386  0.821682972 -0.05704971  0.119417508
224  Astr.635_214 -0.1593215683 -0.067594338 -0.05921087 -0.023921268
225  Cryp.511_463 -0.1678115404 -0.216985508 -0.05924131  0.910235080
226  Echn.279_562 -0.0927536284  0.827419763 -0.05836085  0.201366145
227  Echn.279_563 -0.0574343577  0.422767189 -0.05877057  0.481803965
228  Ephr.267_629 -0.0941654666  1.143141124 -0.05862748  0.594034848
229  Lphp.146_893 -0.0786913169  1.291453077 -0.05815042  0.485068349
230  Mmml.116_912 -0.1108620359  0.427076265 -0.05899766  0.764996535
231  Mmm2.490_923 -0.1661288357  0.703247195 -0.05919947  0.333298545
232  Mmml.193_925 -0.1511795127 -0.189837901 -0.05911541 -0.646974660
233  Mmm2.194_928 -0.1358526142  0.532275989 -0.05902475  0.331530161
234  Mmml.490_931 -0.1258225927  1.122001546 -0.05861030  0.437044455
235  Mmml.490_935 -0.0267708561  0.623219520 -0.05719170  0.069710312
236  Nbx3.183_990 -0.1679502147  1.690543194 -0.05915653  0.806401313
237  Nbxb.182_991 -0.1354683011 -0.587180773 -0.05918364 -1.058402865
238  Nbx2.183_992  0.0007884371  0.386895903 -0.05843930  0.235164345
239  Nbxb.182_994 -0.1538793903 -0.803522870 -0.05926092 -1.120175686
240 Ptrc.374_1199 -0.0994684519 -0.707341174 -0.05921089 -1.076558571
241 Stn2.110_1362 -0.0698251656 -0.630032674 -0.05918308 -0.002073500
242   Acrs.330_19 -0.1449167152  0.373676645 -0.05918205  1.252227968
243   Ascl.288_41  0.0115760775 -0.333978019 -0.05887065  0.474680996
244  Crp2.123_294 -0.1570116423  1.478747931 -0.05893121  0.447873483
245  Cstn.134_322 -0.1055605359 -0.925504673 -0.05919989  0.316247139
246  Cstn.134_326 -0.0743870220 -0.848899538 -0.05920464 -1.153289265
247  Cstn.134_325 -0.1610482815  0.828228775 -0.05922858  1.800374844
248  Cstn.134_324 -0.1660855244  0.455929500 -0.05924696  1.633910996
249  Cstn.134_323 -0.1706326892  0.268922671 -0.05918841 -1.213224235
250   Ccrp.10_330 -0.1169908699  1.289447785 -0.05512892  0.138318469
251  Chlr.573_375 -0.1547912962  0.527613277 -0.05912240  0.557429833
252  Dcym.634_517 -0.1516972402 -0.243242963 -0.05920295  0.045779235
253  Dgtn.634_553 -0.1396112399  0.461618329 -0.05904219  0.155653056
254  Mnlk.125_938 -0.1706326892  0.513957151 -0.05917174 -0.080452129
255 Pnss.391_1116 -0.1706326892  2.357372361 -0.05902249  0.775357092
256 Prrc.114_1171 -0.1528256057  0.180923064 -0.05917515  0.295697196
257  Prsp.48_1176 -0.1459261483 -0.553242695 -0.05911055 -1.606021077
258 Prns.559_1184 -0.1706326892  0.725663043 -0.05915514 -0.279763048
259 Prns.559_1182 -0.1472503169 -0.588802338 -0.05922344 -1.040600901
260 Prns.559_1181 -0.0401980790 -0.896853433 -0.05923024 -1.015164641
261 Rhdd.496_1241  0.0537413430 -0.936043153 -0.05923063 -0.810016080
262 Rhdd.496_1239  0.1257410500 -0.931942215 -0.05918280 -1.100535306
263 Rhdd.496_1234  0.0427258597 -0.863051082 -0.05914946 -2.385178098
264 Rhdd.496_1236  0.0061150769 -0.937461634 -0.05925174 -1.019794144
265 Rhdd.496_1235  0.2146517839 -0.836058424 -0.05904782 -1.104797615
266 Rhdd.496_1232  0.0243271080 -0.809116941 -0.05898008 -2.107199208
267 Rhdd.496_1233  0.0604351794 -0.843918902 -0.05866927 -2.715323849
268 Txsf.308_1389  0.0297174456 -0.907151559 -0.05921486 -2.383171036
269 Tsgc.311_1484  0.0520906463 -0.939838594 -0.05923076 -0.971228090
270   Clnc.87_178  0.0423092417 -0.923374283 -0.05922478 -1.327415857
271   Clnc.87_177  0.1642833380 -0.916021631 -0.05921427 -2.087567068
272  Pyl2.328_614 -0.1139548979 -0.694727406 -0.05921714 -1.382845291
273  Prmr.231_529 -0.0979627914 -0.741741275 -0.05922513 -0.837996799
274  Prm2.230_531 -0.1351545422 -0.860834583 -0.05925883 -2.028273931
275   Cntr.86_146 -0.1295069972 -0.875962758 -0.05926400 -1.675422748
276  Flcn.170_257  0.3344648640 -0.928629556 -0.05915845  0.208425063
277  Frps.330_261 -0.1706326892  1.048248835 -0.05902922 -0.363113703
278  Lgps.394_383  0.3660596744 -0.895339518 -0.05864656 -0.240176103
279  Lgps.394_384 -0.1351724817  0.299467351 -0.05912805  0.735659058
280   Amph.254_47 -0.0691789527  0.495652566 -0.05884544  0.648634243
281  Clsl.157_182 -0.1706326892  2.322276599 -0.05922717  2.058280125
282   Scl2.22_651 -0.1706326892  2.468853016 -0.05922643  2.107008652
283  Urs2.183_726 -0.1706326892  2.541108996 -0.05922517  2.152098664
284  Scl2.252_644 -0.1475844007 -0.158662693 -0.05921861  0.890155451
285  Xnsr.414_745 -0.1245082866 -0.451914152 -0.05913919 -0.383708388
286  Xnsr.320_747 -0.1467451090  0.942019456 -0.05914073  1.033400194
287  Xnsr.320_746 -0.1374240649 -0.942569629 -0.05924844  0.707910931
288  Mccm.269_415  0.3167762602 -0.941672544 -0.05918810  0.650678640
          Growth            H mahal.dist is.outlier
1    0.569283047  0.427143199      1.293      FALSE
2    0.655591333  0.712283977      1.510      FALSE
3   -0.010011845 -0.757388211      2.854      FALSE
4   -0.280530601 -0.914494150      3.275      FALSE
5   -1.263602230 -0.273842809      2.884      FALSE
6   -0.405338381  0.842929069      1.540      FALSE
7   -1.244750946  0.971863475      7.256      FALSE
8   -1.390493562  0.971863475      7.888      FALSE
9   -1.637620066  0.971863475      8.969      FALSE
10  -1.666755200  0.971863475      9.157      FALSE
11  -1.279913556  0.971863475      7.239      FALSE
12  -1.470467746  0.971863475      8.389      FALSE
13  -1.161696837  0.971863475      7.286      FALSE
14  -1.506614113  0.971863475      8.467      FALSE
15  -1.612733094  0.971863475      8.898      FALSE
16  -1.450578344  0.971863475      7.961      FALSE
17  -0.814200871  0.971863475      6.014      FALSE
18  -1.150445562  0.971863475      6.675      FALSE
19   0.202142828 -1.910036409      5.938      FALSE
20  -0.598759715  0.438472313      1.592      FALSE
21  -0.679265317 -0.229176824      0.982      FALSE
22  -1.229675292  0.924016862     19.122      FALSE
23  -0.566584804  0.151273943     17.287      FALSE
24  -0.917460041  0.534537133      6.905      FALSE
25   0.555384973  0.205915617      2.353      FALSE
26  -0.742349119 -1.016764316      3.069      FALSE
27  -0.786518613 -0.783229601      1.672      FALSE
28  -0.323830444 -0.672994291      3.286      FALSE
29  -0.263938134 -0.654965457      2.239      FALSE
30   1.148431940  0.023708781      2.419      FALSE
31  -0.983681412 -0.373856370      1.673      FALSE
32  -0.048399609 -0.788071724      2.445      FALSE
33  -0.136203591  0.575659307      1.910      FALSE
34  -0.879790607  0.309893992      6.605      FALSE
35   0.045168730 -0.776329594      9.831      FALSE
36   0.003149346 -1.139824924      3.306      FALSE
37  -1.275703085 -2.325819281     12.145      FALSE
38  -0.493348882  0.701211094      2.546      FALSE
39  -1.268653627  0.629942703      4.889      FALSE
40  -0.185557425  0.255674859      0.720      FALSE
41  -0.610548236 -2.189033880      9.790      FALSE
42  -0.054960563  0.677171274      0.788      FALSE
43  -0.538710512  0.351916321      0.706      FALSE
44   0.303258743  0.899129605      1.482      FALSE
45   1.193564429  0.929246065      2.717      FALSE
46   2.670483783  0.971863475      8.646      FALSE
47   0.788493788  0.892079293      2.525      FALSE
48  -1.262546113  0.858487666      7.439      FALSE
49   0.173508933  0.569483539      3.402      FALSE
50   1.126759060 -1.557181658      9.009      FALSE
51  -0.438467287 -0.737360858      1.319      FALSE
52  -0.875705651 -1.654564945      7.535      FALSE
53   0.555851286 -0.305175844      1.873      FALSE
54   0.293796314  0.653760313      1.273      FALSE
55  -1.580519674 -1.849218246     41.533       TRUE
56   1.036740290  0.688048343      3.482      FALSE
57   1.202202518  0.912704683      4.974      FALSE
58   0.348771070  0.636959134      2.861      FALSE
59   0.349023530 -0.038183099      0.902      FALSE
60  -0.453099774 -0.043531388      1.328      FALSE
61  -0.146253650  0.966099099      5.715      FALSE
62  -0.927514446  0.301896908      4.390      FALSE
63   0.636716467  0.979830069      4.640      FALSE
64  -1.225008497  0.122255194      3.484      FALSE
65  -0.955576203  0.658156964     13.831      FALSE
66   0.353971343  0.217112505      0.401      FALSE
67   2.824980383  1.857509241     20.413      FALSE
68   0.409286139  0.532219056      1.336      FALSE
69   0.767300784  0.418795519      4.566      FALSE
70  -0.072166854  1.243615730      3.913      FALSE
71   0.388112010  0.202836405      3.505      FALSE
72   0.501654243  0.359925252      3.077      FALSE
73   1.104866739  0.148715405      2.861      FALSE
74   0.745258971  0.373191826      0.982      FALSE
75   0.360417801  0.574799597      2.521      FALSE
76   0.083772360  0.636308772      1.319      FALSE
77   1.243259513  0.079819404      2.848      FALSE
78   0.507228830  0.899468128     11.830      FALSE
79   1.787785164  0.158321796      4.562      FALSE
80   1.380857671  0.424416501      4.131      FALSE
81   0.968195771  0.400053274      2.330      FALSE
82  -1.430719206 -1.405435047      4.980      FALSE
83   1.664036528  0.249799046      8.961      FALSE
84   0.354769523  0.640779377      1.353      FALSE
85   2.066319008 -0.113673222      7.883      FALSE
86   0.328148617 -0.223867100      1.802      FALSE
87  -0.575789495  0.093291741      2.532      FALSE
88   0.878181225  0.569764884      4.828      FALSE
89  -1.476385447 -2.362964600      6.451      FALSE
90  -1.097968859  0.173073011      1.998      FALSE
91  -1.396063002 -0.305415444      5.549      FALSE
92  -1.472401014 -2.431325493      8.762      FALSE
93  -1.423255834 -1.759970965      5.164      FALSE
94  -1.152888756  0.366514462      3.450      FALSE
95  -0.114438433 -0.391230129      1.931      FALSE
96  -0.458699335 -1.351693293      3.355      FALSE
97  -0.150190377  0.864515462      9.404      FALSE
98   0.546121580  0.920803381     10.808      FALSE
99  -0.580645710  0.625498431      1.336      FALSE
100 -0.535843413  0.681484663      1.400      FALSE
101 -0.759088433  0.485303065      1.696      FALSE
102 -0.029939506 -2.611318335     13.169      FALSE
103 -0.540023181  0.142347108      1.136      FALSE
104 -0.328371008  0.478764808      1.207      FALSE
105 -0.759270964  0.460677783      1.807      FALSE
106 -0.500523642 -1.165808486     17.530      FALSE
107 -1.387414491 -1.869459590     36.518       TRUE
108 -1.560930939  0.440253756     17.446      FALSE
109 -0.888980264  0.473738917      2.469      FALSE
110 -1.163170232 -0.866608921    286.003       TRUE
111 -0.088885591 -0.060634331      5.647      FALSE
112 -0.443929642 -1.568103376      5.043      FALSE
113 -1.144586870 -2.073751946      9.619      FALSE
114 -0.049811315  0.287658763      8.203      FALSE
115 -0.328512715 -0.526440466      3.122      FALSE
116 -0.391646505 -1.929647543      7.180      FALSE
117 -0.187443668  0.190881718      1.055      FALSE
118 -0.138710513  0.459291786      0.460      FALSE
119  0.018792438  0.665656837      0.923      FALSE
120 -0.456918749  0.829419053      5.181      FALSE
121  0.497051398  0.830218059      5.716      FALSE
122  0.347924432  0.607587412      2.124      FALSE
123 -0.821979953 -1.377551368      2.614      FALSE
124  1.540623035  0.409604341      3.310      FALSE
125 -0.498209066  0.567289852      3.389      FALSE
126 -1.406467246 -3.042114733     21.970      FALSE
127 -0.112057526  0.419192216      0.705      FALSE
128  0.054556325  0.755869806      2.822      FALSE
129  0.827742115  0.925821296      1.413      FALSE
130  0.127614542  0.889028334      7.260      FALSE
131 -1.043676128 -1.514373710      6.817      FALSE
132  0.417362222  0.359529018      0.940      FALSE
133 -0.127963406  0.228542181      1.017      FALSE
134  0.876872674  0.458438286      3.474      FALSE
135  0.337361964  0.405043779      0.602      FALSE
136  0.893812294  0.347302750      1.856      FALSE
137 -0.802608364  1.229058545      5.548      FALSE
138  0.243989817 -0.223470543      1.209      FALSE
139 -0.348983819 -0.044674013      0.681      FALSE
140  0.396692202 -0.108315200      2.931      FALSE
141 -1.057804082  0.850807780      4.797      FALSE
142 -0.103042062  0.911546856      2.539      FALSE
143  0.646063758 -0.207379050      3.465      FALSE
144  0.427546363 -0.040832962      3.231      FALSE
145 -0.549322393  0.334228981      2.533      FALSE
146  0.558030072  0.583803536      0.480      FALSE
147 -0.702392031  0.180388838      1.647      FALSE
148  1.320069059  0.952560077     10.066      FALSE
149  0.782266788  0.400342696      0.828      FALSE
150  1.446306449  0.790150673      4.030      FALSE
151  1.384584804 -0.529974320     21.974      FALSE
152  1.210744338  0.993047415      3.390      FALSE
153  1.640451149  0.430584386      4.029      FALSE
154  1.909935318  0.524408274      4.080      FALSE
155  0.881020512  0.907806116      1.352      FALSE
156  0.475251658  0.064074739      0.632      FALSE
157  2.768051172  0.974013672      9.774      FALSE
158 -0.297458756  0.972925410      6.870      FALSE
159 -1.035834263  0.136106058      2.563      FALSE
160  0.234403984  0.305907851      1.770      FALSE
161 -1.150586394 -2.399124871      8.476      FALSE
162 -0.740984216 -2.010889978      8.091      FALSE
163 -0.555305341 -0.352682689      2.582      FALSE
164 -0.075227927  0.249472567      1.254      FALSE
165 -0.667171966 -2.488059793     11.303      FALSE
166 -0.798209864 -1.120209880      4.274      FALSE
167 -0.013378246 -0.080735335      8.702      FALSE
168 -0.877489162 -2.828314205     16.270      FALSE
169 -1.292245024 -2.806127590     12.222      FALSE
170 -1.211978569 -2.463084206      8.042      FALSE
171 -1.340143451 -2.259929071      9.617      FALSE
172 -1.211978569 -2.463084206      8.042      FALSE
173 -1.292341531 -2.806979975     12.226      FALSE
174 -1.332644542 -2.276051141      9.659      FALSE
175 -1.118355906  0.773165658      4.817      FALSE
176  0.659619205  0.276973897      1.436      FALSE
177  1.366487900  0.563084157      1.964      FALSE
178  1.433363886  0.436437687      2.736      FALSE
179  0.626350598  0.505833224      1.496      FALSE
180  0.152388625  0.612121850      2.025      FALSE
181  2.564282420  0.423889390      8.096      FALSE
182  0.291513755 -0.055609478      1.610      FALSE
183  1.629315106  0.809612276      3.219      FALSE
184  1.168865192  0.731222130      2.096      FALSE
185  0.228267645  0.718204117      1.554      FALSE
186  0.363414802  0.154802007      0.699      FALSE
187  0.524750483  0.664439185      1.069      FALSE
188  0.028378923  0.355882758      2.485      FALSE
189  0.178240048  0.810133591      3.420      FALSE
190 -1.272903865 -2.623477245     34.650       TRUE
191  0.351057854 -1.570616175     10.853      FALSE
192 -0.577270533 -0.738815799      1.747      FALSE
193  1.058864402  0.839137236      4.855      FALSE
194  0.909145750  0.231216049      0.992      FALSE
195 -1.151985429 -1.017178911      2.929      FALSE
196 -0.857446466 -0.776004306      2.952      FALSE
197 -0.028574491 -1.486589131      3.959      FALSE
198  1.589725221  0.211502577      6.240      FALSE
199  0.430968528 -0.619651567      3.310      FALSE
200  0.688070341  0.369176521      3.795      FALSE
201  0.865277970  0.820739674      1.299      FALSE
202  0.447197223  0.729080868      3.937      FALSE
203  0.961563854  0.816367859      1.446      FALSE
204  0.761267796  0.813302161      1.686      FALSE
205  0.423396584  0.755489675      0.888      FALSE
206  1.098287024  0.835249959      3.228      FALSE
207 -1.050574536 -1.215579980      3.630      FALSE
208  2.740055610  0.964425285     11.473      FALSE
209 -1.209126524  0.574922729      7.000      FALSE
210 -0.927138490 -2.157119177      9.380      FALSE
211 -0.609794404  0.916041024     12.076      FALSE
212 -0.295669554  0.753235211      3.567      FALSE
213  0.061757501 -1.557357503      5.984      FALSE
214  0.013418695 -1.311416763      3.953      FALSE
215 -0.318838254 -0.551924353      2.952      FALSE
216 -0.054634461  0.281832726      9.110      FALSE
217 -0.307773852  0.320629284      1.417      FALSE
218  0.886923103  0.963258083      4.641      FALSE
219  0.854178198  0.957210685      4.988      FALSE
220  0.966187392  0.732241221      2.535      FALSE
221 -0.307773852 -0.055150922      1.265      FALSE
222 -0.699001148 -0.128744458      2.072      FALSE
223 -0.285156977  0.809842509      1.790      FALSE
224  0.839527946  0.651691694      1.331      FALSE
225  1.136550800  1.124892779      3.767      FALSE
226  0.469672277  0.841271144      1.154      FALSE
227 -0.244151393  0.687891954      1.213      FALSE
228  0.269305936  0.761966681      1.632      FALSE
229 -0.186859356  0.868806077      2.769      FALSE
230  0.865804149  0.470816573      1.108      FALSE
231  1.304876066  0.461778692      1.800      FALSE
232  0.364821009  0.772154089      1.978      FALSE
233 -0.725504973  0.520877731      2.031      FALSE
234  0.751125083  0.823391342      1.511      FALSE
235  0.234852049  0.860210477      1.475      FALSE
236  1.859401441  0.853298746      4.714      FALSE
237 -0.067604131  0.566873630      2.854      FALSE
238 -0.731767889  0.719158346      2.405      FALSE
239  0.553551384 -1.873058140      9.864      FALSE
240 -0.501943489 -0.081136988      2.094      FALSE
241 -0.995343702 -1.062626028      2.713      FALSE
242  1.500240390 -0.294865844      4.416      FALSE
243 -0.118379441 -0.508724936      0.937      FALSE
244 -0.308403857  0.118211713      3.972      FALSE
245  0.094487870 -0.706698502      2.215      FALSE
246 -0.168651610 -0.163553943      2.178      FALSE
247  2.182791880  0.227855903      7.378      FALSE
248  2.248599346  0.572483146      7.230      FALSE
249  0.661368019  0.146391098      3.988      FALSE
250 -0.570849157  0.873324272      3.764      FALSE
251  0.506638571  0.468456327      0.506      FALSE
252  0.626444946 -0.553268571      1.826      FALSE
253  0.269217355 -0.009112619      0.539      FALSE
254  0.565683812  0.083497537      1.038      FALSE
255  0.807736454  0.119091469      7.174      FALSE
256  0.881883684  0.220362595      0.876      FALSE
257  0.680692670  0.586990252      5.976      FALSE
258  0.557531760  0.122553337      1.654      FALSE
259  1.051560430 -0.031960761      4.410      FALSE
260 -0.735823015 -1.065016611      2.575      FALSE
261 -1.299437727 -1.492296849      3.222      FALSE
262 -1.243134568 -0.113752247      3.034      FALSE
263 -0.658592201  0.312327939      7.740      FALSE
264 -0.957168807 -0.577185529      1.802      FALSE
265 -0.964445871  0.667108184      7.004      FALSE
266 -0.722310807  0.535067006      6.978      FALSE
267 -0.866275250  0.876694277     12.276      FALSE
268 -0.702580282 -0.659298361      6.426      FALSE
269 -1.308513048 -1.447085265      3.273      FALSE
270 -1.024846876 -0.779585571      2.395      FALSE
271 -1.129869779 -0.230703910      5.594      FALSE
272  0.210386971  0.037444280      3.454      FALSE
273 -0.330425003  0.319344058      1.909      FALSE
274 -0.117516611 -0.155382582      6.485      FALSE
275 -0.404798062 -0.428013373      4.731      FALSE
276 -0.804928546 -2.079248756      7.256      FALSE
277  0.573389030  0.416706200      2.331      FALSE
278 -1.630770217 -2.235641024      7.581      FALSE
279  1.487282945  0.789519065      2.844      FALSE
280  0.429623069  1.046185135      1.803      FALSE
281  2.824980383  0.961402547     11.959      FALSE
282  2.824980383  0.926230741     12.566      FALSE
283  2.824980383  1.148665578     12.720      FALSE
284  1.141184676  0.259934787      2.447      FALSE
285 -0.495238449 -0.054482848      0.950      FALSE
286  1.549886265  0.585602531      2.921      FALSE
287 -0.867556273 -1.417450582      6.282      FALSE
288 -1.558418291 -1.684937343      8.329      FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## .. Filter outliers ----</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>spLHmat<span class="ot">&lt;-</span>LHtraits<span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.outlier<span class="sc">==</span><span class="st">"FALSE"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(is.outlier,mahal.dist))   <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="fast-slow-continuum-life-history-pca" class="level2">
<h2 class="anchored" data-anchor-id="fast-slow-continuum-life-history-pca">3.1 Fast-slow continuum / Life history PCA</h2>
<ul>
<li>Perform PCA with life history data</li>
<li>Check eigenvalues</li>
<li>Plot eigenvalues and correlogram</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>LHpca<span class="ot">&lt;-</span>spLHmat<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))<span class="sc">%&gt;%</span><span class="fu">PCA</span>(.,<span class="at">graph=</span><span class="cn">FALSE</span>,<span class="at">scale=</span><span class="cn">TRUE</span>) <span class="co"># Using raw data without imputatation</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># LHpca - Map variables</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>LHpca<span class="sc">$</span>eig<span class="sc">%&gt;%</span><span class="fu">t</span>() <span class="co">#Explained variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                     comp 1    comp 2     comp 3     comp 4
eigenvalue                         2.696769  1.173172  0.7162735  0.6095803
percentage of variance            44.946155 19.552872 11.9378909 10.1596722
cumulative percentage of variance 44.946155 64.499028 76.4369184 86.5965906
                                      comp 5      comp 6
eigenvalue                         0.4286934   0.3755112
percentage of variance             7.1448894   6.2585200
cumulative percentage of variance 93.7414800 100.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#LHpca$ind$coord    #Eigenvalues</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimdesc</span>(LHpca, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">proba =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Dim.1

Link between the variable and the continuous variables (R-square)
=================================================================================
       correlation      p.value
H        0.7782491 6.313930e-59
LaProb   0.7487164 2.802252e-52
Growth   0.7104679 6.192170e-45
D        0.6479642 3.320243e-35
e        0.1633963 5.779568e-03
La      -0.7610525 6.144154e-55

$Dim.2

Link between the variable and the continuous variables (R-square)
=================================================================================
       correlation       p.value
e        0.9300967 1.118102e-124
LaProb   0.3165349  4.990971e-08
La       0.2377485  5.185214e-05
H        0.1668020  4.826793e-03
D       -0.2444222  3.123859e-05
Growth  -0.2526037  1.645514e-05

$Dim.3

Link between the variable and the continuous variables (R-square)
=================================================================================
       correlation      p.value
D        0.6282915 1.345055e-32
La       0.3476003 1.735429e-09
LaProb   0.2631009 6.998948e-06
H       -0.3471587 1.825150e-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.2.Check PCA -----</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">nrow=</span><span class="dv">1</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">ncol=</span><span class="dv">1</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fviz_eig</span>(LHpca)<span class="sc">+</span><span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">14</span>),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fviz_pca</span>(LHpca, <span class="at">geom=</span><span class="fu">c</span>(<span class="st">"point"</span>))<span class="sc">+</span><span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">14</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  LHpca<span class="sc">$</span>var<span class="sc">$</span>cor<span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    ggcorrplot<span class="sc">::</span><span class="fu">ggcorrplot</span>(<span class="at">method =</span> <span class="st">"circle"</span>)<span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">14</span>)<span class="sc">+</span><span class="fu">theme</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">75</span>,<span class="at">hjust=</span><span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coord_fixed</span>(<span class="at">ratio=</span>.<span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/life-history%20PCA-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(file="Figures/PCALH.svg")</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Use Principal Components as variables - add to LHtraits</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>LHtraits<span class="ot">&lt;-</span><span class="fu">left_join</span>(<span class="at">by=</span><span class="st">"ID"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    LHtraits,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      LHpca<span class="sc">$</span>ind<span class="sc">$</span>coord<span class="sc">%&gt;%</span><span class="fu">data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span><span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename_with</span>(., <span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"Dim"</span>, <span class="st">"LHAxis"</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>))<span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ID,LHAxis<span class="fl">.1</span><span class="sc">:</span>LHAxis<span class="fl">.2</span>))<span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="climate-variables-and-environmental-pca" class="level1">
<h1>4. Climate variables and environmental PCA <br></h1>
<p>Extract and store climatic data from CHELSAcruts (<span class="citation" data-cites="karger2017">Karger et al. (<a href="#ref-karger2017" role="doc-biblioref">2017</a>)</span>) in an intermediary dataset, remove collinear variable, perform environmental PCA and plot PCA’s axes across the globe</p>
<section id="extract-and-store-climatic-information" class="level2">
<h2 class="anchored" data-anchor-id="extract-and-store-climatic-information">4.1. Extract and store climatic information</h2>
<p>Extracted climatic data is available in <code>Data/Climate_df.RDS</code></p>
<p>Because data download and information extraction is quite time consuming a dedicated Jupyter notebook to run on Google Colab is provided: <code>ChelsaData Download and extraction - Google Colab.ipynb</code></p>
<p>Run this Google Colab by typing in your brownser: <a href="https://githubtocolab.com/Ecosantos/Demogbuff-pops" class="uri">https://githubtocolab.com/Ecosantos/Demogbuff-pops</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>climate_df<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">"Data/climate_df.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="analyse-climatic-timeseries-calculate-environmental-stochasticity-and-summarise-information-into-a-pca" class="level2">
<h2 class="anchored" data-anchor-id="analyse-climatic-timeseries-calculate-environmental-stochasticity-and-summarise-information-into-a-pca">4.1. Analyse climatic timeseries, calculate environmental stochasticity and summarise information into a PCA</h2>
<p>3 - <code>Climatic variables calculation.R</code> use the already extracted climatic data to:</p>
<ul>
<li>Produce data summary and extract metrics described in methods</li>
<li>Produce final dataset to analyse: <code>climate_df.RDS</code>
<ul>
<li>“Mean_trend_TMax”:</li>
<li>“Stoch_noisesize_TMax”</li>
<li>“Ampli_trend_TMax”</li>
<li>“Ampli_trend_TMin”</li>
<li>“Mean_trend_Prec”</li>
<li>“Ampli_trend_Prec”</li>
</ul></li>
</ul>
<!-- Temperature is times 10. So, if temperature is 16ºC, data will show temperature as 160ºC -->
<section id="checking-collinearity-and-retaining-climatic-variables" class="level3">
<h3 class="anchored" data-anchor-id="checking-collinearity-and-retaining-climatic-variables">4.1.1. Checking collinearity and retaining climatic variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> climate_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ID) <span class="sc">%&gt;%</span> <span class="fu">cor</span>()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(cor_matrix) <span class="ot">&lt;-</span> <span class="cn">NA</span>  </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find values higher than 0.65</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>high_corr <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(cor_matrix) <span class="sc">&gt;</span> <span class="fl">0.65</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Output to selection</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Var1 =</span> <span class="fu">rownames</span>(cor_matrix)[high_corr[, <span class="dv">1</span>]],</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Var2 =</span> <span class="fu">colnames</span>(cor_matrix)[high_corr[, <span class="dv">2</span>]],</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Correlation =</span> cor_matrix[high_corr]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(Correlation)))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Var1                 Var2 Correlation
1      Mean_trend_TMin      Mean_trend_TMax   0.9227075
2      Mean_trend_TMax      Mean_trend_TMin   0.9227075
3 Stoch_noisesize_TMin Stoch_noisesize_TMax   0.8976632
4 Stoch_noisesize_TMax Stoch_noisesize_TMin   0.8976632
5 Stoch_noisesize_Prec      Mean_trend_Prec   0.8077346
6      Mean_trend_Prec Stoch_noisesize_Prec   0.8077346</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all variables to visualize collinearity</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#climate_df%&gt;%select(-ID)%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  select(-c(Ampli_season_TMax,</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            Ampli_season_TMin,</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#            Ampli_season_Prec))%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  cor()%&gt;%corrplot::corrplot()</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Retaining climatic variables -----</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>climate_df<span class="ot">&lt;-</span>climate_df<span class="sc">%&gt;%</span><span class="fu">select</span>(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">c</span>(Mean_trend_TMin,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  Stoch_noisesize_TMin,Stoch_noisesize_Prec,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  Ampli_season_TMax,Ampli_season_TMin,Ampli_season_Prec))<span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="climaticenvironmental-pca" class="level3">
<h3 class="anchored" data-anchor-id="climaticenvironmental-pca">4.1.2. Climatic/environmental PCA</h3>
<p>Run environmental PCA and show its output</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce the climatic/environmental PCA</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ClimPCA<span class="ot">&lt;-</span>climate_df<span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">-</span><span class="fu">c</span>(ID)),scale)<span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">column_to_rownames</span>(<span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#cor(.)%&gt;%corrplot::corrplot(.)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">PCA</span>(.,<span class="at">graph=</span>F,<span class="at">scale=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#ClimPCA$ind$coord</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>ClimPCA<span class="sc">$</span>eig<span class="sc">%&gt;%</span><span class="fu">t</span>()   <span class="co">#Explained variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                     comp 1    comp 2    comp 3     comp 4
eigenvalue                         1.799101  1.231347  1.049691  0.8588607
percentage of variance            30.077274 20.585597 17.548683 14.3583897
cumulative percentage of variance 30.077274 50.662871 68.211554 82.5699438
                                      comp 5     comp 6
eigenvalue                         0.7230174   0.319578
percentage of variance            12.0873684   5.342688
cumulative percentage of variance 94.6573121 100.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">nrow=</span><span class="dv">1</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">ncol=</span><span class="dv">1</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(ClimPCA)<span class="sc">+</span><span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">14</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca</span>(ClimPCA, <span class="at">geom=</span><span class="fu">c</span>(<span class="st">"point"</span>))<span class="sc">+</span><span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">14</span>)),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>ClimPCA<span class="sc">$</span>var<span class="sc">$</span>cor<span class="sc">%&gt;%</span>ggcorrplot<span class="sc">::</span><span class="fu">ggcorrplot</span>(<span class="at">method =</span> <span class="st">"circle"</span>)<span class="sc">+</span><span class="fu">theme_bw</span>(<span class="at">base_size=</span><span class="dv">14</span>)<span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">75</span>,<span class="at">hjust=</span><span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_fixed</span>(<span class="at">ratio=</span>.<span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dimdesc</span>(ClimPCA, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">proba =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Dim.1

Link between the variable and the continuous variables (R-square)
=================================================================================
                     correlation       p.value
Stoch_noisesize_TMax   0.8668087 6.183297e-100
Ampli_trend_TMin       0.4590744  2.130222e-18
Ampli_trend_Prec       0.2177142  7.386559e-05
Ampli_trend_TMax       0.1981180  3.193055e-04
Mean_trend_Prec       -0.4508056  1.008298e-17
Mean_trend_TMax       -0.7434070  1.507656e-58

$Dim.2

Link between the variable and the continuous variables (R-square)
=================================================================================
                 correlation      p.value
Ampli_trend_Prec   0.7886580 2.021982e-70
Mean_trend_TMax    0.4022397 4.147529e-14
Ampli_trend_TMin  -0.2481373 5.784008e-06
Ampli_trend_TMax  -0.2935288 6.707701e-08
Mean_trend_Prec   -0.5476851 6.527546e-27

$Dim.3

Link between the variable and the continuous variables (R-square)
=================================================================================
                 correlation      p.value
Ampli_trend_TMax   0.7230280 5.494684e-54
Ampli_trend_TMin   0.4402050 6.962149e-17
Ampli_trend_Prec   0.3842174 6.557083e-13
Mean_trend_TMax    0.3647761 1.071806e-11
Mean_trend_Prec    0.2271603 3.473356e-05</code></pre>
</div>
</div>
</section>
<section id="mapping-climatic-axes" class="level3">
<h3 class="anchored" data-anchor-id="mapping-climatic-axes">4.3 Mapping climatic axes</h3>
<p>Plot spatial distribution of studies with climatic data available as well as the values of the two main principal component analyses: life-history and environmental PCAs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Plot_clim<span class="ot">&lt;-</span>Metadata<span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(.,<span class="fu">c</span>(ID,Lat,Lon))<span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(.,<span class="at">.keep_all=</span>T)<span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ClimPCA<span class="sc">$</span>ind<span class="sc">$</span>coord)<span class="sc">%&gt;%</span><span class="fu">rownames_to_column</span>(.,<span class="at">var=</span><span class="st">"ID"</span>),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="at">by=</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))<span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="fu">across</span>(Dim<span class="fl">.1</span><span class="sc">:</span>Dim<span class="fl">.3</span>,scales<span class="sc">::</span>rescale,<span class="at">to=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot map</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>gmap<span class="ot">&lt;-</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_map</span>(</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> world, <span class="at">map =</span> world,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(long, lat, <span class="at">map_id =</span> region),</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey50"</span>, <span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">linewidth=</span> <span class="fl">0.05</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>gmap <span class="sc">+</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">left_join</span>(Plot_clim,<span class="fu">distinct</span>(MetadataClean,ID,<span class="at">.keep_all=</span>T)<span class="sc">%&gt;%</span><span class="fu">select</span>(ID)),</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>Lon, <span class="at">y=</span>Lat, <span class="at">fill =</span> Dim<span class="fl">.1</span>,<span class="at">stroke=</span>.<span class="dv">3</span>,<span class="at">size=</span>Dim<span class="fl">.2</span>),<span class="at">shape=</span><span class="dv">21</span>)<span class="sc">+</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_viridis</span>(<span class="at">option=</span><span class="st">"magma"</span>)<span class="sc">+</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(file="Figures/ClimMap_all_taxa2.svg")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="calculate-demographic-buffering-from-vital-rates-lower-level-parameters" class="level1">
<h1>5. Calculate Demographic buffering From Vital Rates <br> (Lower Level Parameters)</h1>
<section id="sourcing-main-function-used-in-this-calculation" class="level2">
<h2 class="anchored" data-anchor-id="sourcing-main-function-used-in-this-calculation">5.1. Sourcing main function used in this calculation</h2>
<p>Main function calculates the stochastic elasticities within respect to variance of lower level vital rates</p>
<ul>
<li><p>This script creates the following functions:</p>
<ol type="1">
<li><p><code>My.vitalRatePerturbation</code>: produce the stochastic elasticity with respect to variance <span class="math inline">\(| \sum E_v^\sigma |\)</span></p>
<ul>
<li>This function is an adaptation of <code>VitalRatePerturbation</code> function in the <code>Rage</code> package (see <span class="citation" data-cites="jones2022">Jones et al. (<a href="#ref-jones2022" role="doc-biblioref">2022</a>)</span>)</li>
</ul></li>
<li><p><code>array_to_matrix</code>: an ancillary function to transform timeseries of MPMs, usually returned as an array element to a timeserie of MPM in a object class matrix.</p></li>
</ol></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"MainFunction - Stochastic elasticities of variance lower level.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "An ancillary function - 'array_to_matrix' - has been created, be pround!"
[1] "Core function 'my.vitalRatePerturbation' - has been created, You nailed it!"
'my.vitalRatePerturbation' is based on: 
- VitalRatePerturbation function in the Rage package: https://github.com/jonesor/Rage. 
- Stochastic elasticticity in Caswell 2001 p.406-407. 
Outputs are: 
[[1]] Lower-level Stochastic Sensitivities 
[[2]] Lower-level Stochastic Elasticities 
[[3]] Lower-level Stochastic Elasticities 
[[4]] Lower-level Stochastic Elasticities with respect  to variance
[[5]] Matrix level stochastic Elasticitity with respect to the meanNULL</code></pre>
</div>
</div>
</section>
<section id="derivative-demographic-buffering-in-plants-and-animals" class="level2">
<h2 class="anchored" data-anchor-id="derivative-demographic-buffering-in-plants-and-animals">5.2. Derivative demographic buffering in plants and animals</h2>
<ul>
<li>Derivates demographic buffering in plants and animals</li>
<li>Merge into a single data frame</li>
</ul>
<!-- COMMENTARY: 
ElasSigVR_data and StochElasVR_data are simpler versions created without standard desviation because sd was not included in the GLMM model. However, the full version ("ElasSigVR_full") is still required to summary
statistics below in 10. Buffering patterns -->
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Organize unique ID to rethrive matrices to metadata after analyses</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>uniqueID&lt;-unique(Metadata$ID)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu"># Create vectors to accomated estimated buffering and ancilliary statistics</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>Buffmx&lt;-temp&lt;-MatRep&lt;-StochElasVR&lt;-ElasSigVR&lt;-SigRatioVR&lt;-NULL</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>for(i in 1:length(uniqueID)){</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>temp&lt;-my.vitalRatePerturbation( </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>lapply(filter(Metadata,ID==uniqueID<span class="co">[</span><span class="ot">i</span><span class="co">]</span>)$mat,matU),  #Determines matU</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>lapply(filter(Metadata,ID==uniqueID<span class="co">[</span><span class="ot">i</span><span class="co">]</span>)$mat,matF),  #Determines matF</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>lapply(filter(Metadata,ID==uniqueID<span class="co">[</span><span class="ot">i</span><span class="co">]</span>)$mat,matC))  #Determines matC</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>Buffmx[<span class="co">[</span><span class="ot">i</span><span class="co">]</span>]&lt;-sum(temp[<span class="co">[</span><span class="ot">5</span><span class="co">]</span>])</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>StochElasVR[<span class="co">[</span><span class="ot">i</span><span class="co">]</span>]&lt;-temp[<span class="co">[</span><span class="ot">3</span><span class="co">]</span>]</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>ElasSigVR[<span class="co">[</span><span class="ot">i</span><span class="co">]</span>]&lt;-temp[<span class="co">[</span><span class="ot">4</span><span class="co">]</span>]</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>names(StochElasVR)[<span class="co">[</span><span class="ot">i</span><span class="co">]</span>]&lt;-uniqueID<span class="co">[</span><span class="ot">i</span><span class="co">]</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>names(ElasSigVR)[<span class="co">[</span><span class="ot">i</span><span class="co">]</span>]&lt;-uniqueID<span class="co">[</span><span class="ot">i</span><span class="co">]</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># quantify timeseries length </span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>MatRep[<span class="co">[</span><span class="ot">i</span><span class="co">]</span>]&lt;-length(lapply(filter(Metadata,ID==uniqueID<span class="co">[</span><span class="ot">i</span><span class="co">]</span>)$mat,matU))</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a> #add verbose </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    if (i == 1 || i%%50 == 0) {</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                message("Calculating mean Matrices", </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>                  i)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>rm(temp)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- This code have been included to speed up buffering calculation 
- Buffering calculation is now saved in a separate object
  - It helps to remove the variability in the iteration process
- Main code to calculate demographic buffering is now in markdown format to avoid running it unintentionaly
-->
<section id="number-of-populations-with-timeseries-longer-than-three" class="level3">
<h3 class="anchored" data-anchor-id="number-of-populations-with-timeseries-longer-than-three">5.2.1. Number of populations with timeseries longer than three</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantify the number of populations with timeseries longer than three</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(MatRep)[<span class="fu">unlist</span>(MatRep)<span class="sc">&gt;</span><span class="dv">2</span>]<span class="sc">%&gt;%</span><span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 182</code></pre>
</div>
</div>
</section>
<section id="merging-demographic-buffering-into-a-single-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="merging-demographic-buffering-into-a-single-data-frame">5.2.2. Merging demographic buffering into a single data frame</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#'---------------------------------------------------------------------------</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#       Merge Demographic buffering calculations in a single Data frame</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'---------------------------------------------------------------------------</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>ElasSigVR_full<span class="ot">&lt;-</span><span class="fu">lapply</span>(ElasSigVR,rownames_to_column, <span class="at">var =</span> <span class="st">"VR"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Map</span>(cbind, <span class="at">ID =</span> <span class="fu">names</span>(.), .)<span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(rbind,.)<span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VR,<span class="at">values_from=</span><span class="fu">c</span>(Mean,SD))<span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>ElasSigVR_data<span class="ot">&lt;-</span><span class="fu">lapply</span>(ElasSigVR,rownames_to_column, <span class="at">var =</span> <span class="st">"VR"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">Map</span>(cbind, <span class="at">ID =</span> <span class="fu">names</span>(.), .)<span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(rbind,.)<span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="sc">-</span>SD)<span class="sc">%&gt;%</span>              <span class="co">#Remove standard desviation</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VR,<span class="at">values_from=</span>Mean)<span class="sc">%&gt;%</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>StochElasVR_data<span class="ot">&lt;-</span><span class="fu">lapply</span>(StochElasVR,rownames_to_column, <span class="at">var =</span> <span class="st">"VR"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="fu">Map</span>(cbind, <span class="at">ID =</span> <span class="fu">names</span>(.), .)<span class="sc">%&gt;%</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="fu">do.call</span>(rbind,.)<span class="sc">%&gt;%</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="sc">-</span>SD)<span class="sc">%&gt;%</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> VR,<span class="at">values_from=</span>Mean)<span class="sc">%&gt;%</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="produce-a-definitive-demographic-buffering-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="produce-a-definitive-demographic-buffering-data-frame">5.2.3. Produce a definitive demographic buffering data frame</h3>
<p>This new data frame will be ready for merging with climatic data and life history traits</p>
<div class="cell" data-result="asis">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>databuff_data<span class="ot">&lt;-</span><span class="fu">left_join</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ElasSigVR_data<span class="sc">%&gt;%</span><span class="fu">setNames</span>(<span class="fu">paste0</span>(<span class="fu">names</span>(.),<span class="st">'_SigElas'</span>)),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>StochElasVR_data<span class="sc">%&gt;%</span><span class="fu">setNames</span>(<span class="fu">paste0</span>(<span class="fu">names</span>(.),<span class="st">'_Base'</span>)),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="at">by=</span><span class="fu">c</span>(<span class="st">"ID_SigElas"</span><span class="ot">=</span><span class="st">"ID_Base"</span>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>databuff_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 350 × 13
   ID_SigElas    Reproduction_SigElas Growth_SigElas Shrinking_SigElas
   &lt;chr&gt;                        &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;
 1 Drc2.151_550            -0.0000551      0.00160         -0.000129  
 2 Drc2.151_548            -0.0000983     -0.00111         -0.0000306 
 3 Drc2.151_546            -0.0000198     -0.000534        -0.0000270 
 4 Drc2.151_547             0              0                0         
 5 Pnx2.399_1046           -0.000236       0.00300          0.00000517
 6 Prm4.582_1157           -0.138          0.0431           0.0142    
 7 Crsm.158_413            -0.0346         0                0         
 8 Trll.304_1438            0             -0.0000977        0.0000160 
 9 Trll.304_1442            0              0.000722        -0.00000727
10 Trll.304_1445            0              0.000158         0.00000199
# ℹ 340 more rows
# ℹ 9 more variables: Clonality_SigElas &lt;dbl&gt;, Survival_SigElas &lt;dbl&gt;,
#   Cumulative_SigElas &lt;dbl&gt;, Reproduction_Base &lt;dbl&gt;, Growth_Base &lt;dbl&gt;,
#   Shrinking_Base &lt;dbl&gt;, Clonality_Base &lt;dbl&gt;, Survival_Base &lt;dbl&gt;,
#   Cumulative_Base &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>MPMinfo<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a> <span class="at">Buffmx=</span><span class="fu">unlist</span>(Buffmx),</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">MatRep=</span><span class="fu">unlist</span>(MatRep),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">ID=</span>uniqueID)<span class="sc">%&gt;%</span><span class="fu">as_tibble</span>()</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>databuff_data<span class="ot">&lt;-</span><span class="fu">left_join</span>(</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a> databuff_data,MPMinfo,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">by=</span><span class="fu">c</span>(<span class="st">"ID_SigElas"</span><span class="ot">=</span><span class="st">"ID"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(MatRep<span class="sc">&gt;</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rename</span>(<span class="at">ID=</span><span class="st">"ID_SigElas"</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparing buffering in vital rates and life history traits</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>databuff_data<span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,LHtraits,<span class="at">by=</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))<span class="sc">%&gt;%</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="sc">-</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span><span class="fu">cor</span>()<span class="sc">%&gt;%</span>corrplot<span class="sc">::</span><span class="fu">corrplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(.): the standard deviation is zero</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="merging-all-climatic-data-life-history-buffering" class="level1">
<h1>6. Merging all (Climatic data + Life history + Buffering)</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ClimPCA<span class="sc">$</span>ind<span class="sc">$</span>coord)<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">"Dim."</span>, <span class="st">"ClimPC."</span>, <span class="fu">colnames</span>(ClimPCA<span class="sc">$</span>ind<span class="sc">$</span>coord))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(LHpca<span class="sc">$</span>ind<span class="sc">$</span>coord)<span class="ot">&lt;-</span><span class="fu">gsub</span>(<span class="st">"Dim."</span>, <span class="st">"LHPC."</span>, <span class="fu">colnames</span>(LHpca<span class="sc">$</span>ind<span class="sc">$</span>coord))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>LHpca_axes12<span class="ot">&lt;-</span>LHpca<span class="sc">$</span>ind<span class="sc">$</span>coord[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]<span class="sc">%&gt;%</span><span class="fu">data.frame</span>()<span class="sc">%&gt;%</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>ClimPCA_axes123<span class="ot">&lt;-</span>ClimPCA<span class="sc">$</span>ind<span class="sc">$</span>coord[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)]<span class="sc">%&gt;%</span><span class="fu">data.frame</span>()<span class="sc">%&gt;%</span><span class="fu">rownames_to_column</span>(<span class="st">"ID"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>merged_data<span class="ot">&lt;-</span>databuff_data<span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,LHpca_axes12,<span class="at">by=</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,ClimPCA_axes123,<span class="at">by=</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))<span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,MetadataClean,<span class="at">by=</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(ID,<span class="at">.keep_all=</span><span class="cn">TRUE</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>merged_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 × 30
   ID    Reproduction_SigElas Growth_SigElas Shrinking_SigElas Clonality_SigElas
   &lt;chr&gt;                &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;             &lt;dbl&gt;
 1 Drc2…           -0.0000551      0.00160        -0.000129                    0
 2 Prm4…           -0.138          0.0431          0.0142                      0
 3 Trll…            0             -0.0000977       0.0000160                   0
 4 Trll…            0              0.000722       -0.00000727                  0
 5 Trll…            0              0.000640       -0.0000496                   0
 6 Trll…            0              0.000102       -0.000196                    0
 7 Trll…            0             -0.000569       -0.000170                    0
 8 Trll…            0              0.0000227       0                           0
 9 Trll…            0              0.000256        0.0000229                   0
10 Trll…            0             -0.00157         0.000000315                 0
# ℹ 124 more rows
# ℹ 25 more variables: Survival_SigElas &lt;dbl&gt;, Cumulative_SigElas &lt;dbl&gt;,
#   Reproduction_Base &lt;dbl&gt;, Growth_Base &lt;dbl&gt;, Shrinking_Base &lt;dbl&gt;,
#   Clonality_Base &lt;dbl&gt;, Survival_Base &lt;dbl&gt;, Cumulative_Base &lt;dbl&gt;,
#   Buffmx &lt;dbl&gt;, MatRep &lt;int&gt;, LHPC.1 &lt;dbl&gt;, LHPC.2 &lt;dbl&gt;, ClimPC.1 &lt;dbl&gt;,
#   ClimPC.2 &lt;dbl&gt;, ClimPC.3 &lt;dbl&gt;, SpeciesAccepted &lt;chr&gt;, Kingdom &lt;chr&gt;,
#   Phylum &lt;chr&gt;, Class &lt;chr&gt;, Order &lt;chr&gt;, OrganismType &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Correlation plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>merged_data<span class="sc">%&gt;%</span><span class="fu">select_if</span>(is.numeric)<span class="sc">%&gt;%</span><span class="fu">cor</span>()<span class="sc">%&gt;%</span>corrplot<span class="sc">::</span><span class="fu">corrplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="building-the-super-tree-and-make-sure-it-works-on-phylogenetic-analyses" class="level1">
<h1>7. Building the super tree and make sure it works on phylogenetic analyses</h1>
<ul>
<li><p>Check must return:</p>
<ul>
<li><p>No duplicates: Each species is a tip in the phylogeny</p></li>
<li><p>No polytomyes: Methods require no polytomyes so it need to be removed</p></li>
<li><p>Is.rooted == TRUE: A phylogeny need a root, it is, an initial state</p></li>
<li><p>is.binary == TRUE:</p></li>
<li><p>is.ultrametric == TRUE: Ultrametic means branches lenght reflect evolutionary history,</p></li>
<li><p>“any edge == 0” == FALSE.</p></li>
</ul></li>
</ul>
<div class="cell" data-result="hide">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make subtree</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>sppINphylo<span class="ot">&lt;-</span><span class="fu">unique</span>(merged_data<span class="sc">$</span>Binomial)[<span class="fu">unique</span>(merged_data<span class="sc">$</span>Binomial)<span class="sc">%in%</span>supertree<span class="sc">$</span>tip]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>subtree<span class="ot">&lt;-</span><span class="fu">keep.tip</span>(supertree, sppINphylo)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Check and Avoid duplicates</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(subtree<span class="sc">$</span>node.label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>subtree<span class="ot">&lt;-</span><span class="fu">makeNodeLabel</span>(subtree); <span class="fu">any</span>(<span class="fu">duplicated</span>(subtree<span class="sc">$</span>node.label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Avoid polytomyes</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>subtree_backup<span class="ot">&lt;-</span>subtree<span class="ot">&lt;-</span><span class="fu">multi2di</span>(subtree)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Make sure branches are comparable, non-negative and non-zero</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>subtree<span class="sc">$</span>edge.length<span class="ot">&lt;-</span>scales<span class="sc">::</span><span class="fu">rescale</span>(subtree<span class="sc">$</span>edge.length,<span class="at">to=</span><span class="fu">c</span>(<span class="fl">0.00001</span>,.<span class="dv">99999</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Force ultrametric</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>subtree<span class="ot">&lt;-</span>phytools<span class="sc">::</span><span class="fu">force.ultrametric</span>(subtree, <span class="at">method=</span><span class="st">"extend"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>***************************************************************
*                          Note:                              *
*    force.ultrametric does not include a formal method to    *
*    ultrametricize a tree &amp; should only be used to coerce    *
*   a phylogeny that fails is.ultrametric due to rounding --  *
*    not as a substitute for formal rate-smoothing methods.   *
***************************************************************</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check if structure are kept</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(subtree,subtree_backup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal.phylo</span>(subtree,subtree_backup,<span class="at">use.edge.length=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.rooted</span>(subtree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.binary</span>(subtree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.ultrametric</span>(subtree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(subtree<span class="sc">$</span>edge.length<span class="sc">==</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>subtree<span class="sc">$</span>edge.length[subtree<span class="sc">$</span>edge.length<span class="sc">==</span><span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
</div>
</section>
<section id="produce-final-dataset-and-phylogenetic-analyses" class="level1">
<h1>8. Produce final dataset and phylogenetic analyses</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="ot">&lt;-</span>merged_data<span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">phylo=</span>Binomial)<span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">inPhylo=</span>Binomial<span class="sc">%in%</span>sppINphylo)<span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(inPhylo<span class="sc">!=</span><span class="cn">FALSE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="sc">-</span>inPhylo)<span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(.,<span class="fu">match</span>(Binomial,subtree<span class="sc">$</span>tip))<span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>final_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               ID Reproduction_SigElas Growth_SigElas Shrinking_SigElas
1    Urs2.183_726         1.364528e-04   7.525562e-04      4.928246e-04
2    Flcn.170_257        -1.938652e-03   0.000000e+00      0.000000e+00
3    Lgps.394_383        -2.377753e-02   0.000000e+00      0.000000e+00
4    Lgps.394_384        -1.022987e-02   0.000000e+00      0.000000e+00
5    Scl2.252_644        -1.766308e-06  -3.650052e-03      0.000000e+00
6    Xnsr.320_747        -1.805037e-04  -5.502203e-04      0.000000e+00
7    Xnsr.320_746        -2.421680e-03  -3.121283e-03      0.000000e+00
8    Xnsr.414_745        -4.923438e-03  -7.674374e-03      0.000000e+00
9     Clnc.87_178        -3.162860e-01   4.751101e-03      0.000000e+00
10    Clnc.87_177        -1.097668e-01  -4.329936e-03      0.000000e+00
11   Clsl.157_182         1.101861e-01   0.000000e+00      0.000000e+00
12    Scl2.22_651        -1.829560e-03   0.000000e+00      0.000000e+00
13   Prmr.231_529        -3.473658e-05  -2.503286e-05      7.266289e-04
14   Ephr.267_629        -3.746532e-04  -7.572104e-04      3.269931e-05
15   Hypr.463_756        -6.467530e-02  -4.189061e-03     -1.993659e-03
16    Agrm.300_46         2.274530e-05  -2.648489e-03      5.880106e-05
17  Prsh.362_1204         3.710245e-05   6.848113e-03     -7.212616e-04
18   Ccrb.457_472         2.780779e-01  -4.533997e-04      0.000000e+00
19   Cstn.134_322         9.410967e-07  -3.264915e-04      2.075794e-05
20   Cstn.134_326        -1.011935e-07  -7.387550e-04      2.398223e-05
21   Cstn.134_325         1.007925e-07  -1.305185e-04      2.980198e-05
22   Cstn.134_324        -7.655142e-07  -3.928064e-05      3.473416e-05
23   Cstn.134_323        -1.846865e-06  -2.030624e-03      9.826631e-05
24   Astr.326_189        -1.301715e-02   5.216766e-03     -1.370287e-02
25   Astr.409_177         1.176005e-02   2.087632e-03      0.000000e+00
26   Astr.267_196         1.278097e-04  -4.118595e-03      3.892633e-05
27   Dryc.267_540         3.067388e-02   8.848441e-03      0.000000e+00
28   Ant..355_100         1.908372e-04  -1.420634e-04      1.226419e-03
29   Lpns.132_902         1.058989e-03  -1.189091e-02      2.629081e-03
30   Lpns.132_901         1.124107e-03  -6.153192e-03      3.406878e-03
31    Lpn..55_899        -4.611941e-02   3.033784e-02      9.327366e-04
32   Crp2.123_294        -7.193321e-07   2.644265e-04      0.000000e+00
33    Acrs.330_19        -1.942699e-03  -3.815111e-03      0.000000e+00
34    All4.185_58         9.441758e-02  -1.129481e-03      0.000000e+00
35    All4.185_56         9.409866e-02  -2.513995e-03      0.000000e+00
36    All4.185_62         3.897842e-02  -3.568100e-04      0.000000e+00
37    All4.185_55         1.651605e-01  -9.997637e-03      0.000000e+00
38    All4.185_59         1.699247e-01  -4.329829e-03      0.000000e+00
39    All4.185_65         1.461733e-01  -9.709006e-03      0.000000e+00
40  Sphr.129_1358        -2.104041e-01   0.000000e+00      0.000000e+00
41   Hlnt.267_711        -2.335690e-03  -1.148483e-02      1.611358e-03
42   Hlnt.267_712        -3.580157e-03  -3.124747e-02      8.387555e-04
43   Erdm.267_599        -2.754661e-05  -1.082883e-03     -1.066889e-04
44   Erdm.267_598         2.808797e-05   4.280003e-04     -6.524920e-05
45  Ont..575_1014        -3.797247e-02  -2.640438e-04     -1.654824e-06
46  Sxfr.152_1302         4.350709e-01   0.000000e+00     -1.068240e-01
47  Pln2.608_1122         2.861199e-03  -6.155718e-02      1.189334e-03
48  Pln2.608_1124        -1.185861e-02  -2.086196e-02      1.059105e-03
49  Pln2.608_1129        -6.571590e-03  -9.694594e-04      2.344591e-03
50   Drc2.151_550        -5.514313e-05   1.598278e-03     -1.286515e-04
51   Drc2.151_549         4.792627e-05  -1.991213e-03     -1.105230e-04
52  Rmnd.445_1217        -3.507665e-06   2.483465e-05     -8.568739e-06
53  Rmnd.445_1214         5.069338e-05  -1.280223e-02      5.437151e-04
54   Myst.152_983         6.352450e-01   0.000000e+00      2.104031e-03
55   Gntn.423_679         5.785807e-04  -3.895910e-03      9.044300e-04
56   Hypc.282_759         1.857057e-04  -8.573868e-04      1.252851e-02
57   Echn.129_555        -4.556823e-02   0.000000e+00      0.000000e+00
58   Ech2.263_557        -3.341240e-04  -2.446895e-04      1.211224e-06
59   Ech2.263_556         5.442867e-05   3.648008e-04     -9.845581e-05
60  Rtbd.129_1225        -6.581060e-01   0.000000e+00      0.000000e+00
61   Ltrs.166_862        -5.985893e-03   3.201929e-02      3.136667e-03
62   Artm.355_146        -3.480291e-05   1.380049e-05      1.180574e-03
63  Sldg.129_1354        -1.270544e-01   0.000000e+00      0.000000e+00
64   Crsm.474_389        -8.065638e-03  -1.568766e-02      0.000000e+00
65   Crsm.283_383         1.540169e-04  -1.194387e-04     -1.143753e-04
66   Crsm.283_384         3.489597e-04  -2.180634e-04      5.892436e-05
67   Crsm.283_386         5.062695e-04   6.639794e-03      1.117036e-02
68    Crs3.41_395         8.653618e-02   3.700410e-03      7.132525e-05
69   Crs5.166_400         8.155830e-02   7.619270e-04      1.274713e-04
70   Crsm.129_409        -2.326958e-02   0.000000e+00      0.000000e+00
71   Jrnf.267_786        -4.216837e-03  -1.427212e-04      1.230737e-04
72   Cntr.282_346         4.987168e-02  -4.278258e-03     -1.530113e-03
73   Cntr.282_347         2.742320e-02   3.520732e-03     -1.055724e-03
74   Chrl.267_374        -6.069221e-03  -1.206062e-03      0.000000e+00
75   Crmc.301_320         5.571422e-02  -1.885842e-03      7.835922e-04
76   Crmc.301_319         4.989620e-02  -8.745159e-03     -1.267489e-04
77  Sccs.282_1371        -2.506157e-04   1.272455e-03      1.058512e-03
78  Sccs.282_1370         5.875971e-04   3.624779e-04     -5.457551e-04
79  Sccs.282_1368        -6.744761e-05   1.534331e-03     -1.068427e-03
80  Scc3.381_1377         6.927251e-04   1.134496e-02      2.694870e-04
81   Ards.431_127        -2.818867e-04  -9.146217e-03      3.799730e-05
82    Andr.152_83         3.514658e-01   0.000000e+00     -3.849840e-02
83  Prm4.582_1157        -1.383515e-01   4.312519e-02      1.416895e-02
84   Prm5.73_1164        -7.772986e-06   1.600067e-03      1.700682e-03
85  Prml.272_1153         8.362892e-06  -7.918209e-04     -1.459930e-04
86  Prml.596_1165         3.602506e-04   1.076073e-02      1.101186e-03
87  Prm2.170_1169        -1.327601e-02   7.679306e-04      5.229724e-04
88  Prm3.591_1170        -4.455454e-04   2.412247e-03      3.129632e-04
89  Srr2.571_1298        -1.243162e-05   1.833618e-04      5.677130e-07
90  Prny.129_1065        -1.238293e-01   0.000000e+00      0.000000e+00
91   Atrp.603_217         2.355208e-04  -9.955307e-02      6.960505e-04
92   Nbxb.182_991         6.478582e-05   1.096793e-03     -2.204655e-05
93   Nbx2.183_992         6.889012e-05   1.764007e-03     -2.011543e-05
94   Nbx3.183_990        -4.282122e-06  -1.080990e-04     -8.074914e-05
95   Mmml.193_925        -1.337765e-06   7.099273e-04      1.307458e-03
96   Mmm2.194_928        -3.284005e-04   4.792671e-03      1.384336e-04
97   Mmml.490_935        -1.374624e-03   3.370801e-04      1.961760e-05
98   Arcr.350_132        -1.682590e-05   9.715924e-04      1.293279e-05
99   Arcr.350_131        -4.309725e-06  -4.129180e-04      3.501265e-04
100  Cryp.511_463        -9.527210e-06  -1.126878e-03      0.000000e+00
101 Rmxr.267_1261         1.198250e-04   1.785600e-03     -3.525705e-04
102  Armr.208_139        -2.174559e-03  -2.217982e-03     -7.709862e-05
103  Lmnm.267_871        -6.700071e-03   2.738740e-03     -6.570648e-04
104 Rnnc.266_1222        -4.509389e-02  -2.512034e-02      1.903172e-03
105   Acts.204_27        -7.254452e-05   2.080658e-03      4.607404e-04
106   Acts.204_28        -6.588281e-05   9.105740e-04     -2.351034e-04
107  Dcnt.331_511        -3.774857e-05  -1.493787e-04     -2.862153e-06
108  Dcnt.331_510         1.842111e-04   1.161441e-03     -1.939162e-04
109  Dcnt.331_509        -4.033717e-04   1.411501e-03      4.228909e-04
110  Chmd.594_367        -3.817657e-04   4.294244e-05      0.000000e+00
111  Chmd.172_368         3.176458e-04   2.708267e-03      1.582705e-03
112   Brss.36_238        -9.842322e-06   6.164722e-05      4.547185e-06
113 Plpn.355_1136        -9.921824e-05   2.448080e-03      2.793806e-04
114 Zdpl.500_1534        -1.057153e-04   1.343679e-02      9.896167e-04
115  Dnth.384_499        -3.826597e-03   1.996066e-03      2.438940e-03
116  Hlrm.601_725        -1.551924e-03  -2.504789e-02      1.198529e-03
117  Ctps.143_328        -8.939245e-03   3.979938e-04     -4.361848e-04
118 Orch.273_1029        -1.479776e-04   3.981909e-04      8.641597e-04
119  Cypr.576_483        -9.207344e-05   4.108961e-04     -3.307495e-04
120  Cypr.576_482        -1.186338e-04   2.274123e-03      1.937584e-03
121  Cypr.576_484        -4.596083e-05  -1.137449e-04     -5.377853e-04
122   Allm.402_69         2.766143e-03  -1.017325e-03      1.863293e-04
123 Trll.304_1438         0.000000e+00  -9.770756e-05      1.595867e-05
124 Trll.304_1442         0.000000e+00   7.217425e-04     -7.271393e-06
125 Trll.304_1446         0.000000e+00   6.397791e-04     -4.955547e-05
126 Trll.304_1443         0.000000e+00   1.018407e-04     -1.959553e-04
127 Trll.304_1437         0.000000e+00  -5.688097e-04     -1.698155e-04
128 Trll.304_1435         0.000000e+00   2.265819e-05      0.000000e+00
129 Trll.304_1439         0.000000e+00   2.564256e-04      2.294640e-05
130 Trll.304_1441         0.000000e+00  -1.568601e-03      3.146574e-07
131 Trll.304_1444         0.000000e+00   3.708480e-04      3.718267e-05
132  Clch.382_287        -4.962345e-04   6.965824e-04      3.703569e-04
133  Asrm.131_148        -6.751073e-03   1.041108e-03      0.000000e+00
134 Pnss.391_1116         8.702378e-06   1.773344e-04      0.000000e+00
    Clonality_SigElas Survival_SigElas Cumulative_SigElas Reproduction_Base
1        0.000000e+00    -1.692481e-02      -0.0155429721      0.0197248821
2        0.000000e+00    -7.611464e-03      -0.0095501157      0.1232468171
3        0.000000e+00    -8.279373e-02      -0.1065712526      0.3462910353
4        0.000000e+00    -9.817078e-02      -0.1084006494      0.2242017642
5        0.000000e+00    -6.627570e-03      -0.0102793875      0.1033852123
6        0.000000e+00    -2.302241e-03      -0.0030329646      0.0519432883
7        0.000000e+00    -9.403786e-03      -0.0149467498      0.1146915381
8        0.000000e+00    -4.012159e-02      -0.0527193995      0.1005632685
9        0.000000e+00    -7.039959e-01      -1.0155307652      0.4452559759
10       0.000000e+00    -2.201415e-01      -0.3342382840      0.2564613326
11       0.000000e+00     7.211032e-05       0.1102581640      0.0000000000
12       0.000000e+00    -7.208796e-03      -0.0090383560      0.0801650625
13       0.000000e+00    -9.571801e-04      -0.0002903206      0.0100477745
14       0.000000e+00    -1.492507e-03      -0.0025916716      0.0208575272
15       0.000000e+00    -1.199857e-01      -0.1908436699      0.1574231567
16       0.000000e+00    -6.514767e-03      -0.0090817103      0.0187942564
17       0.000000e+00     6.431885e-02       0.0704828041      0.0100989031
18       0.000000e+00    -7.402989e-04       0.2768842385      0.0000000000
19       0.000000e+00    -3.302788e-04      -0.0006350713      0.0042349408
20       0.000000e+00    -1.278424e-03      -0.0019932976      0.0046392387
21       0.000000e+00    -4.386394e-04      -0.0005392551      0.0011490011
22       0.000000e+00    -2.161637e-04      -0.0002214757      0.0051360454
23       0.000000e+00    -2.491582e-03      -0.0044257874      0.0062306310
24       0.000000e+00    -1.907617e-02      -0.0405794188      0.1590745115
25       0.000000e+00     4.929481e-02       0.0631424979      0.0584920277
26       0.000000e+00    -1.147877e-04      -0.0040666465      0.0319563555
27       0.000000e+00     1.209782e-01       0.1605005273      0.0741727391
28       0.000000e+00    -6.002037e-03      -0.0047268433      0.0405977458
29       0.000000e+00    -1.122510e-03      -0.0093253474      0.0829108661
30       0.000000e+00    -7.458346e-03      -0.0090805532      0.0770128960
31       0.000000e+00    -1.087097e-01      -0.1235585541      0.3257759679
32       0.000000e+00     1.196359e-03       0.0014600660      0.0052306828
33       0.000000e+00    -8.748851e-03      -0.0145066615      0.0516656630
34       0.000000e+00    -5.179131e-03       0.0881089646      0.0000000000
35       0.000000e+00     3.004808e-03       0.0945894720      0.0000000000
36       0.000000e+00    -9.294972e-03       0.0293266359      0.0000000000
37       0.000000e+00    -3.394509e-02       0.1212177982      0.0000000000
38       0.000000e+00     3.813056e-02       0.2037254736      0.0000000000
39       0.000000e+00    -9.146317e-02       0.0450010817      0.0000000000
40       0.000000e+00    -4.226229e-01      -0.6330270154      0.6677830504
41       0.000000e+00    -1.087410e-02      -0.0230832569      0.0530603772
42       0.000000e+00    -7.192719e-02      -0.1059160671      0.1254696234
43       0.000000e+00    -9.970538e-04      -0.0022141725      0.0098806075
44       0.000000e+00    -1.383320e-03      -0.0009924813      0.0131953830
45       0.000000e+00    -6.886427e-02      -0.1071024312      0.0782870048
46       0.000000e+00    -1.145268e-01       0.2137200951      0.0000000000
47       0.000000e+00    -1.296219e-01      -0.1871285211      0.1806201390
48       0.000000e+00    -6.666257e-02      -0.0983240409      0.1784938543
49       0.000000e+00    -4.696490e-02      -0.0521613555      0.1371370729
50       0.000000e+00     6.214475e-03       0.0076289579      0.0146967690
51       0.000000e+00    -2.006373e-03      -0.0040601833      0.0257270307
52       0.000000e+00     8.781801e-05       0.0001005763      0.0183693660
53       0.000000e+00    -2.205962e-02      -0.0342674372      0.0109517287
54       0.000000e+00    -2.059389e-03       0.6352896581      0.0000000000
55       0.000000e+00    -8.605643e-03      -0.0110185425      0.0591399887
56       9.106199e-04    -1.086539e-02       0.0019020587      0.0601162813
57       0.000000e+00    -1.124150e-01      -0.1579832558      0.3886782543
58       0.000000e+00    -4.998179e-04      -0.0010774201      0.0180489979
59       0.000000e+00     4.976895e-04       0.0008184631      0.0272615749
60       0.000000e+00    -1.355710e+00      -2.0138158723      1.1375038324
61       0.000000e+00     1.216314e-02       0.0413332040      0.0840052449
62       0.000000e+00    -2.632782e-03      -0.0014732110      0.0381488743
63       0.000000e+00    -2.734569e-01      -0.4005113269      0.6514233962
64       0.000000e+00    -3.054799e-02      -0.0543012894      0.1280766816
65       1.807953e-01    -8.720921e-03       0.1719946290      0.0000000000
66       7.802471e-02    -4.518761e-03       0.0736957665      0.0000000000
67       2.395295e-01    -1.696512e-01       0.0881946579      0.0000000000
68       0.000000e+00     8.134306e-03       0.0984422249      0.0000000000
69       0.000000e+00    -9.336925e-04       0.0815140053      0.0000000000
70       0.000000e+00    -4.756358e-02      -0.0708331612      0.4547379525
71       0.000000e+00    -2.828022e-02      -0.0325167026      0.1146798428
72       2.626497e-01    -2.402223e-02       0.2826907289      0.0000000000
73       4.262420e-01    -7.199570e-02       0.3841345465      0.0000000000
74       0.000000e+00    -1.375033e-02      -0.0210256103      0.1066981183
75       0.000000e+00    -8.400276e-03       0.0462116981      0.0000000000
76       0.000000e+00    -4.276458e-03       0.0367478326      0.0000000000
77       8.462191e-04     1.191313e-03       0.0041178833      0.0442656069
78       2.201031e-05     1.613227e-03       0.0020395569      0.0588650721
79       1.797835e-04     1.966254e-03       0.0025444941      0.0547330460
80       0.000000e+00     4.990288e-02       0.0622100563      0.0406600099
81       0.000000e+00     1.951426e-02       0.0101241581      0.0484153522
82       0.000000e+00    -9.305599e-02       0.2199114054      0.0000000000
83       0.000000e+00    -2.185634e-01      -0.2996207857      0.2723426030
84       0.000000e+00    -7.504536e-03      -0.0042115602      0.0480514082
85       0.000000e+00    -2.314389e-03      -0.0032438397      0.0326831824
86       0.000000e+00    -4.275384e-02      -0.0305316733      0.0302341211
87       0.000000e+00    -1.809123e-02      -0.0300763392      0.0686846184
88       0.000000e+00    -5.575161e-05       0.0022239136      0.0460930633
89       0.000000e+00     2.331020e-04       0.0004045999      0.0206966824
90       0.000000e+00    -2.811162e-01      -0.4049455351      0.5248679129
91       0.000000e+00    -1.367290e-01      -0.2353505230      0.0278021143
92       0.000000e+00     1.594839e-03       0.0027343721      0.0060150092
93       0.000000e+00    -3.172368e-03      -0.0013595864      0.0065561255
94       0.000000e+00     8.680372e-04       0.0006749069      0.0116839089
95       0.000000e+00    -8.349851e-05       0.0019325491      0.0001958907
96       0.000000e+00     8.959835e-03       0.0135625394      0.0663375594
97       0.000000e+00    -3.171483e-03      -0.0041894093      0.0170813096
98       0.000000e+00     2.693891e-03       0.0036615905      0.0056779808
99       0.000000e+00    -3.169151e-02      -0.0317586117      0.0028227417
100      0.000000e+00    -1.048319e-03      -0.0021847250      0.0256800228
101      0.000000e+00    -1.200429e-02      -0.0104514359      0.0195919196
102      0.000000e+00    -5.819248e-03      -0.0102888869      0.0643206097
103      0.000000e+00    -4.083153e-03      -0.0087015483      0.0805434729
104      0.000000e+00    -1.307869e-01      -0.1990979463      0.2774854882
105      0.000000e+00     5.421641e-03       0.0078904944      0.0278940086
106      0.000000e+00     5.401356e-03       0.0060109438      0.0157481089
107     -7.275529e-05    -1.323052e-05      -0.0002759752      0.0035427636
108      2.233719e-04    -9.700826e-06       0.0013654069      0.0102294121
109      3.039467e-04     6.954876e-04       0.0024304547      0.0205109477
110     -2.120882e-05    -2.245672e-04      -0.0005845992      0.0232502019
111      0.000000e+00    -3.716247e-04       0.0042369927      0.0271430776
112      0.000000e+00     4.172605e-04       0.0004736126      0.0098350576
113      1.265238e-04     4.250371e-03       0.0070051368      0.0118699596
114      0.000000e+00     7.758207e-03       0.0220788988      0.0343599847
115      0.000000e+00    -3.591053e-02      -0.0353021194      0.0546882635
116      0.000000e+00    -8.005753e-02      -0.1054588184      0.0658793777
117      0.000000e+00    -1.272564e-02      -0.0217030794      0.0454652527
118      0.000000e+00    -5.077108e-03      -0.0039627351      0.0198246100
119      0.000000e+00    -1.337868e-03      -0.0013497951      0.0279596217
120      0.000000e+00    -1.334057e-04       0.0039596679      0.0260059423
121      0.000000e+00    -2.273735e-03      -0.0029712256      0.0257139012
122      2.708920e-01    -2.358525e-03       0.2704686714      0.0000000000
123      0.000000e+00    -1.731355e-03      -0.0018131038      0.0076042551
124      0.000000e+00    -1.970706e-04       0.0005174006      0.0131320524
125      0.000000e+00     1.151916e-03       0.0017421393      0.0016302185
126      0.000000e+00    -8.259829e-04      -0.0009200976      0.0075877066
127      0.000000e+00    -7.087578e-04      -0.0014473830      0.0181232486
128      0.000000e+00    -5.200273e-04      -0.0004973691      0.0080675020
129      0.000000e+00    -4.206070e-04      -0.0001412349      0.0088870471
130      0.000000e+00    -4.055232e-03      -0.0056235191      0.0209670439
131      0.000000e+00     3.065281e-05       0.0004386835      0.0062736872
132      0.000000e+00    -1.646235e-03      -0.0010755302      0.0298040064
133     -1.010784e-03    -2.229265e-02      -0.0290133976      0.0516794999
134      0.000000e+00     9.126873e-04       0.0010987241      0.0044381842
     Growth_Base Shrinking_Base Clonality_Base Survival_Base Cumulative_Base
1    0.043845806  -0.0098642914    0.000000000    1.10218780       1.1558942
2    0.000000000   0.0000000000    0.000000000    0.83317542       0.9564222
3    0.000000000   0.0000000000    0.000000000    1.16314745       1.5094385
4    0.000000000   0.0000000000    0.000000000    1.33438892       1.5585907
5    0.135054984   0.0000000000    0.000000000    1.08445915       1.3228993
6    0.146554625   0.0000000000    0.000000000    0.92021949       1.1187174
7    0.105110378   0.0000000000    0.000000000    1.02437333       1.2441753
8    0.163429196   0.0000000000    0.000000000    0.92379831       1.1877908
9    0.109955126   0.0000000000    0.000000000    1.64817699       2.2033881
10   0.155009839   0.0000000000    0.000000000    1.37013424       1.7816054
11   0.000000000   0.0000000000    0.000000000    1.38613391       1.3861339
12   0.000000000   0.0000000000    0.000000000    0.70408036       0.7842454
13   0.052601249  -0.0497611179    0.000000000    1.12392931       1.1368172
14   0.017781476  -0.0040658388    0.000000000    1.03620846       1.0707816
15   0.291021640  -0.0235077738    0.000000000    1.22124002       1.6461770
16   0.046532915  -0.0252377704    0.000000000    0.99849590       1.0385853
17   0.123153808  -0.1211425363    0.000000000    2.22153669       2.2336469
18   0.227465719   0.0000000000    0.000000000    0.31028144       0.5377472
19   0.022956031  -0.0169400089    0.000000000    1.01244470       1.0226957
20   0.024670040  -0.0066842007    0.000000000    0.98314050       1.0057656
21   0.021885167  -0.0459680732    0.000000000    1.04099839       1.0180645
22   0.029506109  -0.0157584576    0.000000000    0.97712079       0.9960045
23   0.030017554  -0.0278808876    0.000000000    1.03087155       1.0392388
24   0.148486462  -0.1787462820    0.000000000    0.98717326       1.1159879
25   0.221682266   0.0000000000    0.000000000    0.64633146       0.9265058
26   0.048060150  -0.0220012523    0.000000000    0.96090237       1.0189176
27   0.150528002   0.0000000000    0.000000000    0.71863947       0.9433402
28   0.135504333  -0.0542912135    0.000000000    1.01154790       1.1333588
29   0.151524711  -0.0335898645    0.000000000    0.95637650       1.1572222
30   0.131612228  -0.0468899761    0.000000000    0.96817896       1.1299141
31   0.323320075  -0.0109667062    0.000000000    1.59009900       2.2282283
32   0.025705011   0.0000000000    0.000000000    1.07303795       1.1039736
33   0.077070222   0.0000000000    0.000000000    0.97785757       1.1065935
34   0.068110375   0.0000000000    0.000000000    0.79927550       0.8673859
35   0.120071752   0.0000000000    0.000000000    1.03441703       1.1544888
36   0.017402154   0.0000000000    0.000000000    1.22880092       1.2462031
37   0.124064805   0.0000000000    0.000000000    0.80641755       0.9304824
38   0.119606632   0.0000000000    0.000000000    0.91152088       1.0311275
39   0.102090469   0.0000000000    0.000000000    0.82794900       0.9300395
40   0.000000000   0.0000000000    0.000000000    1.51032393       2.1781070
41   0.196690337  -0.0183160611    0.000000000    1.06272781       1.2941625
42   0.230190580  -0.0084022304    0.000000000    1.06742358       1.4146815
43   0.045247924  -0.0451766662    0.000000000    1.03927339       1.0492253
44   0.038922030  -0.0326056406    0.000000000    1.00949956       1.0290113
45  -0.030593473  -0.0001670247    0.000000000    1.22658918       1.2741157
46   0.000000000   0.2629095281    0.000000000    0.30404508       0.5669546
47   0.326295790  -0.0295399738    0.000000000    1.30948060       1.7868566
48   0.279340611  -0.0602550298    0.000000000    1.07791415       1.4754936
49   0.239336493  -0.0622901604    0.000000000    0.99828306       1.3124665
50   0.065332427  -0.0149823337    0.000000000    1.05571168       1.1207585
51   0.091023884  -0.0328602230    0.000000000    1.00685253       1.0907432
52   0.062215130  -0.0417155300    0.000000000    0.95843770       0.9973067
53   0.096199075  -0.0587740376    0.000000000    1.06774405       1.1161208
54   0.000000000   0.0115234209    0.000000000    0.03209838       0.0436218
55   0.099974244  -0.0627958489    0.000000000    0.94980496       1.0461233
56   0.164456841  -0.1810876763    0.012214464    1.23914955       1.2948495
57   0.000000000   0.0000000000    0.000000000    1.23599012       1.6246684
58   0.039190766  -0.0009753174    0.000000000    0.97744271       1.0337072
59   0.050889005  -0.0042012425    0.000000000    0.97562538       1.0495747
60   0.000000000   0.0000000000    0.000000000    2.45764352       3.5951474
61   0.134589297   0.0289033902    0.000000000    0.96562966       1.2131276
62   0.118713556  -0.0628747860    0.000000000    0.95838311       1.0523708
63   0.000000000   0.0000000000    0.000000000    1.43506497       2.0864884
64   0.210378707   0.0000000000    0.000000000    0.83133697       1.1697924
65   0.030149780   0.0244474052    0.155790817    0.69946822       0.9098562
66   0.010851372   0.0151922895    0.209461378    0.86348107       1.0989861
67   0.011462506   0.0959474018    0.137080884    0.94881103       1.1933018
68   0.113529808  -0.0041325400    0.000000000    0.81297575       0.9223730
69   0.217607014  -0.0028378709    0.000000000    0.64000095       0.8547701
70   0.000000000   0.0000000000    0.000000000    1.07825094       1.5329889
71  -0.001372050   0.0001373277    0.000000000    1.35556564       1.4690108
72   0.026680203  -0.0154953162    0.030787899    0.98226863       1.0242414
73   0.047808690  -0.0229034305    0.055981476    0.72853318       0.8094199
74   0.021532074   0.0000000000    0.000000000    1.06502858       1.1932588
75   0.147381550  -0.0106093598    0.000000000    0.98940940       1.1261816
76   0.100709675  -0.0025569721    0.000000000    0.96398177       1.0621345
77   0.103048068  -0.0900381779    0.034161470    0.88920956       0.9806465
78   0.138403085  -0.1361218754    0.027447941    0.79105726       0.8796515
79   0.149880681  -0.0891737725    0.009915420    0.76036892       0.8857243
80   0.187984472  -0.1306052695    0.000000000    1.55177268       1.6498119
81   0.233505894  -0.0116185847    0.000000000    1.03358519       1.3038879
82   0.000000000   0.4520957849    0.000000000    0.99390410       1.4459999
83   0.347302244  -0.0559092490    0.000000000    1.63762505       2.2013606
84   0.089395559  -0.0603957958    0.000000000    1.08130031       1.1583515
85   0.055320836  -0.0218010111    0.000000000    0.97139525       1.0375983
86   0.243400369  -0.0554456229    0.000000000    1.18163904       1.3998279
87   0.188491494  -0.0341037855    0.000000000    0.90719875       1.1302711
88   0.134280699  -0.0441801028    0.000000000    1.15299396       1.2891876
89   0.066814894  -0.0375692301    0.000000000    0.98348505       1.0334274
90   0.000000000   0.0000000000    0.000000000    1.46810748       1.9929754
91   0.216144518  -0.0458118616    0.000000000    1.31993191       1.5180667
92   0.159642083  -0.0040220568    0.000000000    1.64401260       1.8056476
93   0.193937066  -0.0042020252    0.000000000    2.38888247       2.5851736
94   0.078342692  -0.0084147900    0.000000000    1.05781380       1.1394256
95  -0.050405568   0.0263010878    0.000000000    1.29906693       1.2751583
96   0.103417058  -0.0056524778    0.000000000    0.93769479       1.1017969
97   0.041711295  -0.0004832786    0.000000000    1.23150437       1.2898137
98   0.024950349  -0.0115239683    0.000000000    1.07769763       1.0968020
99   0.021441523  -0.0129326921    0.000000000    1.37545975       1.3867913
100  0.042694073   0.0000000000    0.000000000    0.96794292       1.0363170
101  0.081405500  -0.0671846930    0.000000000    1.33712922       1.3709420
102  0.160534876  -0.0115817624    0.000000000    0.99090826       1.2041820
103  0.116189830  -0.0346288606    0.000000000    1.07023951       1.2323440
104  0.398259365  -0.2083035597    0.000000000    1.35634656       1.8237879
105  0.145277405  -0.0458345185    0.000000000    1.04030430       1.1676412
106  0.093431309  -0.0393049347    0.000000000    1.09558933       1.1654638
107  0.056364670  -0.0315634732    0.088200051    0.93612066       1.0526647
108  0.062874180  -0.0228763650    0.079131919    0.97837446       1.1077336
109  0.085469076  -0.0366902394    0.065303870    0.95738035       1.0919740
110  0.081730298   0.0000000000    0.001485262    0.92375575       1.0302215
111  0.132674155  -0.0394176495    0.000000000    1.00333242       1.1237320
112  0.033062103  -0.0053357852    0.000000000    0.99004996       1.0276113
113  0.129928283  -0.0783082269    0.027819520    1.01306307       1.1043726
114  0.182006831  -0.1422626605    0.000000000    1.19951011       1.2736143
115  0.174640656  -0.0753612293    0.000000000    0.99973661       1.1537043
116  0.246035305  -0.1900279065    0.000000000    1.28762943       1.4095162
117  0.133373439  -0.0303284455    0.000000000    0.99427635       1.1427866
118  0.049397538  -0.0521892730    0.000000000    1.53547866       1.5525115
119  0.045580418  -0.0131448866    0.000000000    1.00702250       1.0674177
120  0.046465967  -0.0221385594    0.000000000    1.04470643       1.0950398
121  0.037802608  -0.0076329839    0.000000000    1.03810595       1.0939895
122  0.077803282   0.0151411879    0.033492190    0.77981970       0.9062564
123  0.048914579  -0.0479469232    0.000000000    1.02118681       1.0297587
124  0.060277766  -0.0374740811    0.000000000    1.02444495       1.0603807
125  0.027702498  -0.0356235844    0.000000000    1.04131772       1.0350268
126  0.069435668  -0.1074434325    0.000000000    1.06348659       1.0330665
127  0.072912503  -0.0413367556    0.000000000    0.95461777       1.0043168
128  0.065045227  -0.0760000402    0.000000000    1.05215703       1.0492697
129  0.041326378  -0.0446972680    0.000000000    1.02732336       1.0328395
130  0.082734252  -0.0323253017    0.000000000    0.92982555       1.0012015
131  0.060792920  -0.0730936790    0.000000000    1.05089750       1.0448704
132  0.007812569   0.0065570299    0.000000000    1.04814420       1.0923178
133  0.006903851   0.0000000000    0.047241141    1.13489686       1.2407214
134  0.036100179   0.0000000000    0.000000000    1.00626386       1.0468022
       Buffmx MatRep      LHPC.1       LHPC.2      ClimPC.1    ClimPC.2
1   1.0205700      5  4.05552254 -0.696663102  3.3882768319  0.49804850
2   1.0084916      5 -2.96241998 -0.129954659 -0.2612498958  2.44691133
3   1.1488676      5 -3.59768115  0.739745017  0.1603933441  2.66836759
4   1.1131551      6  1.60253930 -0.610977250  0.1603933441  2.66836759
5   1.0170366      5  1.07509621 -0.896281636 -0.5167914941  0.41581270
6   1.0021638      3  1.97902479 -0.569041959 -0.6578174921  0.23769963
7   1.0016533      3 -1.07902225 -0.891892347 -1.9770167841 -0.29011295
8   1.0365248      4 -0.50409553 -0.232676243 -2.2290941788 -0.91908833
9   1.1473994      9 -2.19358958  0.004938690  0.3348892538  3.40241087
10  1.1819587     11 -2.64253822  0.478711460  0.3348892538  3.40241087
11  1.0975750      3  3.82639825 -0.770342398  0.8190551764  1.00520023
12  1.0013446      3  3.89629428 -0.743585228  0.7290900834 -0.23588262
13  1.0022744      4 -0.65872765 -0.244696963 -0.2610845348  0.36555424
14  1.0004237      4  1.32464828  0.537854879  0.1901416531 -0.28772696
15  1.1469247     53 -1.42492399 -0.649069599 -1.7561907820  0.04956925
16  1.0117730      4  0.56077336  0.164523234  1.8598982808 -0.06178840
17  1.0988250      7 -0.96962137 -0.340730299  0.4375307731  2.67206519
18  1.0172371      3  1.09629297  0.389760264 -0.7730831616  0.34794691
19  0.9975678      4 -0.55655519 -0.813525720  1.4472669041 -1.00114517
20  1.0013987      4 -1.06729001 -0.261477978  1.2858271979 -0.89654864
21  1.0010531      4  2.37514805 -1.099652568  1.0944563796 -1.24164970
22  0.9976748      4  2.34539416 -1.157483245  1.1425652992 -1.16795116
23  1.0062788      4  0.21879672 -0.185191173  1.1212553499 -1.13208352
24  1.1022898      5  0.33967682 -0.204267535  1.6907544333  1.99312203
25  1.0064223      6  0.58654442  1.552895288  0.4760451051 -0.32094170
26  1.0045646      3  2.68610180 -1.508329446  0.1855146450  0.65577927
27  1.0902586      4  2.13295782  0.859818742 -0.1224602535  0.86297646
28  1.0103733      4  1.31952961 -1.035990880  0.9097750097 -2.39020122
29  1.0579087      5 -0.38478405 -0.092261418 -0.2316797050  0.95835523
30  1.0110815      6  1.50838482  0.269527637 -0.2223902021  0.89572714
31  1.9381641     17  0.62209109 -0.432490111  0.8774241269 -1.13693440
32  0.9954316      5  1.00434501  0.295205182 -2.3926197845 -0.18185305
33  1.0169975      4  1.35067955 -0.954406230  2.0755021947  0.95538347
34  1.0414770      3 -0.12053648  0.342208089  1.1086906247 -0.46406791
35  1.0671800      3  0.65426452  1.301049021  1.2417517508  0.82778456
36  1.0141861      3  2.13426916 -0.807632593  1.2283556324 -0.35890996
37  1.1081790      3  1.89249324  0.989150312  1.0126619397  0.12345998
38  1.3555067      3 -0.26206038  0.259625422  1.0181982496 -0.44286222
39  1.2751194      3  1.64771068  0.290618241  1.1150215913 -0.48773093
40  1.1199191     26 -4.62204819  0.597566619  2.4257757354  2.21229460
41  1.0095946      5 -2.83595721  2.971082188  0.0645731944  0.94284066
42  1.0948962      3 -0.34423198  1.409778546 -0.4073604547  0.58685928
43  1.0029059      5 -0.18148396 -0.020375412  0.1418401072  0.56464639
44  1.0013082      5  0.11793730 -0.034542972 -0.0134516680  0.61697753
45  1.0016803     12  2.30548757  2.560948144 -0.2355186453  1.72796797
46  1.0881019      6  1.72460210  0.590967280  0.7395830604 -0.26063871
47  1.1898041      3 -0.07774510 -0.316277460 -0.6879615697  2.10077564
48  1.0598832      3 -0.43331618 -0.390104238 -0.6894463627 -0.46803216
49  1.1273793      3 -0.07259981 -0.497804902  0.7626892441 -1.02418802
50  1.0064561      3  1.38217819 -0.087009229  0.9505472946  0.25373062
51  1.0011119      3  0.28268740  0.199731108  0.9529629675  0.36575851
52  1.0017544      3  1.79724754  1.340636343  0.5968969616  0.46873583
53  1.0100856      6  0.02348962  0.089457485  0.8265089105  0.29215625
54  1.0617870      3  2.04385585  0.943217705  0.7395830604 -0.26063871
55  1.0819747      3 -4.13027561  1.133271320  0.7619565639 -0.18606683
56  1.0520314      3 -1.07358046  0.040761906  0.4863720564 -0.20995834
57  1.1249988     30  0.41477648  0.299127306  2.2871049397  2.41124712
58  0.9966785      5  0.18242622  0.276822341  0.5918071001  0.09849035
59  1.0017862      3 -1.33815439 -1.158104197  0.2767905277 -0.64299861
60  1.1427458     14 -2.29821434 -0.517832263  2.4257757354  2.21229460
61  1.1040372      5  1.47004816  0.722283861  1.3884443409 -0.35922791
62  1.0111736      3  1.87801910  0.282782785  0.9097750097 -2.39020122
63  1.1766299     19 -4.23747569  0.323511508  2.4257757354  2.21229460
64  1.0224502      3  2.06180504 -0.950831472  1.0361104449 -0.49700718
65  1.0064660      3 -3.08938703  0.215411257  0.4014577875 -0.18865705
66  1.0222895      3  2.77729996 -0.744645144  0.4681051969 -0.21333330
67  1.1123591      3  1.21352791 -0.371621315  0.4667961789 -0.21919017
68  1.0699287      4 -0.10507296 -0.826523034  0.9451028628 -0.59948045
69  1.0202616      4 -0.23147707 -0.638967301  1.6114594226 -0.04575505
70  1.1238899     25  0.82647843 -1.007634897  2.2871049397  2.41124712
71  1.0203434      4  0.87005479  0.671516129 -0.4681933238  0.06649261
72  1.0022460      4  1.60244842 -0.868181765  0.4014577875 -0.18865705
73  1.0170315      4  0.44521397 -0.640920856  0.4681051969 -0.21333330
74  1.0006248      3  0.44057252 -0.616964686 -0.1397928929  0.53624725
75  1.0144133      3  0.87544995 -0.307634285  1.0769134011 -0.69736036
76  1.0081205      3  1.28762421 -0.894993575  1.5329901236 -1.12182273
77  1.0137131      4 -4.23747569  0.323511508  0.4302852079 -0.24179492
78  1.0124443      3 -4.96112780  0.549810577  0.4681051969 -0.21333330
79  0.9987339      4 -4.62629978  0.596240214  0.4014577875 -0.18865705
80  1.0643938     15  0.16203807  0.012146991  1.8156994500  0.02731675
81  1.0282270      3 -0.45828842 -0.257370385 -2.2039661972 -0.43245497
82  1.2549325      5 -1.48937190 -0.851180889  0.7395830604 -0.26063871
83  1.0963114      3  0.42060089  0.846082394  1.3902869769 -0.07324338
84  1.0528927     12  1.41128425 -0.625449275  0.3891227737 -0.17737344
85  1.0043468      5  0.81871825 -0.579572921  0.3475026740 -0.77983148
86  1.2005358     10  1.50162477 -0.738864602 -0.2549818707 -0.92466195
87  1.0136580     14  0.41502047 -0.532623775 -0.0002088708 -0.78039694
88  1.0062161     24  2.06022126 -0.954533847 -0.7425642082 -1.34483703
89  1.0001203      4 -4.34768652  0.310739550  0.9599472516 -0.87928286
90  1.1200143     25  0.47294500 -0.498375939  2.2871049397  2.41124712
91  1.1415555      3 -2.09548698 -0.294589929 -0.6145513071  2.70427584
92  0.9857018      3 -0.32716913 -0.179802414 -1.3738783145  0.37527046
93  1.0363167      3  0.11606091  0.961718360 -1.3738783145  0.37527046
94  1.0037322      3  2.55366921 -0.374189229 -1.3738783145  0.37527046
95  1.0026622      5  0.36538940 -0.179072345 -1.5952953930  1.02210963
96  1.0040824      5  0.46331537  0.137758712 -1.6917671379  0.86555414
97  0.9991667      3  0.88092508  2.144336179 -1.6309258120  0.38437375
98  1.0040889      4 -0.29625503 -0.235721588 -0.3717725042  2.78160961
99  1.0142548      3  1.85338100  7.599812825 -0.3607361355  2.76380872
100 1.0052818      5  1.53069143 -0.833409703  0.7670786060  1.90505915
101 1.0143370      4 -1.45321573 -0.801290883 -0.6197935504 -0.30374064
102 1.0133921     24 -0.03599821  0.248647534  0.0290749929  0.21792912
103 1.0016138      5  2.13134796  1.112210121 -0.0545412156  0.78337097
104 1.0575854      3 -0.14821863 -0.398410796  2.2676408997  0.01708203
105 1.0145514      6  1.00351444  0.118662360  1.8403665291  0.13846913
106 1.0111872      5  0.11746148 -0.201083931  1.8622642755  0.06927096
107 0.9997896      4 -1.28049486  1.324442705  0.3716436184  0.02078917
108 1.0031133      6 -0.22657292 -0.270479797  0.3770234619  0.06830037
109 1.0048691      6 -1.29266891 -0.727598290  0.4736846285  0.10346305
110 1.0040503      6  0.87637358  0.024204126 -3.6880681000 -1.75233219
111 1.0115493     14 -1.25296387 -0.305498084 -1.2433093245  1.12819762
112 1.0001780      4  0.93360200  0.039306015 -2.3197370835  0.27446076
113 1.0040632      5 -0.48113223 -0.267143995  0.9097750097 -2.39020122
114 1.0422046     11  1.11591045 -0.224008873 -1.0543613796  0.73770969
115 1.0713503      3 -3.11960903  0.615379811  0.2801875797  0.21788596
116 1.1658164      4  0.01026127  0.196708591 -0.7135975980  2.58121786
117 1.0132490      3 -1.06761350 -0.556191663 -1.8739491435 -0.45318379
118 1.0043283     16 -1.24316113 -0.737201942  0.7979207719 -0.33450502
119 1.0047770      7 -1.16028746  0.577307150  0.3430433599  1.61505992
120 1.0181906      7 -2.70732004  1.708784793  0.4949018701  2.25916732
121 1.0079742      5 -2.58371786 -0.382985166  0.7639910865  1.79538409
122 1.0117780      4 -1.29887476 -0.383840462  1.4732264132 -1.63849580
123 1.0014665      5 -0.11102808 -0.001042222  0.5057094428 -0.87317673
124 0.9991554      5 -0.11288327 -0.263697643  0.6055468241 -0.77949621
125 0.9996627      5 -0.34238159 -0.082509243  0.4970393113 -0.99556381
126 0.9974504      3 -0.16314967  0.243580718  0.5731929552 -0.84398631
127 1.0012208      5 -0.35598966  0.239821971  0.4951619353 -0.85904086
128 1.0036398      3 -0.03661108 -0.264173768  0.5134626127 -0.82758632
129 0.9997875      7 -0.28062667 -0.043255956  0.5082677717 -0.86911082
130 0.9995278      3 -0.28035214 -0.155445924  0.6076304668 -0.74343628
131 1.0010317      4 -0.21225711 -0.001855859  0.6734935916 -0.66963609
132 1.0061722     32  2.16602800 -0.257929140  2.0927212323 -0.52744279
133 1.0207404     14  0.63911719  0.437562271  2.8220623624 -1.68655232
134 0.9959259      9  2.05580076  0.097852476  0.5888131058 -1.28451621
       ClimPC.3             SpeciesAccepted  Kingdom        Phylum
1   -2.79206556             Ursus maritimus Animalia      Chordata
2    0.98342288              Falco naumanni Animalia      Chordata
3   -9.83423801             Lagopus leucura Animalia      Chordata
4   -9.83423801                Lagopus muta Animalia      Chordata
5   -0.17896246        Sceloporus grammicus Animalia      Chordata
6   -0.14995031        Xenosaurus platyceps Animalia      Chordata
7    0.15402991        Xenosaurus platyceps Animalia      Chordata
8    0.24238609          Xenosaurus grandis Animalia      Chordata
9    1.28751588          Clinocottus analis Animalia      Chordata
10   1.28751588          Clinocottus analis Animalia      Chordata
11  -0.71832752            Colias alexandra Animalia    Arthropoda
12  -0.46418968          Scolytus ventralis Animalia    Arthropoda
13  -0.08638376         Paramuricea clavata Animalia      Cnidaria
14  -0.32364884      Euphorbia fontqueriana  Plantae Magnoliophyta
15   0.52991276        Hypericum cumulicola  Plantae Magnoliophyta
16   0.11224260         Agrimonia eupatoria  Plantae Magnoliophyta
17   0.96562898          Purshia subintegra  Plantae Magnoliophyta
18   0.40958101              Cucurbita pepo  Plantae Magnoliophyta
19   0.36312670            Castanea dentata  Plantae  Tracheophyta
20   0.03574476            Castanea dentata  Plantae  Tracheophyta
21   0.01949560            Castanea dentata  Plantae  Tracheophyta
22   0.00961047            Castanea dentata  Plantae  Tracheophyta
23   0.10430753            Castanea dentata  Plantae  Tracheophyta
24  -0.88785777       Astragalus scaphoides  Plantae Magnoliophyta
25  -0.12789129       Astragalus alopecurus  Plantae Magnoliophyta
26  -0.28465691     Astragalus tremolsianus  Plantae Magnoliophyta
27  -0.17848110        Dorycnium spectabile  Plantae Magnoliophyta
28   0.62282181        Anthyllis vulneraria  Plantae Magnoliophyta
29   0.21723754         Lupinus tidestromii  Plantae Magnoliophyta
30   0.17701314         Lupinus tidestromii  Plantae Magnoliophyta
31   1.62120290             Lupinus lepidus  Plantae Magnoliophyta
32   0.59888797           Carapa guianensis  Plantae Magnoliophyta
33   1.32691290              Acer saccharum  Plantae Magnoliophyta
34  -0.20821291          Alliaria petiolata  Plantae Magnoliophyta
35   0.44571374          Alliaria petiolata  Plantae Magnoliophyta
36  -0.32905057          Alliaria petiolata  Plantae Magnoliophyta
37   0.06007740          Alliaria petiolata  Plantae Magnoliophyta
38  -0.33302275          Alliaria petiolata  Plantae Magnoliophyta
39  -0.43707692          Alliaria petiolata  Plantae Magnoliophyta
40   1.20748053        Sphaeralcea coccinea  Plantae Magnoliophyta
41   0.03310394   Helianthemum polygonoides  Plantae Magnoliophyta
42  -0.39610567     Helianthemum teneriffae  Plantae Magnoliophyta
43  -0.07098295          Erodium paularense  Plantae Magnoliophyta
44  -0.02090477          Erodium paularense  Plantae Magnoliophyta
45   0.55070377         Oenothera deltoides  Plantae Magnoliophyta
46  -0.59497021     Saxifraga tridactylites  Plantae Magnoliophyta
47   1.02619889          Plantago coronopus  Plantae Magnoliophyta
48   0.07901195          Plantago coronopus  Plantae Magnoliophyta
49  -0.31691032          Plantago coronopus  Plantae Magnoliophyta
50  -0.36804073    Dracocephalum austriacum  Plantae Magnoliophyta
51  -0.36555976    Dracocephalum austriacum  Plantae Magnoliophyta
52   0.40369338              Ramonda myconi  Plantae Magnoliophyta
53   0.53507414              Ramonda myconi  Plantae Magnoliophyta
54  -0.59497021        Myosotis ramosissima  Plantae Magnoliophyta
55  -0.02771252       Gentiana pneumonanthe  Plantae Magnoliophyta
56  -0.37533525        Hypochaeris radicata  Plantae Magnoliophyta
57   1.25690733      Echinacea angustifolia  Plantae Magnoliophyta
58  -0.05782457      Echinacea angustifolia  Plantae Magnoliophyta
59  -0.31952387      Echinacea angustifolia  Plantae Magnoliophyta
60   1.20748053        Ratibida columnifera  Plantae Magnoliophyta
61  -0.01312157            Liatris scariosa  Plantae Magnoliophyta
62   0.62282181            Artemisia genipi  Plantae Magnoliophyta
63   1.20748053             Solidago mollis  Plantae Magnoliophyta
64  -0.78333529            Cirsium palustre  Plantae Magnoliophyta
65  -0.38653722           Cirsium dissectum  Plantae Magnoliophyta
66  -0.37798458           Cirsium dissectum  Plantae Magnoliophyta
67  -0.31861025           Cirsium dissectum  Plantae Magnoliophyta
68   0.12070552            Cirsium pitcheri  Plantae Magnoliophyta
69   0.12318110            Cirsium pitcheri  Plantae Magnoliophyta
70   1.25690733           Cirsium undulatum  Plantae Magnoliophyta
71  -0.21288706           Jurinea fontqueri  Plantae Magnoliophyta
72  -0.38653722             Centaurea jacea  Plantae Magnoliophyta
73  -0.37798458             Centaurea jacea  Plantae Magnoliophyta
74  -0.42230483    Cheirolophus metlesicsii  Plantae Magnoliophyta
75  -1.47238536                 Carum carvi  Plantae Magnoliophyta
76  -0.83812394                 Carum carvi  Plantae Magnoliophyta
77  -0.36925265           Succisa pratensis  Plantae Magnoliophyta
78  -0.37798458           Succisa pratensis  Plantae Magnoliophyta
79  -0.38653722           Succisa pratensis  Plantae Magnoliophyta
80  -0.03538656           Succisa pratensis  Plantae Magnoliophyta
81   0.32090193      Ardisia escallonioides  Plantae Magnoliophyta
82  -0.59497021          Androsace elongata  Plantae Magnoliophyta
83  -0.37001193            Primula farinosa  Plantae  Tracheophyta
84  -0.29741967               Primula veris  Plantae Magnoliophyta
85  -0.34411841             Primula elatior  Plantae Magnoliophyta
86  -0.86292672            Primula vulgaris  Plantae Magnoliophyta
87  -0.78443947            Primula vulgaris  Plantae Magnoliophyta
88  -0.11362628            Primula vulgaris  Plantae Magnoliophyta
89  -0.56193794         Sarracenia purpurea  Plantae Magnoliophyta
90   1.25690733          Paronychia jamesii  Plantae Magnoliophyta
91   0.86974688          Atriplex canescens  Plantae  Tracheophyta
92  -0.30163189   Neobuxbaumia mezcalaensis  Plantae Magnoliophyta
93  -0.30163189   Neobuxbaumia mezcalaensis  Plantae Magnoliophyta
94  -0.30163189   Neobuxbaumia macrocephala  Plantae Magnoliophyta
95   0.21559050 Mammillaria huitzilopochtli  Plantae Magnoliophyta
96   0.20846126 Mammillaria huitzilopochtli  Plantae Magnoliophyta
97  -0.24287384     Mammillaria solisioides  Plantae Magnoliophyta
98   0.95716696       Ariocarpus fissuratus  Plantae Magnoliophyta
99   0.94874098       Ariocarpus fissuratus  Plantae Magnoliophyta
100  0.98725395       Escobaria robbinsorum  Plantae Magnoliophyta
101  0.21859866             Rumex rupestris  Plantae Magnoliophyta
102  0.04057466          Armeria caespitosa  Plantae Magnoliophyta
103 -0.02332064            Limonium erectum  Plantae Magnoliophyta
104  0.32163290         Ranunculus peltatus  Plantae Magnoliophyta
105  0.03820071              Actaea spicata  Plantae Magnoliophyta
106  0.06856271              Actaea spicata  Plantae Magnoliophyta
107  0.04085176         Dicentra canadensis  Plantae  Tracheophyta
108  0.02851837         Dicentra canadensis  Plantae  Tracheophyta
109 -0.09195498         Dicentra canadensis  Plantae  Tracheophyta
110  2.02884510         Chamaedorea elegans  Plantae Magnoliophyta
111  0.74686358       Chamaedorea radicalis  Plantae Magnoliophyta
112  0.25868305          Borassus aethiopum  Plantae Magnoliophyta
113  0.62282181                  Poa alpina  Plantae Magnoliophyta
114  0.79148913           Zea diploperennis  Plantae Magnoliophyta
115  0.18110723           Danthonia sericea  Plantae Magnoliophyta
116  0.76691034              Hilaria mutica  Plantae Magnoliophyta
117 -0.14444214           Catopsis compacta  Plantae Magnoliophyta
118 -0.03864572             Orchis purpurea  Plantae Magnoliophyta
119  0.91408058    Cypripedium fasciculatum  Plantae Magnoliophyta
120  0.83829973    Cypripedium fasciculatum  Plantae Magnoliophyta
121  0.65950726    Cypripedium fasciculatum  Plantae Magnoliophyta
122  0.55521569            Allium tricoccum  Plantae Magnoliophyta
123 -0.25452323       Trillium grandiflorum  Plantae Magnoliophyta
124 -0.35605880       Trillium grandiflorum  Plantae Magnoliophyta
125 -0.25529127       Trillium grandiflorum  Plantae Magnoliophyta
126 -0.31908468       Trillium grandiflorum  Plantae Magnoliophyta
127 -0.27161723       Trillium grandiflorum  Plantae Magnoliophyta
128 -0.33631872       Trillium grandiflorum  Plantae Magnoliophyta
129 -0.28504364       Trillium grandiflorum  Plantae Magnoliophyta
130 -0.35436699       Trillium grandiflorum  Plantae Magnoliophyta
131 -0.40946570       Trillium grandiflorum  Plantae Magnoliophyta
132  1.62879830         Calochortus lyallii  Plantae Magnoliophyta
133  1.66817327            Asarum canadense  Plantae Magnoliophyta
134  0.11992176               Pinus strobus  Plantae     Pinophyta
             Class           Order         OrganismType AngioGymno    lambda
1         Mammalia       Carnivora             Mammalia       &lt;NA&gt; 1.0590883
2             Aves   Falconiformes                 Aves       &lt;NA&gt; 1.3078824
3             Aves     Galliformes                 Aves       &lt;NA&gt; 1.7937087
4             Aves     Galliformes                 Aves       &lt;NA&gt; 1.1555296
5         Reptilia        Squamata             Reptilia       &lt;NA&gt; 1.0604761
6         Reptilia        Squamata             Reptilia       &lt;NA&gt; 1.1419108
7         Reptilia        Squamata             Reptilia       &lt;NA&gt; 1.0466930
8         Reptilia        Squamata             Reptilia       &lt;NA&gt; 1.2940579
9   Actinopterygii Scorpaeniformes       Actinopterygii       &lt;NA&gt; 1.0807503
10  Actinopterygii Scorpaeniformes       Actinopterygii       &lt;NA&gt; 0.6312393
11         Insecta     Lepidoptera              Insecta       &lt;NA&gt; 1.1707720
12         Insecta      Coleoptera              Insecta       &lt;NA&gt; 1.2386318
13        Anthozoa      Alcyonacea             Anthozoa       &lt;NA&gt; 0.8728669
14   Magnoliopsida    Malpighiales            Succulent Angiosperm 0.9779625
15   Magnoliopsida         Theales Herbaceous perennial Angiosperm 1.0243679
16   Magnoliopsida         Rosales Herbaceous perennial Angiosperm 0.9283973
17   Magnoliopsida         Rosales                Shrub Angiosperm 0.9751571
18   Magnoliopsida   Curcurbitales               Annual Angiosperm 1.2408827
19   Magnoliopsida         Fagales                 Tree Angiosperm 1.0088920
20   Magnoliopsida         Fagales                 Tree Angiosperm 1.0067955
21   Magnoliopsida         Fagales                 Tree Angiosperm 0.9940440
22   Magnoliopsida         Fagales                 Tree Angiosperm 0.9934334
23   Magnoliopsida         Fagales                 Tree Angiosperm 0.9818987
24   Magnoliopsida         Fabales Herbaceous perennial Angiosperm 1.5999061
25   Magnoliopsida         Fabales Herbaceous perennial Angiosperm 1.5506323
26   Magnoliopsida         Fabales Herbaceous perennial Angiosperm 1.0965123
27   Magnoliopsida         Fabales Herbaceous perennial Angiosperm 1.9158723
28   Magnoliopsida         Fabales Herbaceous perennial Angiosperm 1.0510285
29   Magnoliopsida         Fabales Herbaceous perennial Angiosperm 1.0111035
30   Magnoliopsida         Fabales Herbaceous perennial Angiosperm 0.9262035
31   Magnoliopsida         Fabales Herbaceous perennial Angiosperm 0.9799277
32   Magnoliopsida      Sapindales                 Tree Angiosperm 0.9956000
33   Magnoliopsida      Sapindales                 Tree Angiosperm 0.9644052
34   Magnoliopsida     Brassicales Herbaceous perennial Angiosperm 1.0239866
35   Magnoliopsida     Brassicales Herbaceous perennial Angiosperm 1.4037297
36   Magnoliopsida     Brassicales Herbaceous perennial Angiosperm 0.7869247
37   Magnoliopsida     Brassicales Herbaceous perennial Angiosperm 1.0359177
38   Magnoliopsida     Brassicales Herbaceous perennial Angiosperm 0.9716492
39   Magnoliopsida     Brassicales Herbaceous perennial Angiosperm 1.3648033
40   Magnoliopsida        Malvales Herbaceous perennial Angiosperm 0.7611410
41   Magnoliopsida        Malvales Herbaceous perennial Angiosperm 0.9308673
42   Magnoliopsida        Malvales Herbaceous perennial Angiosperm 1.5407796
43   Magnoliopsida      Geraniales Herbaceous perennial Angiosperm 0.9575419
44   Magnoliopsida      Geraniales Herbaceous perennial Angiosperm 1.0879999
45   Magnoliopsida        Myrtales Herbaceous perennial Angiosperm 0.8553326
46   Magnoliopsida    Saxifragales               Annual Angiosperm 1.8316693
47   Magnoliopsida        Lamiales Herbaceous perennial Angiosperm 0.5322755
48   Magnoliopsida        Lamiales Herbaceous perennial Angiosperm 1.1257721
49   Magnoliopsida        Lamiales Herbaceous perennial Angiosperm 1.7314892
50   Magnoliopsida        Lamiales Herbaceous perennial Angiosperm 0.9656341
51   Magnoliopsida        Lamiales Herbaceous perennial Angiosperm 0.9791057
52   Magnoliopsida        Lamiales Herbaceous perennial Angiosperm 1.0326716
53   Magnoliopsida        Lamiales Herbaceous perennial Angiosperm 0.9677607
54   Magnoliopsida        Lamiales               Annual Angiosperm 1.6732773
55   Magnoliopsida     Gentianales Herbaceous perennial Angiosperm 1.1326931
56   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.1230529
57   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 0.6215339
58   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 0.9919496
59   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.0365163
60   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.1283010
61   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.3243933
62   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.1443488
63   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.8015241
64   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.2362850
65   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.0875591
66   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.0558414
67   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.4936542
68   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 0.9146098
69   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.0535111
70   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 1.1119058
71   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 0.6170490
72   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 0.7721355
73   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 0.8874202
74   Magnoliopsida       Asterales Herbaceous perennial Angiosperm 0.9634498
75   Magnoliopsida         Apiales Herbaceous perennial Angiosperm 0.7839479
76   Magnoliopsida         Apiales Herbaceous perennial Angiosperm 0.9832736
77   Magnoliopsida      Dipsacales Herbaceous perennial Angiosperm 1.2656266
78   Magnoliopsida      Dipsacales Herbaceous perennial Angiosperm 1.4304409
79   Magnoliopsida      Dipsacales Herbaceous perennial Angiosperm 1.2955549
80   Magnoliopsida      Dipsacales Herbaceous perennial Angiosperm 0.7613167
81   Magnoliopsida        Ericales                Shrub Angiosperm 1.3372438
82   Magnoliopsida        Ericales               Annual Angiosperm 0.6744272
83   Magnoliopsida        Ericales Herbaceous perennial Angiosperm 1.1426327
84   Magnoliopsida        Ericales Herbaceous perennial Angiosperm 0.8550317
85   Magnoliopsida        Ericales Herbaceous perennial Angiosperm 1.0551724
86   Magnoliopsida        Ericales Herbaceous perennial Angiosperm 0.8672650
87   Magnoliopsida        Ericales Herbaceous perennial Angiosperm 0.9802187
88   Magnoliopsida        Ericales Herbaceous perennial Angiosperm 0.8083969
89   Magnoliopsida        Ericales Herbaceous perennial Angiosperm 1.0164304
90   Magnoliopsida  Caryophyllales Herbaceous perennial Angiosperm 0.6241799
91   Magnoliopsida  Caryophyllales                Shrub Angiosperm 1.7211020
92   Magnoliopsida  Caryophyllales            Succulent Angiosperm 1.0001012
93   Magnoliopsida  Caryophyllales            Succulent Angiosperm 1.0001012
94   Magnoliopsida  Caryophyllales            Succulent Angiosperm 1.0448792
95   Magnoliopsida  Caryophyllales            Succulent Angiosperm 0.8096500
96   Magnoliopsida  Caryophyllales            Succulent Angiosperm 1.2437146
97   Magnoliopsida  Caryophyllales            Succulent Angiosperm 0.7717743
98   Magnoliopsida  Caryophyllales            Succulent Angiosperm 0.8536424
99   Magnoliopsida  Caryophyllales            Succulent Angiosperm 0.9123507
100  Magnoliopsida  Caryophyllales            Succulent Angiosperm 1.0675543
101  Magnoliopsida  Caryophyllales Herbaceous perennial Angiosperm 0.6939522
102  Magnoliopsida  Caryophyllales Herbaceous perennial Angiosperm 1.1056787
103  Magnoliopsida  Caryophyllales Herbaceous perennial Angiosperm 0.8622434
104  Magnoliopsida    Ranunculales Herbaceous perennial Angiosperm 0.6678511
105  Magnoliopsida    Ranunculales Herbaceous perennial Angiosperm 1.0111375
106  Magnoliopsida    Ranunculales Herbaceous perennial Angiosperm 0.9799315
107  Magnoliopsida    Ranunculales Herbaceous perennial Angiosperm 1.0953694
108  Magnoliopsida    Ranunculales Herbaceous perennial Angiosperm 1.0512885
109  Magnoliopsida    Ranunculales Herbaceous perennial Angiosperm 1.1280523
110     Liliopsida        Arecales                 Palm Angiosperm 1.1669544
111     Liliopsida        Arecales                 Palm Angiosperm 1.1789035
112     Liliopsida        Arecales                 Palm Angiosperm 1.0295980
113     Liliopsida          Poales Herbaceous perennial Angiosperm 0.9987145
114     Liliopsida          Poales Herbaceous perennial Angiosperm 0.5545652
115     Liliopsida          Poales Herbaceous perennial Angiosperm 1.0100578
116     Liliopsida          Poales Herbaceous perennial Angiosperm 1.7385142
117     Liliopsida          Poales             Epiphyte Angiosperm 1.0615691
118     Liliopsida     Asparagales Herbaceous perennial Angiosperm 0.9831117
119     Liliopsida     Asparagales Herbaceous perennial Angiosperm 1.0643108
120     Liliopsida     Asparagales Herbaceous perennial Angiosperm 1.0191296
121     Liliopsida     Asparagales Herbaceous perennial Angiosperm 1.0732602
122     Liliopsida     Asparagales Herbaceous perennial Angiosperm 1.1331204
123     Liliopsida        Liliales Herbaceous perennial Angiosperm 1.0406040
124     Liliopsida        Liliales Herbaceous perennial Angiosperm 1.0022867
125     Liliopsida        Liliales Herbaceous perennial Angiosperm 0.9735535
126     Liliopsida        Liliales Herbaceous perennial Angiosperm 0.9536967
127     Liliopsida        Liliales Herbaceous perennial Angiosperm 1.0089756
128     Liliopsida        Liliales Herbaceous perennial Angiosperm 0.9905149
129     Liliopsida        Liliales Herbaceous perennial Angiosperm 0.9847658
130     Liliopsida        Liliales Herbaceous perennial Angiosperm 1.0981481
131     Liliopsida        Liliales Herbaceous perennial Angiosperm 0.9909749
132     Liliopsida        Liliales Herbaceous perennial Angiosperm 1.0226717
133  Magnoliopsida       Piperales Herbaceous perennial Angiosperm 1.0447722
134      Pinopsida         Pinales                 Tree Gymnosperm 1.0184607
    Ecoregion                    Binomial                       phylo
1         POE             Ursus_maritimus             Ursus_maritimus
2         MED              Falco_naumanni              Falco_naumanni
3         TUN             Lagopus_leucura             Lagopus_leucura
4         TUN                Lagopus_muta                Lagopus_muta
5         TSC        Sceloporus_grammicus        Sceloporus_grammicus
6         TMB        Xenosaurus_platyceps        Xenosaurus_platyceps
7         TMB        Xenosaurus_platyceps        Xenosaurus_platyceps
8         TMB          Xenosaurus_grandis          Xenosaurus_grandis
9         TRU          Clinocottus_analis          Clinocottus_analis
10        TRU          Clinocottus_analis          Clinocottus_analis
11        TGS            Colias_alexandra            Colias_alexandra
12        TCF          Scolytus_ventralis          Scolytus_ventralis
13        TSS         Paramuricea_clavata         Paramuricea_clavata
14        MED      Euphorbia_fontqueriana      Euphorbia_fontqueriana
15        TCF        Hypericum_cumulicola        Hypericum_cumulicola
16        FGS         Agrimonia_eupatoria         Agrimonia_eupatoria
17        DES          Purshia_subintegra          Purshia_subintegra
18        TBM              Cucurbita_pepo              Cucurbita_pepo
19        TBM            Castanea_dentata            Castanea_dentata
20        TBM            Castanea_dentata            Castanea_dentata
21        TBM            Castanea_dentata            Castanea_dentata
22        TBM            Castanea_dentata            Castanea_dentata
23        TBM            Castanea_dentata            Castanea_dentata
24        DES       Astragalus_scaphoides       Astragalus_scaphoides
25        TBM       Astragalus_alopecurus       Astragalus_alopecurus
26        MED     Astragalus_tremolsianus     Astragalus_tremolsianus
27        MED        Dorycnium_spectabile        Dorycnium_spectabile
28        TBM        Anthyllis_vulneraria        Anthyllis_vulneraria
29        DES         Lupinus_tidestromii         Lupinus_tidestromii
30        DES         Lupinus_tidestromii         Lupinus_tidestromii
31        TCF             Lupinus_lepidus             Lupinus_lepidus
32        TMB           Carapa_guianensis           Carapa_guianensis
33        TBM              Acer_saccharum              Acer_saccharum
34        TBM          Alliaria_petiolata          Alliaria_petiolata
35        TBM          Alliaria_petiolata          Alliaria_petiolata
36        TBM          Alliaria_petiolata          Alliaria_petiolata
37        TBM          Alliaria_petiolata          Alliaria_petiolata
38        TBM          Alliaria_petiolata          Alliaria_petiolata
39        TBM          Alliaria_petiolata          Alliaria_petiolata
40        TGS        Sphaeralcea_coccinea        Sphaeralcea_coccinea
41        MED   Helianthemum_polygonoides   Helianthemum_polygonoides
42        MED     Helianthemum_teneriffae     Helianthemum_teneriffae
43        MED          Erodium_paularense          Erodium_paularense
44        MED          Erodium_paularense          Erodium_paularense
45        DES         Oenothera_deltoides         Oenothera_deltoides
46        TBM     Saxifraga_tridactylites     Saxifraga_tridactylites
47        MED          Plantago_coronopus          Plantago_coronopus
48        TBM          Plantago_coronopus          Plantago_coronopus
49        TBM          Plantago_coronopus          Plantago_coronopus
50        TBM    Dracocephalum_austriacum    Dracocephalum_austriacum
51        TBM    Dracocephalum_austriacum    Dracocephalum_austriacum
52        MED              Ramonda_myconi              Ramonda_myconi
53        MED              Ramonda_myconi              Ramonda_myconi
54        TBM        Myosotis_ramosissima        Myosotis_ramosissima
55        TBM       Gentiana_pneumonanthe       Gentiana_pneumonanthe
56        TBM        Hypochaeris_radicata        Hypochaeris_radicata
57        TGS      Echinacea_angustifolia      Echinacea_angustifolia
58        TGS      Echinacea_angustifolia      Echinacea_angustifolia
59        TGS      Echinacea_angustifolia      Echinacea_angustifolia
60        TGS        Ratibida_columnifera        Ratibida_columnifera
61        TGS            Liatris_scariosa            Liatris_scariosa
62        TCF            Artemisia_genipi            Artemisia_genipi
63        TGS             Solidago_mollis             Solidago_mollis
64        FGS            Cirsium_palustre            Cirsium_palustre
65        TBM           Cirsium_dissectum           Cirsium_dissectum
66        TBM           Cirsium_dissectum           Cirsium_dissectum
67        TBM           Cirsium_dissectum           Cirsium_dissectum
68        TGS            Cirsium_pitcheri            Cirsium_pitcheri
69        TGS            Cirsium_pitcheri            Cirsium_pitcheri
70        TGS           Cirsium_undulatum           Cirsium_undulatum
71        MED           Jurinea_fontqueri           Jurinea_fontqueri
72        TBM             Centaurea_jacea             Centaurea_jacea
73        TBM             Centaurea_jacea             Centaurea_jacea
74        MED    Cheirolophus_metlesicsii    Cheirolophus_metlesicsii
75        TBM                 Carum_carvi                 Carum_carvi
76        TBM                 Carum_carvi                 Carum_carvi
77        TBM           Succisa_pratensis           Succisa_pratensis
78        TBM           Succisa_pratensis           Succisa_pratensis
79        TBM           Succisa_pratensis           Succisa_pratensis
80        TBM           Succisa_pratensis           Succisa_pratensis
81        TMB      Ardisia_escallonioides      Ardisia_escallonioides
82        TBM          Androsace_elongata          Androsace_elongata
83        TBM            Primula_farinosa            Primula_farinosa
84        TBM               Primula_veris               Primula_veris
85        TBM             Primula_elatior             Primula_elatior
86        TBM            Primula_vulgaris            Primula_vulgaris
87        TBM            Primula_vulgaris            Primula_vulgaris
88        TBM            Primula_vulgaris            Primula_vulgaris
89        BOR         Sarracenia_purpurea         Sarracenia_purpurea
90        TGS          Paronychia_jamesii          Paronychia_jamesii
91        DES          Atriplex_canescens          Atriplex_canescens
92        TSC   Neobuxbaumia_mezcalaensis   Neobuxbaumia_mezcalaensis
93        DES   Neobuxbaumia_mezcalaensis   Neobuxbaumia_mezcalaensis
94        DES   Neobuxbaumia_macrocephala   Neobuxbaumia_macrocephala
95        TGV Mammillaria_huitzilopochtli Mammillaria_huitzilopochtli
96        DES Mammillaria_huitzilopochtli Mammillaria_huitzilopochtli
97        DES     Mammillaria_solisioides     Mammillaria_solisioides
98        DES       Ariocarpus_fissuratus       Ariocarpus_fissuratus
99        DES       Ariocarpus_fissuratus       Ariocarpus_fissuratus
100       DES       Escobaria_robbinsorum       Escobaria_robbinsorum
101       TBM             Rumex_rupestris             Rumex_rupestris
102       MED          Armeria_caespitosa          Armeria_caespitosa
103       MED            Limonium_erectum            Limonium_erectum
104       TBM         Ranunculus_peltatus         Ranunculus_peltatus
105       TBM              Actaea_spicata              Actaea_spicata
106       TBM              Actaea_spicata              Actaea_spicata
107       TBM         Dicentra_canadensis         Dicentra_canadensis
108       TBM         Dicentra_canadensis         Dicentra_canadensis
109       TBM         Dicentra_canadensis         Dicentra_canadensis
110       TSC         Chamaedorea_elegans         Chamaedorea_elegans
111       MED       Chamaedorea_radicalis       Chamaedorea_radicalis
112       TGV          Borassus_aethiopum          Borassus_aethiopum
113       TCF                  Poa_alpina                  Poa_alpina
114       MON           Zea_diploperennis           Zea_diploperennis
115       TCF           Danthonia_sericea           Danthonia_sericea
116       DES              Hilaria_mutica              Hilaria_mutica
117       TSC           Catopsis_compacta           Catopsis_compacta
118       TBM             Orchis_purpurea             Orchis_purpurea
119       TCF    Cypripedium_fasciculatum    Cypripedium_fasciculatum
120       TCF    Cypripedium_fasciculatum    Cypripedium_fasciculatum
121       TCF    Cypripedium_fasciculatum    Cypripedium_fasciculatum
122       TBM            Allium_tricoccum            Allium_tricoccum
123       TBM       Trillium_grandiflorum       Trillium_grandiflorum
124       TBM       Trillium_grandiflorum       Trillium_grandiflorum
125       TBM       Trillium_grandiflorum       Trillium_grandiflorum
126       TBM       Trillium_grandiflorum       Trillium_grandiflorum
127       TBM       Trillium_grandiflorum       Trillium_grandiflorum
128       TBM       Trillium_grandiflorum       Trillium_grandiflorum
129       TBM       Trillium_grandiflorum       Trillium_grandiflorum
130       TBM       Trillium_grandiflorum       Trillium_grandiflorum
131       TBM       Trillium_grandiflorum       Trillium_grandiflorum
132       TGS         Calochortus_lyallii         Calochortus_lyallii
133       TBM            Asarum_canadense            Asarum_canadense
134       TBM               Pinus_strobus               Pinus_strobus</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Total populations</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Total pops"</span>); (final_data<span class="sc">%&gt;%</span><span class="fu">dim</span>())[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Total pops"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 134</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Total species</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Total species"</span>); final_data<span class="sc">$</span>SpeciesAccepted<span class="sc">%&gt;%</span><span class="fu">unique</span>()<span class="sc">%&gt;%</span><span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Total species"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 89</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Populations by kingdom</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">%&gt;%</span><span class="fu">select</span>(Kingdom)<span class="sc">%&gt;%</span><span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kingdom
Animalia  Plantae 
      13      121 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Species by kingdom</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">%&gt;%</span><span class="fu">select</span>(SpeciesAccepted,Kingdom)<span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>()<span class="sc">%&gt;%</span><span class="fu">select</span>(Kingdom)<span class="sc">%&gt;%</span><span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kingdom
Animalia  Plantae 
      11       78 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># USED MPMs</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Total MPMs"</span>);<span class="fu">filter</span>(Metadata, ID <span class="sc">%in%</span> final_data<span class="sc">$</span>ID)<span class="sc">$</span>mat<span class="sc">%&gt;%</span><span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Total MPMs"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 889</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Because animal population are scarce we keep the analyses for plants only.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="ot">&lt;-</span>final_data<span class="sc">%&gt;%</span><span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="prepare-phylogenetic-information-associated" class="level2">
<h2 class="anchored" data-anchor-id="prepare-phylogenetic-information-associated">8.1. Prepare phylogenetic information associated</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>PhyloSig_data<span class="ot">&lt;-</span>final_data<span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(Binomial,<span class="at">.keep_all=</span><span class="cn">TRUE</span>)<span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">column_to_rownames</span>(<span class="st">"Binomial"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="fu">where</span>(is.numeric),Kingdom)<span class="sc">%&gt;%</span> <span class="co"># Old "select(is.numeric,Kingdom)%&gt;%" but deprecated in recent versions of tidyverse</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Clonality_Base,Clonality_SigElas))</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>PhyloSig_data_PLANTS<span class="ot">&lt;-</span>PhyloSig_data<span class="sc">%&gt;%</span><span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>)<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span>Kingdom)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>subtree_Plants<span class="ot">&lt;-</span><span class="fu">keep.tip</span>(subtree, <span class="fu">rownames</span>(PhyloSig_data_PLANTS))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="glmm-parameters-data-imput" class="level1">
<h1>9. GLMM parameters &amp; data imput</h1>
<section id="a-separate-dataset-was-created-data_model" class="level2">
<h2 class="anchored" data-anchor-id="a-separate-dataset-was-created-data_model">9.1. A separate dataset was created <code>data_model</code></h2>
<p>Data_model now includes absolute values of sum of stochastic elasticity within respect to variance <span class="math inline">\(| \sum E_v^\sigma |\)</span> (i.e, cumulativa_SigEla).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>data_model<span class="ot">&lt;-</span>final_data<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Reproduction_Base<span class="sc">:</span>Cumulative_Base))<span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(Reproduction_SigElas<span class="sc">:</span>Cumulative_SigElas, abs)) <span class="co">#All calculations will be performed with the absolute values</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>data_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               ID Reproduction_SigElas Growth_SigElas Shrinking_SigElas
1    Ephr.267_629         3.746532e-04   7.572104e-04      3.269931e-05
2    Hypr.463_756         6.467530e-02   4.189061e-03      1.993659e-03
3     Agrm.300_46         2.274530e-05   2.648489e-03      5.880106e-05
4   Prsh.362_1204         3.710245e-05   6.848113e-03      7.212616e-04
5    Ccrb.457_472         2.780779e-01   4.533997e-04      0.000000e+00
6    Cstn.134_322         9.410967e-07   3.264915e-04      2.075794e-05
7    Cstn.134_326         1.011935e-07   7.387550e-04      2.398223e-05
8    Cstn.134_325         1.007925e-07   1.305185e-04      2.980198e-05
9    Cstn.134_324         7.655142e-07   3.928064e-05      3.473416e-05
10   Cstn.134_323         1.846865e-06   2.030624e-03      9.826631e-05
11   Astr.326_189         1.301715e-02   5.216766e-03      1.370287e-02
12   Astr.409_177         1.176005e-02   2.087632e-03      0.000000e+00
13   Astr.267_196         1.278097e-04   4.118595e-03      3.892633e-05
14   Dryc.267_540         3.067388e-02   8.848441e-03      0.000000e+00
15   Ant..355_100         1.908372e-04   1.420634e-04      1.226419e-03
16   Lpns.132_902         1.058989e-03   1.189091e-02      2.629081e-03
17   Lpns.132_901         1.124107e-03   6.153192e-03      3.406878e-03
18    Lpn..55_899         4.611941e-02   3.033784e-02      9.327366e-04
19   Crp2.123_294         7.193321e-07   2.644265e-04      0.000000e+00
20    Acrs.330_19         1.942699e-03   3.815111e-03      0.000000e+00
21    All4.185_58         9.441758e-02   1.129481e-03      0.000000e+00
22    All4.185_56         9.409866e-02   2.513995e-03      0.000000e+00
23    All4.185_62         3.897842e-02   3.568100e-04      0.000000e+00
24    All4.185_55         1.651605e-01   9.997637e-03      0.000000e+00
25    All4.185_59         1.699247e-01   4.329829e-03      0.000000e+00
26    All4.185_65         1.461733e-01   9.709006e-03      0.000000e+00
27  Sphr.129_1358         2.104041e-01   0.000000e+00      0.000000e+00
28   Hlnt.267_711         2.335690e-03   1.148483e-02      1.611358e-03
29   Hlnt.267_712         3.580157e-03   3.124747e-02      8.387555e-04
30   Erdm.267_599         2.754661e-05   1.082883e-03      1.066889e-04
31   Erdm.267_598         2.808797e-05   4.280003e-04      6.524920e-05
32  Ont..575_1014         3.797247e-02   2.640438e-04      1.654824e-06
33  Sxfr.152_1302         4.350709e-01   0.000000e+00      1.068240e-01
34  Pln2.608_1122         2.861199e-03   6.155718e-02      1.189334e-03
35  Pln2.608_1124         1.185861e-02   2.086196e-02      1.059105e-03
36  Pln2.608_1129         6.571590e-03   9.694594e-04      2.344591e-03
37   Drc2.151_550         5.514313e-05   1.598278e-03      1.286515e-04
38   Drc2.151_549         4.792627e-05   1.991213e-03      1.105230e-04
39  Rmnd.445_1217         3.507665e-06   2.483465e-05      8.568739e-06
40  Rmnd.445_1214         5.069338e-05   1.280223e-02      5.437151e-04
41   Myst.152_983         6.352450e-01   0.000000e+00      2.104031e-03
42   Gntn.423_679         5.785807e-04   3.895910e-03      9.044300e-04
43   Hypc.282_759         1.857057e-04   8.573868e-04      1.252851e-02
44   Echn.129_555         4.556823e-02   0.000000e+00      0.000000e+00
45   Ech2.263_557         3.341240e-04   2.446895e-04      1.211224e-06
46   Ech2.263_556         5.442867e-05   3.648008e-04      9.845581e-05
47  Rtbd.129_1225         6.581060e-01   0.000000e+00      0.000000e+00
48   Ltrs.166_862         5.985893e-03   3.201929e-02      3.136667e-03
49   Artm.355_146         3.480291e-05   1.380049e-05      1.180574e-03
50  Sldg.129_1354         1.270544e-01   0.000000e+00      0.000000e+00
51   Crsm.474_389         8.065638e-03   1.568766e-02      0.000000e+00
52   Crsm.283_383         1.540169e-04   1.194387e-04      1.143753e-04
53   Crsm.283_384         3.489597e-04   2.180634e-04      5.892436e-05
54   Crsm.283_386         5.062695e-04   6.639794e-03      1.117036e-02
55    Crs3.41_395         8.653618e-02   3.700410e-03      7.132525e-05
56   Crs5.166_400         8.155830e-02   7.619270e-04      1.274713e-04
57   Crsm.129_409         2.326958e-02   0.000000e+00      0.000000e+00
58   Jrnf.267_786         4.216837e-03   1.427212e-04      1.230737e-04
59   Cntr.282_346         4.987168e-02   4.278258e-03      1.530113e-03
60   Cntr.282_347         2.742320e-02   3.520732e-03      1.055724e-03
61   Chrl.267_374         6.069221e-03   1.206062e-03      0.000000e+00
62   Crmc.301_320         5.571422e-02   1.885842e-03      7.835922e-04
63   Crmc.301_319         4.989620e-02   8.745159e-03      1.267489e-04
64  Sccs.282_1371         2.506157e-04   1.272455e-03      1.058512e-03
65  Sccs.282_1370         5.875971e-04   3.624779e-04      5.457551e-04
66  Sccs.282_1368         6.744761e-05   1.534331e-03      1.068427e-03
67  Scc3.381_1377         6.927251e-04   1.134496e-02      2.694870e-04
68   Ards.431_127         2.818867e-04   9.146217e-03      3.799730e-05
69    Andr.152_83         3.514658e-01   0.000000e+00      3.849840e-02
70  Prm4.582_1157         1.383515e-01   4.312519e-02      1.416895e-02
71   Prm5.73_1164         7.772986e-06   1.600067e-03      1.700682e-03
72  Prml.272_1153         8.362892e-06   7.918209e-04      1.459930e-04
73  Prml.596_1165         3.602506e-04   1.076073e-02      1.101186e-03
74  Prm2.170_1169         1.327601e-02   7.679306e-04      5.229724e-04
75  Prm3.591_1170         4.455454e-04   2.412247e-03      3.129632e-04
76  Srr2.571_1298         1.243162e-05   1.833618e-04      5.677130e-07
77  Prny.129_1065         1.238293e-01   0.000000e+00      0.000000e+00
78   Atrp.603_217         2.355208e-04   9.955307e-02      6.960505e-04
79   Nbxb.182_991         6.478582e-05   1.096793e-03      2.204655e-05
80   Nbx2.183_992         6.889012e-05   1.764007e-03      2.011543e-05
81   Nbx3.183_990         4.282122e-06   1.080990e-04      8.074914e-05
82   Mmml.193_925         1.337765e-06   7.099273e-04      1.307458e-03
83   Mmm2.194_928         3.284005e-04   4.792671e-03      1.384336e-04
84   Mmml.490_935         1.374624e-03   3.370801e-04      1.961760e-05
85   Arcr.350_132         1.682590e-05   9.715924e-04      1.293279e-05
86   Arcr.350_131         4.309725e-06   4.129180e-04      3.501265e-04
87   Cryp.511_463         9.527210e-06   1.126878e-03      0.000000e+00
88  Rmxr.267_1261         1.198250e-04   1.785600e-03      3.525705e-04
89   Armr.208_139         2.174559e-03   2.217982e-03      7.709862e-05
90   Lmnm.267_871         6.700071e-03   2.738740e-03      6.570648e-04
91  Rnnc.266_1222         4.509389e-02   2.512034e-02      1.903172e-03
92    Acts.204_27         7.254452e-05   2.080658e-03      4.607404e-04
93    Acts.204_28         6.588281e-05   9.105740e-04      2.351034e-04
94   Dcnt.331_511         3.774857e-05   1.493787e-04      2.862153e-06
95   Dcnt.331_510         1.842111e-04   1.161441e-03      1.939162e-04
96   Dcnt.331_509         4.033717e-04   1.411501e-03      4.228909e-04
97   Chmd.594_367         3.817657e-04   4.294244e-05      0.000000e+00
98   Chmd.172_368         3.176458e-04   2.708267e-03      1.582705e-03
99    Brss.36_238         9.842322e-06   6.164722e-05      4.547185e-06
100 Plpn.355_1136         9.921824e-05   2.448080e-03      2.793806e-04
101 Zdpl.500_1534         1.057153e-04   1.343679e-02      9.896167e-04
102  Dnth.384_499         3.826597e-03   1.996066e-03      2.438940e-03
103  Hlrm.601_725         1.551924e-03   2.504789e-02      1.198529e-03
104  Ctps.143_328         8.939245e-03   3.979938e-04      4.361848e-04
105 Orch.273_1029         1.479776e-04   3.981909e-04      8.641597e-04
106  Cypr.576_483         9.207344e-05   4.108961e-04      3.307495e-04
107  Cypr.576_482         1.186338e-04   2.274123e-03      1.937584e-03
108  Cypr.576_484         4.596083e-05   1.137449e-04      5.377853e-04
109   Allm.402_69         2.766143e-03   1.017325e-03      1.863293e-04
110 Trll.304_1438         0.000000e+00   9.770756e-05      1.595867e-05
111 Trll.304_1442         0.000000e+00   7.217425e-04      7.271393e-06
112 Trll.304_1446         0.000000e+00   6.397791e-04      4.955547e-05
113 Trll.304_1443         0.000000e+00   1.018407e-04      1.959553e-04
114 Trll.304_1437         0.000000e+00   5.688097e-04      1.698155e-04
115 Trll.304_1435         0.000000e+00   2.265819e-05      0.000000e+00
116 Trll.304_1439         0.000000e+00   2.564256e-04      2.294640e-05
117 Trll.304_1441         0.000000e+00   1.568601e-03      3.146574e-07
118 Trll.304_1444         0.000000e+00   3.708480e-04      3.718267e-05
119  Clch.382_287         4.962345e-04   6.965824e-04      3.703569e-04
120  Asrm.131_148         6.751073e-03   1.041108e-03      0.000000e+00
121 Pnss.391_1116         8.702378e-06   1.773344e-04      0.000000e+00
    Clonality_SigElas Survival_SigElas Cumulative_SigElas    Buffmx MatRep
1        0.000000e+00     1.492507e-03       0.0025916716 1.0004237      4
2        0.000000e+00     1.199857e-01       0.1908436699 1.1469247     53
3        0.000000e+00     6.514767e-03       0.0090817103 1.0117730      4
4        0.000000e+00     6.431885e-02       0.0704828041 1.0988250      7
5        0.000000e+00     7.402989e-04       0.2768842385 1.0172371      3
6        0.000000e+00     3.302788e-04       0.0006350713 0.9975678      4
7        0.000000e+00     1.278424e-03       0.0019932976 1.0013987      4
8        0.000000e+00     4.386394e-04       0.0005392551 1.0010531      4
9        0.000000e+00     2.161637e-04       0.0002214757 0.9976748      4
10       0.000000e+00     2.491582e-03       0.0044257874 1.0062788      4
11       0.000000e+00     1.907617e-02       0.0405794188 1.1022898      5
12       0.000000e+00     4.929481e-02       0.0631424979 1.0064223      6
13       0.000000e+00     1.147877e-04       0.0040666465 1.0045646      3
14       0.000000e+00     1.209782e-01       0.1605005273 1.0902586      4
15       0.000000e+00     6.002037e-03       0.0047268433 1.0103733      4
16       0.000000e+00     1.122510e-03       0.0093253474 1.0579087      5
17       0.000000e+00     7.458346e-03       0.0090805532 1.0110815      6
18       0.000000e+00     1.087097e-01       0.1235585541 1.9381641     17
19       0.000000e+00     1.196359e-03       0.0014600660 0.9954316      5
20       0.000000e+00     8.748851e-03       0.0145066615 1.0169975      4
21       0.000000e+00     5.179131e-03       0.0881089646 1.0414770      3
22       0.000000e+00     3.004808e-03       0.0945894720 1.0671800      3
23       0.000000e+00     9.294972e-03       0.0293266359 1.0141861      3
24       0.000000e+00     3.394509e-02       0.1212177982 1.1081790      3
25       0.000000e+00     3.813056e-02       0.2037254736 1.3555067      3
26       0.000000e+00     9.146317e-02       0.0450010817 1.2751194      3
27       0.000000e+00     4.226229e-01       0.6330270154 1.1199191     26
28       0.000000e+00     1.087410e-02       0.0230832569 1.0095946      5
29       0.000000e+00     7.192719e-02       0.1059160671 1.0948962      3
30       0.000000e+00     9.970538e-04       0.0022141725 1.0029059      5
31       0.000000e+00     1.383320e-03       0.0009924813 1.0013082      5
32       0.000000e+00     6.886427e-02       0.1071024312 1.0016803     12
33       0.000000e+00     1.145268e-01       0.2137200951 1.0881019      6
34       0.000000e+00     1.296219e-01       0.1871285211 1.1898041      3
35       0.000000e+00     6.666257e-02       0.0983240409 1.0598832      3
36       0.000000e+00     4.696490e-02       0.0521613555 1.1273793      3
37       0.000000e+00     6.214475e-03       0.0076289579 1.0064561      3
38       0.000000e+00     2.006373e-03       0.0040601833 1.0011119      3
39       0.000000e+00     8.781801e-05       0.0001005763 1.0017544      3
40       0.000000e+00     2.205962e-02       0.0342674372 1.0100856      6
41       0.000000e+00     2.059389e-03       0.6352896581 1.0617870      3
42       0.000000e+00     8.605643e-03       0.0110185425 1.0819747      3
43       9.106199e-04     1.086539e-02       0.0019020587 1.0520314      3
44       0.000000e+00     1.124150e-01       0.1579832558 1.1249988     30
45       0.000000e+00     4.998179e-04       0.0010774201 0.9966785      5
46       0.000000e+00     4.976895e-04       0.0008184631 1.0017862      3
47       0.000000e+00     1.355710e+00       2.0138158723 1.1427458     14
48       0.000000e+00     1.216314e-02       0.0413332040 1.1040372      5
49       0.000000e+00     2.632782e-03       0.0014732110 1.0111736      3
50       0.000000e+00     2.734569e-01       0.4005113269 1.1766299     19
51       0.000000e+00     3.054799e-02       0.0543012894 1.0224502      3
52       1.807953e-01     8.720921e-03       0.1719946290 1.0064660      3
53       7.802471e-02     4.518761e-03       0.0736957665 1.0222895      3
54       2.395295e-01     1.696512e-01       0.0881946579 1.1123591      3
55       0.000000e+00     8.134306e-03       0.0984422249 1.0699287      4
56       0.000000e+00     9.336925e-04       0.0815140053 1.0202616      4
57       0.000000e+00     4.756358e-02       0.0708331612 1.1238899     25
58       0.000000e+00     2.828022e-02       0.0325167026 1.0203434      4
59       2.626497e-01     2.402223e-02       0.2826907289 1.0022460      4
60       4.262420e-01     7.199570e-02       0.3841345465 1.0170315      4
61       0.000000e+00     1.375033e-02       0.0210256103 1.0006248      3
62       0.000000e+00     8.400276e-03       0.0462116981 1.0144133      3
63       0.000000e+00     4.276458e-03       0.0367478326 1.0081205      3
64       8.462191e-04     1.191313e-03       0.0041178833 1.0137131      4
65       2.201031e-05     1.613227e-03       0.0020395569 1.0124443      3
66       1.797835e-04     1.966254e-03       0.0025444941 0.9987339      4
67       0.000000e+00     4.990288e-02       0.0622100563 1.0643938     15
68       0.000000e+00     1.951426e-02       0.0101241581 1.0282270      3
69       0.000000e+00     9.305599e-02       0.2199114054 1.2549325      5
70       0.000000e+00     2.185634e-01       0.2996207857 1.0963114      3
71       0.000000e+00     7.504536e-03       0.0042115602 1.0528927     12
72       0.000000e+00     2.314389e-03       0.0032438397 1.0043468      5
73       0.000000e+00     4.275384e-02       0.0305316733 1.2005358     10
74       0.000000e+00     1.809123e-02       0.0300763392 1.0136580     14
75       0.000000e+00     5.575161e-05       0.0022239136 1.0062161     24
76       0.000000e+00     2.331020e-04       0.0004045999 1.0001203      4
77       0.000000e+00     2.811162e-01       0.4049455351 1.1200143     25
78       0.000000e+00     1.367290e-01       0.2353505230 1.1415555      3
79       0.000000e+00     1.594839e-03       0.0027343721 0.9857018      3
80       0.000000e+00     3.172368e-03       0.0013595864 1.0363167      3
81       0.000000e+00     8.680372e-04       0.0006749069 1.0037322      3
82       0.000000e+00     8.349851e-05       0.0019325491 1.0026622      5
83       0.000000e+00     8.959835e-03       0.0135625394 1.0040824      5
84       0.000000e+00     3.171483e-03       0.0041894093 0.9991667      3
85       0.000000e+00     2.693891e-03       0.0036615905 1.0040889      4
86       0.000000e+00     3.169151e-02       0.0317586117 1.0142548      3
87       0.000000e+00     1.048319e-03       0.0021847250 1.0052818      5
88       0.000000e+00     1.200429e-02       0.0104514359 1.0143370      4
89       0.000000e+00     5.819248e-03       0.0102888869 1.0133921     24
90       0.000000e+00     4.083153e-03       0.0087015483 1.0016138      5
91       0.000000e+00     1.307869e-01       0.1990979463 1.0575854      3
92       0.000000e+00     5.421641e-03       0.0078904944 1.0145514      6
93       0.000000e+00     5.401356e-03       0.0060109438 1.0111872      5
94       7.275529e-05     1.323052e-05       0.0002759752 0.9997896      4
95       2.233719e-04     9.700826e-06       0.0013654069 1.0031133      6
96       3.039467e-04     6.954876e-04       0.0024304547 1.0048691      6
97       2.120882e-05     2.245672e-04       0.0005845992 1.0040503      6
98       0.000000e+00     3.716247e-04       0.0042369927 1.0115493     14
99       0.000000e+00     4.172605e-04       0.0004736126 1.0001780      4
100      1.265238e-04     4.250371e-03       0.0070051368 1.0040632      5
101      0.000000e+00     7.758207e-03       0.0220788988 1.0422046     11
102      0.000000e+00     3.591053e-02       0.0353021194 1.0713503      3
103      0.000000e+00     8.005753e-02       0.1054588184 1.1658164      4
104      0.000000e+00     1.272564e-02       0.0217030794 1.0132490      3
105      0.000000e+00     5.077108e-03       0.0039627351 1.0043283     16
106      0.000000e+00     1.337868e-03       0.0013497951 1.0047770      7
107      0.000000e+00     1.334057e-04       0.0039596679 1.0181906      7
108      0.000000e+00     2.273735e-03       0.0029712256 1.0079742      5
109      2.708920e-01     2.358525e-03       0.2704686714 1.0117780      4
110      0.000000e+00     1.731355e-03       0.0018131038 1.0014665      5
111      0.000000e+00     1.970706e-04       0.0005174006 0.9991554      5
112      0.000000e+00     1.151916e-03       0.0017421393 0.9996627      5
113      0.000000e+00     8.259829e-04       0.0009200976 0.9974504      3
114      0.000000e+00     7.087578e-04       0.0014473830 1.0012208      5
115      0.000000e+00     5.200273e-04       0.0004973691 1.0036398      3
116      0.000000e+00     4.206070e-04       0.0001412349 0.9997875      7
117      0.000000e+00     4.055232e-03       0.0056235191 0.9995278      3
118      0.000000e+00     3.065281e-05       0.0004386835 1.0010317      4
119      0.000000e+00     1.646235e-03       0.0010755302 1.0061722     32
120      1.010784e-03     2.229265e-02       0.0290133976 1.0207404     14
121      0.000000e+00     9.126873e-04       0.0010987241 0.9959259      9
         LHPC.1       LHPC.2      ClimPC.1    ClimPC.2    ClimPC.3
1    1.32464828  0.537854879  0.1901416531 -0.28772696 -0.32364884
2   -1.42492399 -0.649069599 -1.7561907820  0.04956925  0.52991276
3    0.56077336  0.164523234  1.8598982808 -0.06178840  0.11224260
4   -0.96962137 -0.340730299  0.4375307731  2.67206519  0.96562898
5    1.09629297  0.389760264 -0.7730831616  0.34794691  0.40958101
6   -0.55655519 -0.813525720  1.4472669041 -1.00114517  0.36312670
7   -1.06729001 -0.261477978  1.2858271979 -0.89654864  0.03574476
8    2.37514805 -1.099652568  1.0944563796 -1.24164970  0.01949560
9    2.34539416 -1.157483245  1.1425652992 -1.16795116  0.00961047
10   0.21879672 -0.185191173  1.1212553499 -1.13208352  0.10430753
11   0.33967682 -0.204267535  1.6907544333  1.99312203 -0.88785777
12   0.58654442  1.552895288  0.4760451051 -0.32094170 -0.12789129
13   2.68610180 -1.508329446  0.1855146450  0.65577927 -0.28465691
14   2.13295782  0.859818742 -0.1224602535  0.86297646 -0.17848110
15   1.31952961 -1.035990880  0.9097750097 -2.39020122  0.62282181
16  -0.38478405 -0.092261418 -0.2316797050  0.95835523  0.21723754
17   1.50838482  0.269527637 -0.2223902021  0.89572714  0.17701314
18   0.62209109 -0.432490111  0.8774241269 -1.13693440  1.62120290
19   1.00434501  0.295205182 -2.3926197845 -0.18185305  0.59888797
20   1.35067955 -0.954406230  2.0755021947  0.95538347  1.32691290
21  -0.12053648  0.342208089  1.1086906247 -0.46406791 -0.20821291
22   0.65426452  1.301049021  1.2417517508  0.82778456  0.44571374
23   2.13426916 -0.807632593  1.2283556324 -0.35890996 -0.32905057
24   1.89249324  0.989150312  1.0126619397  0.12345998  0.06007740
25  -0.26206038  0.259625422  1.0181982496 -0.44286222 -0.33302275
26   1.64771068  0.290618241  1.1150215913 -0.48773093 -0.43707692
27  -4.62204819  0.597566619  2.4257757354  2.21229460  1.20748053
28  -2.83595721  2.971082188  0.0645731944  0.94284066  0.03310394
29  -0.34423198  1.409778546 -0.4073604547  0.58685928 -0.39610567
30  -0.18148396 -0.020375412  0.1418401072  0.56464639 -0.07098295
31   0.11793730 -0.034542972 -0.0134516680  0.61697753 -0.02090477
32   2.30548757  2.560948144 -0.2355186453  1.72796797  0.55070377
33   1.72460210  0.590967280  0.7395830604 -0.26063871 -0.59497021
34  -0.07774510 -0.316277460 -0.6879615697  2.10077564  1.02619889
35  -0.43331618 -0.390104238 -0.6894463627 -0.46803216  0.07901195
36  -0.07259981 -0.497804902  0.7626892441 -1.02418802 -0.31691032
37   1.38217819 -0.087009229  0.9505472946  0.25373062 -0.36804073
38   0.28268740  0.199731108  0.9529629675  0.36575851 -0.36555976
39   1.79724754  1.340636343  0.5968969616  0.46873583  0.40369338
40   0.02348962  0.089457485  0.8265089105  0.29215625  0.53507414
41   2.04385585  0.943217705  0.7395830604 -0.26063871 -0.59497021
42  -4.13027561  1.133271320  0.7619565639 -0.18606683 -0.02771252
43  -1.07358046  0.040761906  0.4863720564 -0.20995834 -0.37533525
44   0.41477648  0.299127306  2.2871049397  2.41124712  1.25690733
45   0.18242622  0.276822341  0.5918071001  0.09849035 -0.05782457
46  -1.33815439 -1.158104197  0.2767905277 -0.64299861 -0.31952387
47  -2.29821434 -0.517832263  2.4257757354  2.21229460  1.20748053
48   1.47004816  0.722283861  1.3884443409 -0.35922791 -0.01312157
49   1.87801910  0.282782785  0.9097750097 -2.39020122  0.62282181
50  -4.23747569  0.323511508  2.4257757354  2.21229460  1.20748053
51   2.06180504 -0.950831472  1.0361104449 -0.49700718 -0.78333529
52  -3.08938703  0.215411257  0.4014577875 -0.18865705 -0.38653722
53   2.77729996 -0.744645144  0.4681051969 -0.21333330 -0.37798458
54   1.21352791 -0.371621315  0.4667961789 -0.21919017 -0.31861025
55  -0.10507296 -0.826523034  0.9451028628 -0.59948045  0.12070552
56  -0.23147707 -0.638967301  1.6114594226 -0.04575505  0.12318110
57   0.82647843 -1.007634897  2.2871049397  2.41124712  1.25690733
58   0.87005479  0.671516129 -0.4681933238  0.06649261 -0.21288706
59   1.60244842 -0.868181765  0.4014577875 -0.18865705 -0.38653722
60   0.44521397 -0.640920856  0.4681051969 -0.21333330 -0.37798458
61   0.44057252 -0.616964686 -0.1397928929  0.53624725 -0.42230483
62   0.87544995 -0.307634285  1.0769134011 -0.69736036 -1.47238536
63   1.28762421 -0.894993575  1.5329901236 -1.12182273 -0.83812394
64  -4.23747569  0.323511508  0.4302852079 -0.24179492 -0.36925265
65  -4.96112780  0.549810577  0.4681051969 -0.21333330 -0.37798458
66  -4.62629978  0.596240214  0.4014577875 -0.18865705 -0.38653722
67   0.16203807  0.012146991  1.8156994500  0.02731675 -0.03538656
68  -0.45828842 -0.257370385 -2.2039661972 -0.43245497  0.32090193
69  -1.48937190 -0.851180889  0.7395830604 -0.26063871 -0.59497021
70   0.42060089  0.846082394  1.3902869769 -0.07324338 -0.37001193
71   1.41128425 -0.625449275  0.3891227737 -0.17737344 -0.29741967
72   0.81871825 -0.579572921  0.3475026740 -0.77983148 -0.34411841
73   1.50162477 -0.738864602 -0.2549818707 -0.92466195 -0.86292672
74   0.41502047 -0.532623775 -0.0002088708 -0.78039694 -0.78443947
75   2.06022126 -0.954533847 -0.7425642082 -1.34483703 -0.11362628
76  -4.34768652  0.310739550  0.9599472516 -0.87928286 -0.56193794
77   0.47294500 -0.498375939  2.2871049397  2.41124712  1.25690733
78  -2.09548698 -0.294589929 -0.6145513071  2.70427584  0.86974688
79  -0.32716913 -0.179802414 -1.3738783145  0.37527046 -0.30163189
80   0.11606091  0.961718360 -1.3738783145  0.37527046 -0.30163189
81   2.55366921 -0.374189229 -1.3738783145  0.37527046 -0.30163189
82   0.36538940 -0.179072345 -1.5952953930  1.02210963  0.21559050
83   0.46331537  0.137758712 -1.6917671379  0.86555414  0.20846126
84   0.88092508  2.144336179 -1.6309258120  0.38437375 -0.24287384
85  -0.29625503 -0.235721588 -0.3717725042  2.78160961  0.95716696
86   1.85338100  7.599812825 -0.3607361355  2.76380872  0.94874098
87   1.53069143 -0.833409703  0.7670786060  1.90505915  0.98725395
88  -1.45321573 -0.801290883 -0.6197935504 -0.30374064  0.21859866
89  -0.03599821  0.248647534  0.0290749929  0.21792912  0.04057466
90   2.13134796  1.112210121 -0.0545412156  0.78337097 -0.02332064
91  -0.14821863 -0.398410796  2.2676408997  0.01708203  0.32163290
92   1.00351444  0.118662360  1.8403665291  0.13846913  0.03820071
93   0.11746148 -0.201083931  1.8622642755  0.06927096  0.06856271
94  -1.28049486  1.324442705  0.3716436184  0.02078917  0.04085176
95  -0.22657292 -0.270479797  0.3770234619  0.06830037  0.02851837
96  -1.29266891 -0.727598290  0.4736846285  0.10346305 -0.09195498
97   0.87637358  0.024204126 -3.6880681000 -1.75233219  2.02884510
98  -1.25296387 -0.305498084 -1.2433093245  1.12819762  0.74686358
99   0.93360200  0.039306015 -2.3197370835  0.27446076  0.25868305
100 -0.48113223 -0.267143995  0.9097750097 -2.39020122  0.62282181
101  1.11591045 -0.224008873 -1.0543613796  0.73770969  0.79148913
102 -3.11960903  0.615379811  0.2801875797  0.21788596  0.18110723
103  0.01026127  0.196708591 -0.7135975980  2.58121786  0.76691034
104 -1.06761350 -0.556191663 -1.8739491435 -0.45318379 -0.14444214
105 -1.24316113 -0.737201942  0.7979207719 -0.33450502 -0.03864572
106 -1.16028746  0.577307150  0.3430433599  1.61505992  0.91408058
107 -2.70732004  1.708784793  0.4949018701  2.25916732  0.83829973
108 -2.58371786 -0.382985166  0.7639910865  1.79538409  0.65950726
109 -1.29887476 -0.383840462  1.4732264132 -1.63849580  0.55521569
110 -0.11102808 -0.001042222  0.5057094428 -0.87317673 -0.25452323
111 -0.11288327 -0.263697643  0.6055468241 -0.77949621 -0.35605880
112 -0.34238159 -0.082509243  0.4970393113 -0.99556381 -0.25529127
113 -0.16314967  0.243580718  0.5731929552 -0.84398631 -0.31908468
114 -0.35598966  0.239821971  0.4951619353 -0.85904086 -0.27161723
115 -0.03661108 -0.264173768  0.5134626127 -0.82758632 -0.33631872
116 -0.28062667 -0.043255956  0.5082677717 -0.86911082 -0.28504364
117 -0.28035214 -0.155445924  0.6076304668 -0.74343628 -0.35436699
118 -0.21225711 -0.001855859  0.6734935916 -0.66963609 -0.40946570
119  2.16602800 -0.257929140  2.0927212323 -0.52744279  1.62879830
120  0.63911719  0.437562271  2.8220623624 -1.68655232  1.66817327
121  2.05580076  0.097852476  0.5888131058 -1.28451621  0.11992176
                SpeciesAccepted Kingdom        Phylum         Class
1        Euphorbia fontqueriana Plantae Magnoliophyta Magnoliopsida
2          Hypericum cumulicola Plantae Magnoliophyta Magnoliopsida
3           Agrimonia eupatoria Plantae Magnoliophyta Magnoliopsida
4            Purshia subintegra Plantae Magnoliophyta Magnoliopsida
5                Cucurbita pepo Plantae Magnoliophyta Magnoliopsida
6              Castanea dentata Plantae  Tracheophyta Magnoliopsida
7              Castanea dentata Plantae  Tracheophyta Magnoliopsida
8              Castanea dentata Plantae  Tracheophyta Magnoliopsida
9              Castanea dentata Plantae  Tracheophyta Magnoliopsida
10             Castanea dentata Plantae  Tracheophyta Magnoliopsida
11        Astragalus scaphoides Plantae Magnoliophyta Magnoliopsida
12        Astragalus alopecurus Plantae Magnoliophyta Magnoliopsida
13      Astragalus tremolsianus Plantae Magnoliophyta Magnoliopsida
14         Dorycnium spectabile Plantae Magnoliophyta Magnoliopsida
15         Anthyllis vulneraria Plantae Magnoliophyta Magnoliopsida
16          Lupinus tidestromii Plantae Magnoliophyta Magnoliopsida
17          Lupinus tidestromii Plantae Magnoliophyta Magnoliopsida
18              Lupinus lepidus Plantae Magnoliophyta Magnoliopsida
19            Carapa guianensis Plantae Magnoliophyta Magnoliopsida
20               Acer saccharum Plantae Magnoliophyta Magnoliopsida
21           Alliaria petiolata Plantae Magnoliophyta Magnoliopsida
22           Alliaria petiolata Plantae Magnoliophyta Magnoliopsida
23           Alliaria petiolata Plantae Magnoliophyta Magnoliopsida
24           Alliaria petiolata Plantae Magnoliophyta Magnoliopsida
25           Alliaria petiolata Plantae Magnoliophyta Magnoliopsida
26           Alliaria petiolata Plantae Magnoliophyta Magnoliopsida
27         Sphaeralcea coccinea Plantae Magnoliophyta Magnoliopsida
28    Helianthemum polygonoides Plantae Magnoliophyta Magnoliopsida
29      Helianthemum teneriffae Plantae Magnoliophyta Magnoliopsida
30           Erodium paularense Plantae Magnoliophyta Magnoliopsida
31           Erodium paularense Plantae Magnoliophyta Magnoliopsida
32          Oenothera deltoides Plantae Magnoliophyta Magnoliopsida
33      Saxifraga tridactylites Plantae Magnoliophyta Magnoliopsida
34           Plantago coronopus Plantae Magnoliophyta Magnoliopsida
35           Plantago coronopus Plantae Magnoliophyta Magnoliopsida
36           Plantago coronopus Plantae Magnoliophyta Magnoliopsida
37     Dracocephalum austriacum Plantae Magnoliophyta Magnoliopsida
38     Dracocephalum austriacum Plantae Magnoliophyta Magnoliopsida
39               Ramonda myconi Plantae Magnoliophyta Magnoliopsida
40               Ramonda myconi Plantae Magnoliophyta Magnoliopsida
41         Myosotis ramosissima Plantae Magnoliophyta Magnoliopsida
42        Gentiana pneumonanthe Plantae Magnoliophyta Magnoliopsida
43         Hypochaeris radicata Plantae Magnoliophyta Magnoliopsida
44       Echinacea angustifolia Plantae Magnoliophyta Magnoliopsida
45       Echinacea angustifolia Plantae Magnoliophyta Magnoliopsida
46       Echinacea angustifolia Plantae Magnoliophyta Magnoliopsida
47         Ratibida columnifera Plantae Magnoliophyta Magnoliopsida
48             Liatris scariosa Plantae Magnoliophyta Magnoliopsida
49             Artemisia genipi Plantae Magnoliophyta Magnoliopsida
50              Solidago mollis Plantae Magnoliophyta Magnoliopsida
51             Cirsium palustre Plantae Magnoliophyta Magnoliopsida
52            Cirsium dissectum Plantae Magnoliophyta Magnoliopsida
53            Cirsium dissectum Plantae Magnoliophyta Magnoliopsida
54            Cirsium dissectum Plantae Magnoliophyta Magnoliopsida
55             Cirsium pitcheri Plantae Magnoliophyta Magnoliopsida
56             Cirsium pitcheri Plantae Magnoliophyta Magnoliopsida
57            Cirsium undulatum Plantae Magnoliophyta Magnoliopsida
58            Jurinea fontqueri Plantae Magnoliophyta Magnoliopsida
59              Centaurea jacea Plantae Magnoliophyta Magnoliopsida
60              Centaurea jacea Plantae Magnoliophyta Magnoliopsida
61     Cheirolophus metlesicsii Plantae Magnoliophyta Magnoliopsida
62                  Carum carvi Plantae Magnoliophyta Magnoliopsida
63                  Carum carvi Plantae Magnoliophyta Magnoliopsida
64            Succisa pratensis Plantae Magnoliophyta Magnoliopsida
65            Succisa pratensis Plantae Magnoliophyta Magnoliopsida
66            Succisa pratensis Plantae Magnoliophyta Magnoliopsida
67            Succisa pratensis Plantae Magnoliophyta Magnoliopsida
68       Ardisia escallonioides Plantae Magnoliophyta Magnoliopsida
69           Androsace elongata Plantae Magnoliophyta Magnoliopsida
70             Primula farinosa Plantae  Tracheophyta Magnoliopsida
71                Primula veris Plantae Magnoliophyta Magnoliopsida
72              Primula elatior Plantae Magnoliophyta Magnoliopsida
73             Primula vulgaris Plantae Magnoliophyta Magnoliopsida
74             Primula vulgaris Plantae Magnoliophyta Magnoliopsida
75             Primula vulgaris Plantae Magnoliophyta Magnoliopsida
76          Sarracenia purpurea Plantae Magnoliophyta Magnoliopsida
77           Paronychia jamesii Plantae Magnoliophyta Magnoliopsida
78           Atriplex canescens Plantae  Tracheophyta Magnoliopsida
79    Neobuxbaumia mezcalaensis Plantae Magnoliophyta Magnoliopsida
80    Neobuxbaumia mezcalaensis Plantae Magnoliophyta Magnoliopsida
81    Neobuxbaumia macrocephala Plantae Magnoliophyta Magnoliopsida
82  Mammillaria huitzilopochtli Plantae Magnoliophyta Magnoliopsida
83  Mammillaria huitzilopochtli Plantae Magnoliophyta Magnoliopsida
84      Mammillaria solisioides Plantae Magnoliophyta Magnoliopsida
85        Ariocarpus fissuratus Plantae Magnoliophyta Magnoliopsida
86        Ariocarpus fissuratus Plantae Magnoliophyta Magnoliopsida
87        Escobaria robbinsorum Plantae Magnoliophyta Magnoliopsida
88              Rumex rupestris Plantae Magnoliophyta Magnoliopsida
89           Armeria caespitosa Plantae Magnoliophyta Magnoliopsida
90             Limonium erectum Plantae Magnoliophyta Magnoliopsida
91          Ranunculus peltatus Plantae Magnoliophyta Magnoliopsida
92               Actaea spicata Plantae Magnoliophyta Magnoliopsida
93               Actaea spicata Plantae Magnoliophyta Magnoliopsida
94          Dicentra canadensis Plantae  Tracheophyta Magnoliopsida
95          Dicentra canadensis Plantae  Tracheophyta Magnoliopsida
96          Dicentra canadensis Plantae  Tracheophyta Magnoliopsida
97          Chamaedorea elegans Plantae Magnoliophyta    Liliopsida
98        Chamaedorea radicalis Plantae Magnoliophyta    Liliopsida
99           Borassus aethiopum Plantae Magnoliophyta    Liliopsida
100                  Poa alpina Plantae Magnoliophyta    Liliopsida
101           Zea diploperennis Plantae Magnoliophyta    Liliopsida
102           Danthonia sericea Plantae Magnoliophyta    Liliopsida
103              Hilaria mutica Plantae Magnoliophyta    Liliopsida
104           Catopsis compacta Plantae Magnoliophyta    Liliopsida
105             Orchis purpurea Plantae Magnoliophyta    Liliopsida
106    Cypripedium fasciculatum Plantae Magnoliophyta    Liliopsida
107    Cypripedium fasciculatum Plantae Magnoliophyta    Liliopsida
108    Cypripedium fasciculatum Plantae Magnoliophyta    Liliopsida
109            Allium tricoccum Plantae Magnoliophyta    Liliopsida
110       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
111       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
112       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
113       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
114       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
115       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
116       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
117       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
118       Trillium grandiflorum Plantae Magnoliophyta    Liliopsida
119         Calochortus lyallii Plantae Magnoliophyta    Liliopsida
120            Asarum canadense Plantae Magnoliophyta Magnoliopsida
121               Pinus strobus Plantae     Pinophyta     Pinopsida
             Order         OrganismType AngioGymno    lambda Ecoregion
1     Malpighiales            Succulent Angiosperm 0.9779625       MED
2          Theales Herbaceous perennial Angiosperm 1.0243679       TCF
3          Rosales Herbaceous perennial Angiosperm 0.9283973       FGS
4          Rosales                Shrub Angiosperm 0.9751571       DES
5    Curcurbitales               Annual Angiosperm 1.2408827       TBM
6          Fagales                 Tree Angiosperm 1.0088920       TBM
7          Fagales                 Tree Angiosperm 1.0067955       TBM
8          Fagales                 Tree Angiosperm 0.9940440       TBM
9          Fagales                 Tree Angiosperm 0.9934334       TBM
10         Fagales                 Tree Angiosperm 0.9818987       TBM
11         Fabales Herbaceous perennial Angiosperm 1.5999061       DES
12         Fabales Herbaceous perennial Angiosperm 1.5506323       TBM
13         Fabales Herbaceous perennial Angiosperm 1.0965123       MED
14         Fabales Herbaceous perennial Angiosperm 1.9158723       MED
15         Fabales Herbaceous perennial Angiosperm 1.0510285       TBM
16         Fabales Herbaceous perennial Angiosperm 1.0111035       DES
17         Fabales Herbaceous perennial Angiosperm 0.9262035       DES
18         Fabales Herbaceous perennial Angiosperm 0.9799277       TCF
19      Sapindales                 Tree Angiosperm 0.9956000       TMB
20      Sapindales                 Tree Angiosperm 0.9644052       TBM
21     Brassicales Herbaceous perennial Angiosperm 1.0239866       TBM
22     Brassicales Herbaceous perennial Angiosperm 1.4037297       TBM
23     Brassicales Herbaceous perennial Angiosperm 0.7869247       TBM
24     Brassicales Herbaceous perennial Angiosperm 1.0359177       TBM
25     Brassicales Herbaceous perennial Angiosperm 0.9716492       TBM
26     Brassicales Herbaceous perennial Angiosperm 1.3648033       TBM
27        Malvales Herbaceous perennial Angiosperm 0.7611410       TGS
28        Malvales Herbaceous perennial Angiosperm 0.9308673       MED
29        Malvales Herbaceous perennial Angiosperm 1.5407796       MED
30      Geraniales Herbaceous perennial Angiosperm 0.9575419       MED
31      Geraniales Herbaceous perennial Angiosperm 1.0879999       MED
32        Myrtales Herbaceous perennial Angiosperm 0.8553326       DES
33    Saxifragales               Annual Angiosperm 1.8316693       TBM
34        Lamiales Herbaceous perennial Angiosperm 0.5322755       MED
35        Lamiales Herbaceous perennial Angiosperm 1.1257721       TBM
36        Lamiales Herbaceous perennial Angiosperm 1.7314892       TBM
37        Lamiales Herbaceous perennial Angiosperm 0.9656341       TBM
38        Lamiales Herbaceous perennial Angiosperm 0.9791057       TBM
39        Lamiales Herbaceous perennial Angiosperm 1.0326716       MED
40        Lamiales Herbaceous perennial Angiosperm 0.9677607       MED
41        Lamiales               Annual Angiosperm 1.6732773       TBM
42     Gentianales Herbaceous perennial Angiosperm 1.1326931       TBM
43       Asterales Herbaceous perennial Angiosperm 1.1230529       TBM
44       Asterales Herbaceous perennial Angiosperm 0.6215339       TGS
45       Asterales Herbaceous perennial Angiosperm 0.9919496       TGS
46       Asterales Herbaceous perennial Angiosperm 1.0365163       TGS
47       Asterales Herbaceous perennial Angiosperm 1.1283010       TGS
48       Asterales Herbaceous perennial Angiosperm 1.3243933       TGS
49       Asterales Herbaceous perennial Angiosperm 1.1443488       TCF
50       Asterales Herbaceous perennial Angiosperm 1.8015241       TGS
51       Asterales Herbaceous perennial Angiosperm 1.2362850       FGS
52       Asterales Herbaceous perennial Angiosperm 1.0875591       TBM
53       Asterales Herbaceous perennial Angiosperm 1.0558414       TBM
54       Asterales Herbaceous perennial Angiosperm 1.4936542       TBM
55       Asterales Herbaceous perennial Angiosperm 0.9146098       TGS
56       Asterales Herbaceous perennial Angiosperm 1.0535111       TGS
57       Asterales Herbaceous perennial Angiosperm 1.1119058       TGS
58       Asterales Herbaceous perennial Angiosperm 0.6170490       MED
59       Asterales Herbaceous perennial Angiosperm 0.7721355       TBM
60       Asterales Herbaceous perennial Angiosperm 0.8874202       TBM
61       Asterales Herbaceous perennial Angiosperm 0.9634498       MED
62         Apiales Herbaceous perennial Angiosperm 0.7839479       TBM
63         Apiales Herbaceous perennial Angiosperm 0.9832736       TBM
64      Dipsacales Herbaceous perennial Angiosperm 1.2656266       TBM
65      Dipsacales Herbaceous perennial Angiosperm 1.4304409       TBM
66      Dipsacales Herbaceous perennial Angiosperm 1.2955549       TBM
67      Dipsacales Herbaceous perennial Angiosperm 0.7613167       TBM
68        Ericales                Shrub Angiosperm 1.3372438       TMB
69        Ericales               Annual Angiosperm 0.6744272       TBM
70        Ericales Herbaceous perennial Angiosperm 1.1426327       TBM
71        Ericales Herbaceous perennial Angiosperm 0.8550317       TBM
72        Ericales Herbaceous perennial Angiosperm 1.0551724       TBM
73        Ericales Herbaceous perennial Angiosperm 0.8672650       TBM
74        Ericales Herbaceous perennial Angiosperm 0.9802187       TBM
75        Ericales Herbaceous perennial Angiosperm 0.8083969       TBM
76        Ericales Herbaceous perennial Angiosperm 1.0164304       BOR
77  Caryophyllales Herbaceous perennial Angiosperm 0.6241799       TGS
78  Caryophyllales                Shrub Angiosperm 1.7211020       DES
79  Caryophyllales            Succulent Angiosperm 1.0001012       TSC
80  Caryophyllales            Succulent Angiosperm 1.0001012       DES
81  Caryophyllales            Succulent Angiosperm 1.0448792       DES
82  Caryophyllales            Succulent Angiosperm 0.8096500       TGV
83  Caryophyllales            Succulent Angiosperm 1.2437146       DES
84  Caryophyllales            Succulent Angiosperm 0.7717743       DES
85  Caryophyllales            Succulent Angiosperm 0.8536424       DES
86  Caryophyllales            Succulent Angiosperm 0.9123507       DES
87  Caryophyllales            Succulent Angiosperm 1.0675543       DES
88  Caryophyllales Herbaceous perennial Angiosperm 0.6939522       TBM
89  Caryophyllales Herbaceous perennial Angiosperm 1.1056787       MED
90  Caryophyllales Herbaceous perennial Angiosperm 0.8622434       MED
91    Ranunculales Herbaceous perennial Angiosperm 0.6678511       TBM
92    Ranunculales Herbaceous perennial Angiosperm 1.0111375       TBM
93    Ranunculales Herbaceous perennial Angiosperm 0.9799315       TBM
94    Ranunculales Herbaceous perennial Angiosperm 1.0953694       TBM
95    Ranunculales Herbaceous perennial Angiosperm 1.0512885       TBM
96    Ranunculales Herbaceous perennial Angiosperm 1.1280523       TBM
97        Arecales                 Palm Angiosperm 1.1669544       TSC
98        Arecales                 Palm Angiosperm 1.1789035       MED
99        Arecales                 Palm Angiosperm 1.0295980       TGV
100         Poales Herbaceous perennial Angiosperm 0.9987145       TCF
101         Poales Herbaceous perennial Angiosperm 0.5545652       MON
102         Poales Herbaceous perennial Angiosperm 1.0100578       TCF
103         Poales Herbaceous perennial Angiosperm 1.7385142       DES
104         Poales             Epiphyte Angiosperm 1.0615691       TSC
105    Asparagales Herbaceous perennial Angiosperm 0.9831117       TBM
106    Asparagales Herbaceous perennial Angiosperm 1.0643108       TCF
107    Asparagales Herbaceous perennial Angiosperm 1.0191296       TCF
108    Asparagales Herbaceous perennial Angiosperm 1.0732602       TCF
109    Asparagales Herbaceous perennial Angiosperm 1.1331204       TBM
110       Liliales Herbaceous perennial Angiosperm 1.0406040       TBM
111       Liliales Herbaceous perennial Angiosperm 1.0022867       TBM
112       Liliales Herbaceous perennial Angiosperm 0.9735535       TBM
113       Liliales Herbaceous perennial Angiosperm 0.9536967       TBM
114       Liliales Herbaceous perennial Angiosperm 1.0089756       TBM
115       Liliales Herbaceous perennial Angiosperm 0.9905149       TBM
116       Liliales Herbaceous perennial Angiosperm 0.9847658       TBM
117       Liliales Herbaceous perennial Angiosperm 1.0981481       TBM
118       Liliales Herbaceous perennial Angiosperm 0.9909749       TBM
119       Liliales Herbaceous perennial Angiosperm 1.0226717       TGS
120      Piperales Herbaceous perennial Angiosperm 1.0447722       TBM
121        Pinales                 Tree Gymnosperm 1.0184607       TBM
                       Binomial                       phylo
1        Euphorbia_fontqueriana      Euphorbia_fontqueriana
2          Hypericum_cumulicola        Hypericum_cumulicola
3           Agrimonia_eupatoria         Agrimonia_eupatoria
4            Purshia_subintegra          Purshia_subintegra
5                Cucurbita_pepo              Cucurbita_pepo
6              Castanea_dentata            Castanea_dentata
7              Castanea_dentata            Castanea_dentata
8              Castanea_dentata            Castanea_dentata
9              Castanea_dentata            Castanea_dentata
10             Castanea_dentata            Castanea_dentata
11        Astragalus_scaphoides       Astragalus_scaphoides
12        Astragalus_alopecurus       Astragalus_alopecurus
13      Astragalus_tremolsianus     Astragalus_tremolsianus
14         Dorycnium_spectabile        Dorycnium_spectabile
15         Anthyllis_vulneraria        Anthyllis_vulneraria
16          Lupinus_tidestromii         Lupinus_tidestromii
17          Lupinus_tidestromii         Lupinus_tidestromii
18              Lupinus_lepidus             Lupinus_lepidus
19            Carapa_guianensis           Carapa_guianensis
20               Acer_saccharum              Acer_saccharum
21           Alliaria_petiolata          Alliaria_petiolata
22           Alliaria_petiolata          Alliaria_petiolata
23           Alliaria_petiolata          Alliaria_petiolata
24           Alliaria_petiolata          Alliaria_petiolata
25           Alliaria_petiolata          Alliaria_petiolata
26           Alliaria_petiolata          Alliaria_petiolata
27         Sphaeralcea_coccinea        Sphaeralcea_coccinea
28    Helianthemum_polygonoides   Helianthemum_polygonoides
29      Helianthemum_teneriffae     Helianthemum_teneriffae
30           Erodium_paularense          Erodium_paularense
31           Erodium_paularense          Erodium_paularense
32          Oenothera_deltoides         Oenothera_deltoides
33      Saxifraga_tridactylites     Saxifraga_tridactylites
34           Plantago_coronopus          Plantago_coronopus
35           Plantago_coronopus          Plantago_coronopus
36           Plantago_coronopus          Plantago_coronopus
37     Dracocephalum_austriacum    Dracocephalum_austriacum
38     Dracocephalum_austriacum    Dracocephalum_austriacum
39               Ramonda_myconi              Ramonda_myconi
40               Ramonda_myconi              Ramonda_myconi
41         Myosotis_ramosissima        Myosotis_ramosissima
42        Gentiana_pneumonanthe       Gentiana_pneumonanthe
43         Hypochaeris_radicata        Hypochaeris_radicata
44       Echinacea_angustifolia      Echinacea_angustifolia
45       Echinacea_angustifolia      Echinacea_angustifolia
46       Echinacea_angustifolia      Echinacea_angustifolia
47         Ratibida_columnifera        Ratibida_columnifera
48             Liatris_scariosa            Liatris_scariosa
49             Artemisia_genipi            Artemisia_genipi
50              Solidago_mollis             Solidago_mollis
51             Cirsium_palustre            Cirsium_palustre
52            Cirsium_dissectum           Cirsium_dissectum
53            Cirsium_dissectum           Cirsium_dissectum
54            Cirsium_dissectum           Cirsium_dissectum
55             Cirsium_pitcheri            Cirsium_pitcheri
56             Cirsium_pitcheri            Cirsium_pitcheri
57            Cirsium_undulatum           Cirsium_undulatum
58            Jurinea_fontqueri           Jurinea_fontqueri
59              Centaurea_jacea             Centaurea_jacea
60              Centaurea_jacea             Centaurea_jacea
61     Cheirolophus_metlesicsii    Cheirolophus_metlesicsii
62                  Carum_carvi                 Carum_carvi
63                  Carum_carvi                 Carum_carvi
64            Succisa_pratensis           Succisa_pratensis
65            Succisa_pratensis           Succisa_pratensis
66            Succisa_pratensis           Succisa_pratensis
67            Succisa_pratensis           Succisa_pratensis
68       Ardisia_escallonioides      Ardisia_escallonioides
69           Androsace_elongata          Androsace_elongata
70             Primula_farinosa            Primula_farinosa
71                Primula_veris               Primula_veris
72              Primula_elatior             Primula_elatior
73             Primula_vulgaris            Primula_vulgaris
74             Primula_vulgaris            Primula_vulgaris
75             Primula_vulgaris            Primula_vulgaris
76          Sarracenia_purpurea         Sarracenia_purpurea
77           Paronychia_jamesii          Paronychia_jamesii
78           Atriplex_canescens          Atriplex_canescens
79    Neobuxbaumia_mezcalaensis   Neobuxbaumia_mezcalaensis
80    Neobuxbaumia_mezcalaensis   Neobuxbaumia_mezcalaensis
81    Neobuxbaumia_macrocephala   Neobuxbaumia_macrocephala
82  Mammillaria_huitzilopochtli Mammillaria_huitzilopochtli
83  Mammillaria_huitzilopochtli Mammillaria_huitzilopochtli
84      Mammillaria_solisioides     Mammillaria_solisioides
85        Ariocarpus_fissuratus       Ariocarpus_fissuratus
86        Ariocarpus_fissuratus       Ariocarpus_fissuratus
87        Escobaria_robbinsorum       Escobaria_robbinsorum
88              Rumex_rupestris             Rumex_rupestris
89           Armeria_caespitosa          Armeria_caespitosa
90             Limonium_erectum            Limonium_erectum
91          Ranunculus_peltatus         Ranunculus_peltatus
92               Actaea_spicata              Actaea_spicata
93               Actaea_spicata              Actaea_spicata
94          Dicentra_canadensis         Dicentra_canadensis
95          Dicentra_canadensis         Dicentra_canadensis
96          Dicentra_canadensis         Dicentra_canadensis
97          Chamaedorea_elegans         Chamaedorea_elegans
98        Chamaedorea_radicalis       Chamaedorea_radicalis
99           Borassus_aethiopum          Borassus_aethiopum
100                  Poa_alpina                  Poa_alpina
101           Zea_diploperennis           Zea_diploperennis
102           Danthonia_sericea           Danthonia_sericea
103              Hilaria_mutica              Hilaria_mutica
104           Catopsis_compacta           Catopsis_compacta
105             Orchis_purpurea             Orchis_purpurea
106    Cypripedium_fasciculatum    Cypripedium_fasciculatum
107    Cypripedium_fasciculatum    Cypripedium_fasciculatum
108    Cypripedium_fasciculatum    Cypripedium_fasciculatum
109            Allium_tricoccum            Allium_tricoccum
110       Trillium_grandiflorum       Trillium_grandiflorum
111       Trillium_grandiflorum       Trillium_grandiflorum
112       Trillium_grandiflorum       Trillium_grandiflorum
113       Trillium_grandiflorum       Trillium_grandiflorum
114       Trillium_grandiflorum       Trillium_grandiflorum
115       Trillium_grandiflorum       Trillium_grandiflorum
116       Trillium_grandiflorum       Trillium_grandiflorum
117       Trillium_grandiflorum       Trillium_grandiflorum
118       Trillium_grandiflorum       Trillium_grandiflorum
119         Calochortus_lyallii         Calochortus_lyallii
120            Asarum_canadense            Asarum_canadense
121               Pinus_strobus               Pinus_strobus</code></pre>
</div>
</div>
<!-- remember rmarkdown cells don't run automatically! -->
</section>
<section id="selecting-the-best-model" class="level2">
<h2 class="anchored" data-anchor-id="selecting-the-best-model">9.2. Selecting the best model</h2>
<!--AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA-->
</section>
<section id="determine-the-fixed-effect-of-all-models-and-response-variables" class="level2">
<h2 class="anchored" data-anchor-id="determine-the-fixed-effect-of-all-models-and-response-variables">9.3. Determine the fixed effect of all models and response variables</h2>
<p>Because we run multiple models representing the combination of several attributes (vital rates, ex. survival and reproduction) for the same fixed model, each element below is important to automatize the process. With each element created separated we can run a loop with a generic model where <code>model(variable ~ fixEffect)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determines the fixed effect component</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>fixEffect<span class="ot">&lt;-</span>fixEffect<span class="ot">&lt;-</span><span class="st">"~LHPC.1 * LHPC.2 + ClimPC.1 * ClimPC.2 * ClimPC.3"</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Determines all variables of interest to make multiple models</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>InterestingVars<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Survival"</span>,<span class="st">"Growth"</span>,<span class="st">"Shrinking"</span>,<span class="st">"Reproduction"</span>,<span class="st">"Clonality"</span>,<span class="st">"Buffmx"</span>,<span class="st">"Cumulative"</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">&lt;-</span>traits_glmm<span class="ot">&lt;-</span> <span class="fu">unique</span> (<span class="fu">grep</span>(<span class="fu">paste</span>(InterestingVars,<span class="at">collapse=</span><span class="st">"|"</span>), </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">colnames</span>(data_model), <span class="at">value=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="optimizing-glmm-models" class="level2">
<h2 class="anchored" data-anchor-id="optimizing-glmm-models">9.4. OPTIMIZING GLMM MODELS</h2>
<p>Because we run several models with and without phylogenetic correction it take a long time to run in a in-house computer. Moreover, a long script was created <code>5b - MCMCglmm run.R</code>. Thus, to accelerate the model performance and save time we also created a jupyter notebook integrated with Google Collab <code>5b - MCMCglmm run.ipynb</code>.</p>
<p>Most importantly, a partial output was created with the GLMM models in <code>Data/MCMCglmm_output.rds</code>.</p>
<p>Next steps use this partial output to keep running the analyses.</p>
<!-- Talvez seja interessante eu revisar a numeração desses scripts! Por exemplo, script 5 MCMCglmm run parece ser uma péssima opção e grande fonte de confusão no futuro! -->
</section>
</section>
<section id="buffering-paterns" class="level1">
<h1>10. Buffering paterns</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>final_data_meta<span class="ot">&lt;-</span>final_data<span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,MetadataClean<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span>lambda)<span class="sc">%&gt;%</span><span class="fu">distinct</span>(),<span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>final_data_meta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               ID Reproduction_SigElas Growth_SigElas Shrinking_SigElas
1    Ephr.267_629        -3.746532e-04  -7.572104e-04      3.269931e-05
2    Hypr.463_756        -6.467530e-02  -4.189061e-03     -1.993659e-03
3     Agrm.300_46         2.274530e-05  -2.648489e-03      5.880106e-05
4   Prsh.362_1204         3.710245e-05   6.848113e-03     -7.212616e-04
5    Ccrb.457_472         2.780779e-01  -4.533997e-04      0.000000e+00
6    Cstn.134_322         9.410967e-07  -3.264915e-04      2.075794e-05
7    Cstn.134_326        -1.011935e-07  -7.387550e-04      2.398223e-05
8    Cstn.134_325         1.007925e-07  -1.305185e-04      2.980198e-05
9    Cstn.134_324        -7.655142e-07  -3.928064e-05      3.473416e-05
10   Cstn.134_323        -1.846865e-06  -2.030624e-03      9.826631e-05
11   Astr.326_189        -1.301715e-02   5.216766e-03     -1.370287e-02
12   Astr.409_177         1.176005e-02   2.087632e-03      0.000000e+00
13   Astr.267_196         1.278097e-04  -4.118595e-03      3.892633e-05
14   Dryc.267_540         3.067388e-02   8.848441e-03      0.000000e+00
15   Ant..355_100         1.908372e-04  -1.420634e-04      1.226419e-03
16   Lpns.132_902         1.058989e-03  -1.189091e-02      2.629081e-03
17   Lpns.132_901         1.124107e-03  -6.153192e-03      3.406878e-03
18    Lpn..55_899        -4.611941e-02   3.033784e-02      9.327366e-04
19   Crp2.123_294        -7.193321e-07   2.644265e-04      0.000000e+00
20    Acrs.330_19        -1.942699e-03  -3.815111e-03      0.000000e+00
21    All4.185_58         9.441758e-02  -1.129481e-03      0.000000e+00
22    All4.185_56         9.409866e-02  -2.513995e-03      0.000000e+00
23    All4.185_62         3.897842e-02  -3.568100e-04      0.000000e+00
24    All4.185_55         1.651605e-01  -9.997637e-03      0.000000e+00
25    All4.185_59         1.699247e-01  -4.329829e-03      0.000000e+00
26    All4.185_65         1.461733e-01  -9.709006e-03      0.000000e+00
27  Sphr.129_1358        -2.104041e-01   0.000000e+00      0.000000e+00
28   Hlnt.267_711        -2.335690e-03  -1.148483e-02      1.611358e-03
29   Hlnt.267_712        -3.580157e-03  -3.124747e-02      8.387555e-04
30   Erdm.267_599        -2.754661e-05  -1.082883e-03     -1.066889e-04
31   Erdm.267_598         2.808797e-05   4.280003e-04     -6.524920e-05
32  Ont..575_1014        -3.797247e-02  -2.640438e-04     -1.654824e-06
33  Sxfr.152_1302         4.350709e-01   0.000000e+00     -1.068240e-01
34  Pln2.608_1122         2.861199e-03  -6.155718e-02      1.189334e-03
35  Pln2.608_1124        -1.185861e-02  -2.086196e-02      1.059105e-03
36  Pln2.608_1129        -6.571590e-03  -9.694594e-04      2.344591e-03
37   Drc2.151_550        -5.514313e-05   1.598278e-03     -1.286515e-04
38   Drc2.151_549         4.792627e-05  -1.991213e-03     -1.105230e-04
39  Rmnd.445_1217        -3.507665e-06   2.483465e-05     -8.568739e-06
40  Rmnd.445_1214         5.069338e-05  -1.280223e-02      5.437151e-04
41   Myst.152_983         6.352450e-01   0.000000e+00      2.104031e-03
42   Gntn.423_679         5.785807e-04  -3.895910e-03      9.044300e-04
43   Hypc.282_759         1.857057e-04  -8.573868e-04      1.252851e-02
44   Echn.129_555        -4.556823e-02   0.000000e+00      0.000000e+00
45   Ech2.263_557        -3.341240e-04  -2.446895e-04      1.211224e-06
46   Ech2.263_556         5.442867e-05   3.648008e-04     -9.845581e-05
47  Rtbd.129_1225        -6.581060e-01   0.000000e+00      0.000000e+00
48   Ltrs.166_862        -5.985893e-03   3.201929e-02      3.136667e-03
49   Artm.355_146        -3.480291e-05   1.380049e-05      1.180574e-03
50  Sldg.129_1354        -1.270544e-01   0.000000e+00      0.000000e+00
51   Crsm.474_389        -8.065638e-03  -1.568766e-02      0.000000e+00
52   Crsm.283_383         1.540169e-04  -1.194387e-04     -1.143753e-04
53   Crsm.283_384         3.489597e-04  -2.180634e-04      5.892436e-05
54   Crsm.283_386         5.062695e-04   6.639794e-03      1.117036e-02
55    Crs3.41_395         8.653618e-02   3.700410e-03      7.132525e-05
56   Crs5.166_400         8.155830e-02   7.619270e-04      1.274713e-04
57   Crsm.129_409        -2.326958e-02   0.000000e+00      0.000000e+00
58   Jrnf.267_786        -4.216837e-03  -1.427212e-04      1.230737e-04
59   Cntr.282_346         4.987168e-02  -4.278258e-03     -1.530113e-03
60   Cntr.282_347         2.742320e-02   3.520732e-03     -1.055724e-03
61   Chrl.267_374        -6.069221e-03  -1.206062e-03      0.000000e+00
62   Crmc.301_320         5.571422e-02  -1.885842e-03      7.835922e-04
63   Crmc.301_319         4.989620e-02  -8.745159e-03     -1.267489e-04
64  Sccs.282_1371        -2.506157e-04   1.272455e-03      1.058512e-03
65  Sccs.282_1370         5.875971e-04   3.624779e-04     -5.457551e-04
66  Sccs.282_1368        -6.744761e-05   1.534331e-03     -1.068427e-03
67  Scc3.381_1377         6.927251e-04   1.134496e-02      2.694870e-04
68   Ards.431_127        -2.818867e-04  -9.146217e-03      3.799730e-05
69    Andr.152_83         3.514658e-01   0.000000e+00     -3.849840e-02
70  Prm4.582_1157        -1.383515e-01   4.312519e-02      1.416895e-02
71   Prm5.73_1164        -7.772986e-06   1.600067e-03      1.700682e-03
72  Prml.272_1153         8.362892e-06  -7.918209e-04     -1.459930e-04
73  Prml.596_1165         3.602506e-04   1.076073e-02      1.101186e-03
74  Prm2.170_1169        -1.327601e-02   7.679306e-04      5.229724e-04
75  Prm3.591_1170        -4.455454e-04   2.412247e-03      3.129632e-04
76  Srr2.571_1298        -1.243162e-05   1.833618e-04      5.677130e-07
77  Prny.129_1065        -1.238293e-01   0.000000e+00      0.000000e+00
78   Atrp.603_217         2.355208e-04  -9.955307e-02      6.960505e-04
79   Nbxb.182_991         6.478582e-05   1.096793e-03     -2.204655e-05
80   Nbx2.183_992         6.889012e-05   1.764007e-03     -2.011543e-05
81   Nbx3.183_990        -4.282122e-06  -1.080990e-04     -8.074914e-05
82   Mmml.193_925        -1.337765e-06   7.099273e-04      1.307458e-03
83   Mmm2.194_928        -3.284005e-04   4.792671e-03      1.384336e-04
84   Mmml.490_935        -1.374624e-03   3.370801e-04      1.961760e-05
85   Arcr.350_132        -1.682590e-05   9.715924e-04      1.293279e-05
86   Arcr.350_131        -4.309725e-06  -4.129180e-04      3.501265e-04
87   Cryp.511_463        -9.527210e-06  -1.126878e-03      0.000000e+00
88  Rmxr.267_1261         1.198250e-04   1.785600e-03     -3.525705e-04
89   Armr.208_139        -2.174559e-03  -2.217982e-03     -7.709862e-05
90   Lmnm.267_871        -6.700071e-03   2.738740e-03     -6.570648e-04
91  Rnnc.266_1222        -4.509389e-02  -2.512034e-02      1.903172e-03
92    Acts.204_27        -7.254452e-05   2.080658e-03      4.607404e-04
93    Acts.204_28        -6.588281e-05   9.105740e-04     -2.351034e-04
94   Dcnt.331_511        -3.774857e-05  -1.493787e-04     -2.862153e-06
95   Dcnt.331_510         1.842111e-04   1.161441e-03     -1.939162e-04
96   Dcnt.331_509        -4.033717e-04   1.411501e-03      4.228909e-04
97   Chmd.594_367        -3.817657e-04   4.294244e-05      0.000000e+00
98   Chmd.172_368         3.176458e-04   2.708267e-03      1.582705e-03
99    Brss.36_238        -9.842322e-06   6.164722e-05      4.547185e-06
100 Plpn.355_1136        -9.921824e-05   2.448080e-03      2.793806e-04
101 Zdpl.500_1534        -1.057153e-04   1.343679e-02      9.896167e-04
102  Dnth.384_499        -3.826597e-03   1.996066e-03      2.438940e-03
103  Hlrm.601_725        -1.551924e-03  -2.504789e-02      1.198529e-03
104  Ctps.143_328        -8.939245e-03   3.979938e-04     -4.361848e-04
105 Orch.273_1029        -1.479776e-04   3.981909e-04      8.641597e-04
106  Cypr.576_483        -9.207344e-05   4.108961e-04     -3.307495e-04
107  Cypr.576_482        -1.186338e-04   2.274123e-03      1.937584e-03
108  Cypr.576_484        -4.596083e-05  -1.137449e-04     -5.377853e-04
109   Allm.402_69         2.766143e-03  -1.017325e-03      1.863293e-04
110 Trll.304_1438         0.000000e+00  -9.770756e-05      1.595867e-05
111 Trll.304_1442         0.000000e+00   7.217425e-04     -7.271393e-06
112 Trll.304_1446         0.000000e+00   6.397791e-04     -4.955547e-05
113 Trll.304_1443         0.000000e+00   1.018407e-04     -1.959553e-04
114 Trll.304_1437         0.000000e+00  -5.688097e-04     -1.698155e-04
115 Trll.304_1435         0.000000e+00   2.265819e-05      0.000000e+00
116 Trll.304_1439         0.000000e+00   2.564256e-04      2.294640e-05
117 Trll.304_1441         0.000000e+00  -1.568601e-03      3.146574e-07
118 Trll.304_1444         0.000000e+00   3.708480e-04      3.718267e-05
119  Clch.382_287        -4.962345e-04   6.965824e-04      3.703569e-04
120  Asrm.131_148        -6.751073e-03   1.041108e-03      0.000000e+00
121 Pnss.391_1116         8.702378e-06   1.773344e-04      0.000000e+00
    Clonality_SigElas Survival_SigElas Cumulative_SigElas Reproduction_Base
1        0.000000e+00    -1.492507e-03      -0.0025916716      0.0208575272
2        0.000000e+00    -1.199857e-01      -0.1908436699      0.1574231567
3        0.000000e+00    -6.514767e-03      -0.0090817103      0.0187942564
4        0.000000e+00     6.431885e-02       0.0704828041      0.0100989031
5        0.000000e+00    -7.402989e-04       0.2768842385      0.0000000000
6        0.000000e+00    -3.302788e-04      -0.0006350713      0.0042349408
7        0.000000e+00    -1.278424e-03      -0.0019932976      0.0046392387
8        0.000000e+00    -4.386394e-04      -0.0005392551      0.0011490011
9        0.000000e+00    -2.161637e-04      -0.0002214757      0.0051360454
10       0.000000e+00    -2.491582e-03      -0.0044257874      0.0062306310
11       0.000000e+00    -1.907617e-02      -0.0405794188      0.1590745115
12       0.000000e+00     4.929481e-02       0.0631424979      0.0584920277
13       0.000000e+00    -1.147877e-04      -0.0040666465      0.0319563555
14       0.000000e+00     1.209782e-01       0.1605005273      0.0741727391
15       0.000000e+00    -6.002037e-03      -0.0047268433      0.0405977458
16       0.000000e+00    -1.122510e-03      -0.0093253474      0.0829108661
17       0.000000e+00    -7.458346e-03      -0.0090805532      0.0770128960
18       0.000000e+00    -1.087097e-01      -0.1235585541      0.3257759679
19       0.000000e+00     1.196359e-03       0.0014600660      0.0052306828
20       0.000000e+00    -8.748851e-03      -0.0145066615      0.0516656630
21       0.000000e+00    -5.179131e-03       0.0881089646      0.0000000000
22       0.000000e+00     3.004808e-03       0.0945894720      0.0000000000
23       0.000000e+00    -9.294972e-03       0.0293266359      0.0000000000
24       0.000000e+00    -3.394509e-02       0.1212177982      0.0000000000
25       0.000000e+00     3.813056e-02       0.2037254736      0.0000000000
26       0.000000e+00    -9.146317e-02       0.0450010817      0.0000000000
27       0.000000e+00    -4.226229e-01      -0.6330270154      0.6677830504
28       0.000000e+00    -1.087410e-02      -0.0230832569      0.0530603772
29       0.000000e+00    -7.192719e-02      -0.1059160671      0.1254696234
30       0.000000e+00    -9.970538e-04      -0.0022141725      0.0098806075
31       0.000000e+00    -1.383320e-03      -0.0009924813      0.0131953830
32       0.000000e+00    -6.886427e-02      -0.1071024312      0.0782870048
33       0.000000e+00    -1.145268e-01       0.2137200951      0.0000000000
34       0.000000e+00    -1.296219e-01      -0.1871285211      0.1806201390
35       0.000000e+00    -6.666257e-02      -0.0983240409      0.1784938543
36       0.000000e+00    -4.696490e-02      -0.0521613555      0.1371370729
37       0.000000e+00     6.214475e-03       0.0076289579      0.0146967690
38       0.000000e+00    -2.006373e-03      -0.0040601833      0.0257270307
39       0.000000e+00     8.781801e-05       0.0001005763      0.0183693660
40       0.000000e+00    -2.205962e-02      -0.0342674372      0.0109517287
41       0.000000e+00    -2.059389e-03       0.6352896581      0.0000000000
42       0.000000e+00    -8.605643e-03      -0.0110185425      0.0591399887
43       9.106199e-04    -1.086539e-02       0.0019020587      0.0601162813
44       0.000000e+00    -1.124150e-01      -0.1579832558      0.3886782543
45       0.000000e+00    -4.998179e-04      -0.0010774201      0.0180489979
46       0.000000e+00     4.976895e-04       0.0008184631      0.0272615749
47       0.000000e+00    -1.355710e+00      -2.0138158723      1.1375038324
48       0.000000e+00     1.216314e-02       0.0413332040      0.0840052449
49       0.000000e+00    -2.632782e-03      -0.0014732110      0.0381488743
50       0.000000e+00    -2.734569e-01      -0.4005113269      0.6514233962
51       0.000000e+00    -3.054799e-02      -0.0543012894      0.1280766816
52       1.807953e-01    -8.720921e-03       0.1719946290      0.0000000000
53       7.802471e-02    -4.518761e-03       0.0736957665      0.0000000000
54       2.395295e-01    -1.696512e-01       0.0881946579      0.0000000000
55       0.000000e+00     8.134306e-03       0.0984422249      0.0000000000
56       0.000000e+00    -9.336925e-04       0.0815140053      0.0000000000
57       0.000000e+00    -4.756358e-02      -0.0708331612      0.4547379525
58       0.000000e+00    -2.828022e-02      -0.0325167026      0.1146798428
59       2.626497e-01    -2.402223e-02       0.2826907289      0.0000000000
60       4.262420e-01    -7.199570e-02       0.3841345465      0.0000000000
61       0.000000e+00    -1.375033e-02      -0.0210256103      0.1066981183
62       0.000000e+00    -8.400276e-03       0.0462116981      0.0000000000
63       0.000000e+00    -4.276458e-03       0.0367478326      0.0000000000
64       8.462191e-04     1.191313e-03       0.0041178833      0.0442656069
65       2.201031e-05     1.613227e-03       0.0020395569      0.0588650721
66       1.797835e-04     1.966254e-03       0.0025444941      0.0547330460
67       0.000000e+00     4.990288e-02       0.0622100563      0.0406600099
68       0.000000e+00     1.951426e-02       0.0101241581      0.0484153522
69       0.000000e+00    -9.305599e-02       0.2199114054      0.0000000000
70       0.000000e+00    -2.185634e-01      -0.2996207857      0.2723426030
71       0.000000e+00    -7.504536e-03      -0.0042115602      0.0480514082
72       0.000000e+00    -2.314389e-03      -0.0032438397      0.0326831824
73       0.000000e+00    -4.275384e-02      -0.0305316733      0.0302341211
74       0.000000e+00    -1.809123e-02      -0.0300763392      0.0686846184
75       0.000000e+00    -5.575161e-05       0.0022239136      0.0460930633
76       0.000000e+00     2.331020e-04       0.0004045999      0.0206966824
77       0.000000e+00    -2.811162e-01      -0.4049455351      0.5248679129
78       0.000000e+00    -1.367290e-01      -0.2353505230      0.0278021143
79       0.000000e+00     1.594839e-03       0.0027343721      0.0060150092
80       0.000000e+00    -3.172368e-03      -0.0013595864      0.0065561255
81       0.000000e+00     8.680372e-04       0.0006749069      0.0116839089
82       0.000000e+00    -8.349851e-05       0.0019325491      0.0001958907
83       0.000000e+00     8.959835e-03       0.0135625394      0.0663375594
84       0.000000e+00    -3.171483e-03      -0.0041894093      0.0170813096
85       0.000000e+00     2.693891e-03       0.0036615905      0.0056779808
86       0.000000e+00    -3.169151e-02      -0.0317586117      0.0028227417
87       0.000000e+00    -1.048319e-03      -0.0021847250      0.0256800228
88       0.000000e+00    -1.200429e-02      -0.0104514359      0.0195919196
89       0.000000e+00    -5.819248e-03      -0.0102888869      0.0643206097
90       0.000000e+00    -4.083153e-03      -0.0087015483      0.0805434729
91       0.000000e+00    -1.307869e-01      -0.1990979463      0.2774854882
92       0.000000e+00     5.421641e-03       0.0078904944      0.0278940086
93       0.000000e+00     5.401356e-03       0.0060109438      0.0157481089
94      -7.275529e-05    -1.323052e-05      -0.0002759752      0.0035427636
95       2.233719e-04    -9.700826e-06       0.0013654069      0.0102294121
96       3.039467e-04     6.954876e-04       0.0024304547      0.0205109477
97      -2.120882e-05    -2.245672e-04      -0.0005845992      0.0232502019
98       0.000000e+00    -3.716247e-04       0.0042369927      0.0271430776
99       0.000000e+00     4.172605e-04       0.0004736126      0.0098350576
100      1.265238e-04     4.250371e-03       0.0070051368      0.0118699596
101      0.000000e+00     7.758207e-03       0.0220788988      0.0343599847
102      0.000000e+00    -3.591053e-02      -0.0353021194      0.0546882635
103      0.000000e+00    -8.005753e-02      -0.1054588184      0.0658793777
104      0.000000e+00    -1.272564e-02      -0.0217030794      0.0454652527
105      0.000000e+00    -5.077108e-03      -0.0039627351      0.0198246100
106      0.000000e+00    -1.337868e-03      -0.0013497951      0.0279596217
107      0.000000e+00    -1.334057e-04       0.0039596679      0.0260059423
108      0.000000e+00    -2.273735e-03      -0.0029712256      0.0257139012
109      2.708920e-01    -2.358525e-03       0.2704686714      0.0000000000
110      0.000000e+00    -1.731355e-03      -0.0018131038      0.0076042551
111      0.000000e+00    -1.970706e-04       0.0005174006      0.0131320524
112      0.000000e+00     1.151916e-03       0.0017421393      0.0016302185
113      0.000000e+00    -8.259829e-04      -0.0009200976      0.0075877066
114      0.000000e+00    -7.087578e-04      -0.0014473830      0.0181232486
115      0.000000e+00    -5.200273e-04      -0.0004973691      0.0080675020
116      0.000000e+00    -4.206070e-04      -0.0001412349      0.0088870471
117      0.000000e+00    -4.055232e-03      -0.0056235191      0.0209670439
118      0.000000e+00     3.065281e-05       0.0004386835      0.0062736872
119      0.000000e+00    -1.646235e-03      -0.0010755302      0.0298040064
120     -1.010784e-03    -2.229265e-02      -0.0290133976      0.0516794999
121      0.000000e+00     9.126873e-04       0.0010987241      0.0044381842
     Growth_Base Shrinking_Base Clonality_Base Survival_Base Cumulative_Base
1    0.017781476  -0.0040658388    0.000000000    1.03620846       1.0707816
2    0.291021640  -0.0235077738    0.000000000    1.22124002       1.6461770
3    0.046532915  -0.0252377704    0.000000000    0.99849590       1.0385853
4    0.123153808  -0.1211425363    0.000000000    2.22153669       2.2336469
5    0.227465719   0.0000000000    0.000000000    0.31028144       0.5377472
6    0.022956031  -0.0169400089    0.000000000    1.01244470       1.0226957
7    0.024670040  -0.0066842007    0.000000000    0.98314050       1.0057656
8    0.021885167  -0.0459680732    0.000000000    1.04099839       1.0180645
9    0.029506109  -0.0157584576    0.000000000    0.97712079       0.9960045
10   0.030017554  -0.0278808876    0.000000000    1.03087155       1.0392388
11   0.148486462  -0.1787462820    0.000000000    0.98717326       1.1159879
12   0.221682266   0.0000000000    0.000000000    0.64633146       0.9265058
13   0.048060150  -0.0220012523    0.000000000    0.96090237       1.0189176
14   0.150528002   0.0000000000    0.000000000    0.71863947       0.9433402
15   0.135504333  -0.0542912135    0.000000000    1.01154790       1.1333588
16   0.151524711  -0.0335898645    0.000000000    0.95637650       1.1572222
17   0.131612228  -0.0468899761    0.000000000    0.96817896       1.1299141
18   0.323320075  -0.0109667062    0.000000000    1.59009900       2.2282283
19   0.025705011   0.0000000000    0.000000000    1.07303795       1.1039736
20   0.077070222   0.0000000000    0.000000000    0.97785757       1.1065935
21   0.068110375   0.0000000000    0.000000000    0.79927550       0.8673859
22   0.120071752   0.0000000000    0.000000000    1.03441703       1.1544888
23   0.017402154   0.0000000000    0.000000000    1.22880092       1.2462031
24   0.124064805   0.0000000000    0.000000000    0.80641755       0.9304824
25   0.119606632   0.0000000000    0.000000000    0.91152088       1.0311275
26   0.102090469   0.0000000000    0.000000000    0.82794900       0.9300395
27   0.000000000   0.0000000000    0.000000000    1.51032393       2.1781070
28   0.196690337  -0.0183160611    0.000000000    1.06272781       1.2941625
29   0.230190580  -0.0084022304    0.000000000    1.06742358       1.4146815
30   0.045247924  -0.0451766662    0.000000000    1.03927339       1.0492253
31   0.038922030  -0.0326056406    0.000000000    1.00949956       1.0290113
32  -0.030593473  -0.0001670247    0.000000000    1.22658918       1.2741157
33   0.000000000   0.2629095281    0.000000000    0.30404508       0.5669546
34   0.326295790  -0.0295399738    0.000000000    1.30948060       1.7868566
35   0.279340611  -0.0602550298    0.000000000    1.07791415       1.4754936
36   0.239336493  -0.0622901604    0.000000000    0.99828306       1.3124665
37   0.065332427  -0.0149823337    0.000000000    1.05571168       1.1207585
38   0.091023884  -0.0328602230    0.000000000    1.00685253       1.0907432
39   0.062215130  -0.0417155300    0.000000000    0.95843770       0.9973067
40   0.096199075  -0.0587740376    0.000000000    1.06774405       1.1161208
41   0.000000000   0.0115234209    0.000000000    0.03209838       0.0436218
42   0.099974244  -0.0627958489    0.000000000    0.94980496       1.0461233
43   0.164456841  -0.1810876763    0.012214464    1.23914955       1.2948495
44   0.000000000   0.0000000000    0.000000000    1.23599012       1.6246684
45   0.039190766  -0.0009753174    0.000000000    0.97744271       1.0337072
46   0.050889005  -0.0042012425    0.000000000    0.97562538       1.0495747
47   0.000000000   0.0000000000    0.000000000    2.45764352       3.5951474
48   0.134589297   0.0289033902    0.000000000    0.96562966       1.2131276
49   0.118713556  -0.0628747860    0.000000000    0.95838311       1.0523708
50   0.000000000   0.0000000000    0.000000000    1.43506497       2.0864884
51   0.210378707   0.0000000000    0.000000000    0.83133697       1.1697924
52   0.030149780   0.0244474052    0.155790817    0.69946822       0.9098562
53   0.010851372   0.0151922895    0.209461378    0.86348107       1.0989861
54   0.011462506   0.0959474018    0.137080884    0.94881103       1.1933018
55   0.113529808  -0.0041325400    0.000000000    0.81297575       0.9223730
56   0.217607014  -0.0028378709    0.000000000    0.64000095       0.8547701
57   0.000000000   0.0000000000    0.000000000    1.07825094       1.5329889
58  -0.001372050   0.0001373277    0.000000000    1.35556564       1.4690108
59   0.026680203  -0.0154953162    0.030787899    0.98226863       1.0242414
60   0.047808690  -0.0229034305    0.055981476    0.72853318       0.8094199
61   0.021532074   0.0000000000    0.000000000    1.06502858       1.1932588
62   0.147381550  -0.0106093598    0.000000000    0.98940940       1.1261816
63   0.100709675  -0.0025569721    0.000000000    0.96398177       1.0621345
64   0.103048068  -0.0900381779    0.034161470    0.88920956       0.9806465
65   0.138403085  -0.1361218754    0.027447941    0.79105726       0.8796515
66   0.149880681  -0.0891737725    0.009915420    0.76036892       0.8857243
67   0.187984472  -0.1306052695    0.000000000    1.55177268       1.6498119
68   0.233505894  -0.0116185847    0.000000000    1.03358519       1.3038879
69   0.000000000   0.4520957849    0.000000000    0.99390410       1.4459999
70   0.347302244  -0.0559092490    0.000000000    1.63762505       2.2013606
71   0.089395559  -0.0603957958    0.000000000    1.08130031       1.1583515
72   0.055320836  -0.0218010111    0.000000000    0.97139525       1.0375983
73   0.243400369  -0.0554456229    0.000000000    1.18163904       1.3998279
74   0.188491494  -0.0341037855    0.000000000    0.90719875       1.1302711
75   0.134280699  -0.0441801028    0.000000000    1.15299396       1.2891876
76   0.066814894  -0.0375692301    0.000000000    0.98348505       1.0334274
77   0.000000000   0.0000000000    0.000000000    1.46810748       1.9929754
78   0.216144518  -0.0458118616    0.000000000    1.31993191       1.5180667
79   0.159642083  -0.0040220568    0.000000000    1.64401260       1.8056476
80   0.193937066  -0.0042020252    0.000000000    2.38888247       2.5851736
81   0.078342692  -0.0084147900    0.000000000    1.05781380       1.1394256
82  -0.050405568   0.0263010878    0.000000000    1.29906693       1.2751583
83   0.103417058  -0.0056524778    0.000000000    0.93769479       1.1017969
84   0.041711295  -0.0004832786    0.000000000    1.23150437       1.2898137
85   0.024950349  -0.0115239683    0.000000000    1.07769763       1.0968020
86   0.021441523  -0.0129326921    0.000000000    1.37545975       1.3867913
87   0.042694073   0.0000000000    0.000000000    0.96794292       1.0363170
88   0.081405500  -0.0671846930    0.000000000    1.33712922       1.3709420
89   0.160534876  -0.0115817624    0.000000000    0.99090826       1.2041820
90   0.116189830  -0.0346288606    0.000000000    1.07023951       1.2323440
91   0.398259365  -0.2083035597    0.000000000    1.35634656       1.8237879
92   0.145277405  -0.0458345185    0.000000000    1.04030430       1.1676412
93   0.093431309  -0.0393049347    0.000000000    1.09558933       1.1654638
94   0.056364670  -0.0315634732    0.088200051    0.93612066       1.0526647
95   0.062874180  -0.0228763650    0.079131919    0.97837446       1.1077336
96   0.085469076  -0.0366902394    0.065303870    0.95738035       1.0919740
97   0.081730298   0.0000000000    0.001485262    0.92375575       1.0302215
98   0.132674155  -0.0394176495    0.000000000    1.00333242       1.1237320
99   0.033062103  -0.0053357852    0.000000000    0.99004996       1.0276113
100  0.129928283  -0.0783082269    0.027819520    1.01306307       1.1043726
101  0.182006831  -0.1422626605    0.000000000    1.19951011       1.2736143
102  0.174640656  -0.0753612293    0.000000000    0.99973661       1.1537043
103  0.246035305  -0.1900279065    0.000000000    1.28762943       1.4095162
104  0.133373439  -0.0303284455    0.000000000    0.99427635       1.1427866
105  0.049397538  -0.0521892730    0.000000000    1.53547866       1.5525115
106  0.045580418  -0.0131448866    0.000000000    1.00702250       1.0674177
107  0.046465967  -0.0221385594    0.000000000    1.04470643       1.0950398
108  0.037802608  -0.0076329839    0.000000000    1.03810595       1.0939895
109  0.077803282   0.0151411879    0.033492190    0.77981970       0.9062564
110  0.048914579  -0.0479469232    0.000000000    1.02118681       1.0297587
111  0.060277766  -0.0374740811    0.000000000    1.02444495       1.0603807
112  0.027702498  -0.0356235844    0.000000000    1.04131772       1.0350268
113  0.069435668  -0.1074434325    0.000000000    1.06348659       1.0330665
114  0.072912503  -0.0413367556    0.000000000    0.95461777       1.0043168
115  0.065045227  -0.0760000402    0.000000000    1.05215703       1.0492697
116  0.041326378  -0.0446972680    0.000000000    1.02732336       1.0328395
117  0.082734252  -0.0323253017    0.000000000    0.92982555       1.0012015
118  0.060792920  -0.0730936790    0.000000000    1.05089750       1.0448704
119  0.007812569   0.0065570299    0.000000000    1.04814420       1.0923178
120  0.006903851   0.0000000000    0.047241141    1.13489686       1.2407214
121  0.036100179   0.0000000000    0.000000000    1.00626386       1.0468022
       Buffmx MatRep      LHPC.1       LHPC.2      ClimPC.1    ClimPC.2
1   1.0004237      4  1.32464828  0.537854879  0.1901416531 -0.28772696
2   1.1469247     53 -1.42492399 -0.649069599 -1.7561907820  0.04956925
3   1.0117730      4  0.56077336  0.164523234  1.8598982808 -0.06178840
4   1.0988250      7 -0.96962137 -0.340730299  0.4375307731  2.67206519
5   1.0172371      3  1.09629297  0.389760264 -0.7730831616  0.34794691
6   0.9975678      4 -0.55655519 -0.813525720  1.4472669041 -1.00114517
7   1.0013987      4 -1.06729001 -0.261477978  1.2858271979 -0.89654864
8   1.0010531      4  2.37514805 -1.099652568  1.0944563796 -1.24164970
9   0.9976748      4  2.34539416 -1.157483245  1.1425652992 -1.16795116
10  1.0062788      4  0.21879672 -0.185191173  1.1212553499 -1.13208352
11  1.1022898      5  0.33967682 -0.204267535  1.6907544333  1.99312203
12  1.0064223      6  0.58654442  1.552895288  0.4760451051 -0.32094170
13  1.0045646      3  2.68610180 -1.508329446  0.1855146450  0.65577927
14  1.0902586      4  2.13295782  0.859818742 -0.1224602535  0.86297646
15  1.0103733      4  1.31952961 -1.035990880  0.9097750097 -2.39020122
16  1.0579087      5 -0.38478405 -0.092261418 -0.2316797050  0.95835523
17  1.0110815      6  1.50838482  0.269527637 -0.2223902021  0.89572714
18  1.9381641     17  0.62209109 -0.432490111  0.8774241269 -1.13693440
19  0.9954316      5  1.00434501  0.295205182 -2.3926197845 -0.18185305
20  1.0169975      4  1.35067955 -0.954406230  2.0755021947  0.95538347
21  1.0414770      3 -0.12053648  0.342208089  1.1086906247 -0.46406791
22  1.0671800      3  0.65426452  1.301049021  1.2417517508  0.82778456
23  1.0141861      3  2.13426916 -0.807632593  1.2283556324 -0.35890996
24  1.1081790      3  1.89249324  0.989150312  1.0126619397  0.12345998
25  1.3555067      3 -0.26206038  0.259625422  1.0181982496 -0.44286222
26  1.2751194      3  1.64771068  0.290618241  1.1150215913 -0.48773093
27  1.1199191     26 -4.62204819  0.597566619  2.4257757354  2.21229460
28  1.0095946      5 -2.83595721  2.971082188  0.0645731944  0.94284066
29  1.0948962      3 -0.34423198  1.409778546 -0.4073604547  0.58685928
30  1.0029059      5 -0.18148396 -0.020375412  0.1418401072  0.56464639
31  1.0013082      5  0.11793730 -0.034542972 -0.0134516680  0.61697753
32  1.0016803     12  2.30548757  2.560948144 -0.2355186453  1.72796797
33  1.0881019      6  1.72460210  0.590967280  0.7395830604 -0.26063871
34  1.1898041      3 -0.07774510 -0.316277460 -0.6879615697  2.10077564
35  1.0598832      3 -0.43331618 -0.390104238 -0.6894463627 -0.46803216
36  1.1273793      3 -0.07259981 -0.497804902  0.7626892441 -1.02418802
37  1.0064561      3  1.38217819 -0.087009229  0.9505472946  0.25373062
38  1.0011119      3  0.28268740  0.199731108  0.9529629675  0.36575851
39  1.0017544      3  1.79724754  1.340636343  0.5968969616  0.46873583
40  1.0100856      6  0.02348962  0.089457485  0.8265089105  0.29215625
41  1.0617870      3  2.04385585  0.943217705  0.7395830604 -0.26063871
42  1.0819747      3 -4.13027561  1.133271320  0.7619565639 -0.18606683
43  1.0520314      3 -1.07358046  0.040761906  0.4863720564 -0.20995834
44  1.1249988     30  0.41477648  0.299127306  2.2871049397  2.41124712
45  0.9966785      5  0.18242622  0.276822341  0.5918071001  0.09849035
46  1.0017862      3 -1.33815439 -1.158104197  0.2767905277 -0.64299861
47  1.1427458     14 -2.29821434 -0.517832263  2.4257757354  2.21229460
48  1.1040372      5  1.47004816  0.722283861  1.3884443409 -0.35922791
49  1.0111736      3  1.87801910  0.282782785  0.9097750097 -2.39020122
50  1.1766299     19 -4.23747569  0.323511508  2.4257757354  2.21229460
51  1.0224502      3  2.06180504 -0.950831472  1.0361104449 -0.49700718
52  1.0064660      3 -3.08938703  0.215411257  0.4014577875 -0.18865705
53  1.0222895      3  2.77729996 -0.744645144  0.4681051969 -0.21333330
54  1.1123591      3  1.21352791 -0.371621315  0.4667961789 -0.21919017
55  1.0699287      4 -0.10507296 -0.826523034  0.9451028628 -0.59948045
56  1.0202616      4 -0.23147707 -0.638967301  1.6114594226 -0.04575505
57  1.1238899     25  0.82647843 -1.007634897  2.2871049397  2.41124712
58  1.0203434      4  0.87005479  0.671516129 -0.4681933238  0.06649261
59  1.0022460      4  1.60244842 -0.868181765  0.4014577875 -0.18865705
60  1.0170315      4  0.44521397 -0.640920856  0.4681051969 -0.21333330
61  1.0006248      3  0.44057252 -0.616964686 -0.1397928929  0.53624725
62  1.0144133      3  0.87544995 -0.307634285  1.0769134011 -0.69736036
63  1.0081205      3  1.28762421 -0.894993575  1.5329901236 -1.12182273
64  1.0137131      4 -4.23747569  0.323511508  0.4302852079 -0.24179492
65  1.0124443      3 -4.96112780  0.549810577  0.4681051969 -0.21333330
66  0.9987339      4 -4.62629978  0.596240214  0.4014577875 -0.18865705
67  1.0643938     15  0.16203807  0.012146991  1.8156994500  0.02731675
68  1.0282270      3 -0.45828842 -0.257370385 -2.2039661972 -0.43245497
69  1.2549325      5 -1.48937190 -0.851180889  0.7395830604 -0.26063871
70  1.0963114      3  0.42060089  0.846082394  1.3902869769 -0.07324338
71  1.0528927     12  1.41128425 -0.625449275  0.3891227737 -0.17737344
72  1.0043468      5  0.81871825 -0.579572921  0.3475026740 -0.77983148
73  1.2005358     10  1.50162477 -0.738864602 -0.2549818707 -0.92466195
74  1.0136580     14  0.41502047 -0.532623775 -0.0002088708 -0.78039694
75  1.0062161     24  2.06022126 -0.954533847 -0.7425642082 -1.34483703
76  1.0001203      4 -4.34768652  0.310739550  0.9599472516 -0.87928286
77  1.1200143     25  0.47294500 -0.498375939  2.2871049397  2.41124712
78  1.1415555      3 -2.09548698 -0.294589929 -0.6145513071  2.70427584
79  0.9857018      3 -0.32716913 -0.179802414 -1.3738783145  0.37527046
80  1.0363167      3  0.11606091  0.961718360 -1.3738783145  0.37527046
81  1.0037322      3  2.55366921 -0.374189229 -1.3738783145  0.37527046
82  1.0026622      5  0.36538940 -0.179072345 -1.5952953930  1.02210963
83  1.0040824      5  0.46331537  0.137758712 -1.6917671379  0.86555414
84  0.9991667      3  0.88092508  2.144336179 -1.6309258120  0.38437375
85  1.0040889      4 -0.29625503 -0.235721588 -0.3717725042  2.78160961
86  1.0142548      3  1.85338100  7.599812825 -0.3607361355  2.76380872
87  1.0052818      5  1.53069143 -0.833409703  0.7670786060  1.90505915
88  1.0143370      4 -1.45321573 -0.801290883 -0.6197935504 -0.30374064
89  1.0133921     24 -0.03599821  0.248647534  0.0290749929  0.21792912
90  1.0016138      5  2.13134796  1.112210121 -0.0545412156  0.78337097
91  1.0575854      3 -0.14821863 -0.398410796  2.2676408997  0.01708203
92  1.0145514      6  1.00351444  0.118662360  1.8403665291  0.13846913
93  1.0111872      5  0.11746148 -0.201083931  1.8622642755  0.06927096
94  0.9997896      4 -1.28049486  1.324442705  0.3716436184  0.02078917
95  1.0031133      6 -0.22657292 -0.270479797  0.3770234619  0.06830037
96  1.0048691      6 -1.29266891 -0.727598290  0.4736846285  0.10346305
97  1.0040503      6  0.87637358  0.024204126 -3.6880681000 -1.75233219
98  1.0115493     14 -1.25296387 -0.305498084 -1.2433093245  1.12819762
99  1.0001780      4  0.93360200  0.039306015 -2.3197370835  0.27446076
100 1.0040632      5 -0.48113223 -0.267143995  0.9097750097 -2.39020122
101 1.0422046     11  1.11591045 -0.224008873 -1.0543613796  0.73770969
102 1.0713503      3 -3.11960903  0.615379811  0.2801875797  0.21788596
103 1.1658164      4  0.01026127  0.196708591 -0.7135975980  2.58121786
104 1.0132490      3 -1.06761350 -0.556191663 -1.8739491435 -0.45318379
105 1.0043283     16 -1.24316113 -0.737201942  0.7979207719 -0.33450502
106 1.0047770      7 -1.16028746  0.577307150  0.3430433599  1.61505992
107 1.0181906      7 -2.70732004  1.708784793  0.4949018701  2.25916732
108 1.0079742      5 -2.58371786 -0.382985166  0.7639910865  1.79538409
109 1.0117780      4 -1.29887476 -0.383840462  1.4732264132 -1.63849580
110 1.0014665      5 -0.11102808 -0.001042222  0.5057094428 -0.87317673
111 0.9991554      5 -0.11288327 -0.263697643  0.6055468241 -0.77949621
112 0.9996627      5 -0.34238159 -0.082509243  0.4970393113 -0.99556381
113 0.9974504      3 -0.16314967  0.243580718  0.5731929552 -0.84398631
114 1.0012208      5 -0.35598966  0.239821971  0.4951619353 -0.85904086
115 1.0036398      3 -0.03661108 -0.264173768  0.5134626127 -0.82758632
116 0.9997875      7 -0.28062667 -0.043255956  0.5082677717 -0.86911082
117 0.9995278      3 -0.28035214 -0.155445924  0.6076304668 -0.74343628
118 1.0010317      4 -0.21225711 -0.001855859  0.6734935916 -0.66963609
119 1.0061722     32  2.16602800 -0.257929140  2.0927212323 -0.52744279
120 1.0207404     14  0.63911719  0.437562271  2.8220623624 -1.68655232
121 0.9959259      9  2.05580076  0.097852476  0.5888131058 -1.28451621
       ClimPC.3           SpeciesAccepted.x Kingdom.x      Phylum.x
1   -0.32364884      Euphorbia fontqueriana   Plantae Magnoliophyta
2    0.52991276        Hypericum cumulicola   Plantae Magnoliophyta
3    0.11224260         Agrimonia eupatoria   Plantae Magnoliophyta
4    0.96562898          Purshia subintegra   Plantae Magnoliophyta
5    0.40958101              Cucurbita pepo   Plantae Magnoliophyta
6    0.36312670            Castanea dentata   Plantae  Tracheophyta
7    0.03574476            Castanea dentata   Plantae  Tracheophyta
8    0.01949560            Castanea dentata   Plantae  Tracheophyta
9    0.00961047            Castanea dentata   Plantae  Tracheophyta
10   0.10430753            Castanea dentata   Plantae  Tracheophyta
11  -0.88785777       Astragalus scaphoides   Plantae Magnoliophyta
12  -0.12789129       Astragalus alopecurus   Plantae Magnoliophyta
13  -0.28465691     Astragalus tremolsianus   Plantae Magnoliophyta
14  -0.17848110        Dorycnium spectabile   Plantae Magnoliophyta
15   0.62282181        Anthyllis vulneraria   Plantae Magnoliophyta
16   0.21723754         Lupinus tidestromii   Plantae Magnoliophyta
17   0.17701314         Lupinus tidestromii   Plantae Magnoliophyta
18   1.62120290             Lupinus lepidus   Plantae Magnoliophyta
19   0.59888797           Carapa guianensis   Plantae Magnoliophyta
20   1.32691290              Acer saccharum   Plantae Magnoliophyta
21  -0.20821291          Alliaria petiolata   Plantae Magnoliophyta
22   0.44571374          Alliaria petiolata   Plantae Magnoliophyta
23  -0.32905057          Alliaria petiolata   Plantae Magnoliophyta
24   0.06007740          Alliaria petiolata   Plantae Magnoliophyta
25  -0.33302275          Alliaria petiolata   Plantae Magnoliophyta
26  -0.43707692          Alliaria petiolata   Plantae Magnoliophyta
27   1.20748053        Sphaeralcea coccinea   Plantae Magnoliophyta
28   0.03310394   Helianthemum polygonoides   Plantae Magnoliophyta
29  -0.39610567     Helianthemum teneriffae   Plantae Magnoliophyta
30  -0.07098295          Erodium paularense   Plantae Magnoliophyta
31  -0.02090477          Erodium paularense   Plantae Magnoliophyta
32   0.55070377         Oenothera deltoides   Plantae Magnoliophyta
33  -0.59497021     Saxifraga tridactylites   Plantae Magnoliophyta
34   1.02619889          Plantago coronopus   Plantae Magnoliophyta
35   0.07901195          Plantago coronopus   Plantae Magnoliophyta
36  -0.31691032          Plantago coronopus   Plantae Magnoliophyta
37  -0.36804073    Dracocephalum austriacum   Plantae Magnoliophyta
38  -0.36555976    Dracocephalum austriacum   Plantae Magnoliophyta
39   0.40369338              Ramonda myconi   Plantae Magnoliophyta
40   0.53507414              Ramonda myconi   Plantae Magnoliophyta
41  -0.59497021        Myosotis ramosissima   Plantae Magnoliophyta
42  -0.02771252       Gentiana pneumonanthe   Plantae Magnoliophyta
43  -0.37533525        Hypochaeris radicata   Plantae Magnoliophyta
44   1.25690733      Echinacea angustifolia   Plantae Magnoliophyta
45  -0.05782457      Echinacea angustifolia   Plantae Magnoliophyta
46  -0.31952387      Echinacea angustifolia   Plantae Magnoliophyta
47   1.20748053        Ratibida columnifera   Plantae Magnoliophyta
48  -0.01312157            Liatris scariosa   Plantae Magnoliophyta
49   0.62282181            Artemisia genipi   Plantae Magnoliophyta
50   1.20748053             Solidago mollis   Plantae Magnoliophyta
51  -0.78333529            Cirsium palustre   Plantae Magnoliophyta
52  -0.38653722           Cirsium dissectum   Plantae Magnoliophyta
53  -0.37798458           Cirsium dissectum   Plantae Magnoliophyta
54  -0.31861025           Cirsium dissectum   Plantae Magnoliophyta
55   0.12070552            Cirsium pitcheri   Plantae Magnoliophyta
56   0.12318110            Cirsium pitcheri   Plantae Magnoliophyta
57   1.25690733           Cirsium undulatum   Plantae Magnoliophyta
58  -0.21288706           Jurinea fontqueri   Plantae Magnoliophyta
59  -0.38653722             Centaurea jacea   Plantae Magnoliophyta
60  -0.37798458             Centaurea jacea   Plantae Magnoliophyta
61  -0.42230483    Cheirolophus metlesicsii   Plantae Magnoliophyta
62  -1.47238536                 Carum carvi   Plantae Magnoliophyta
63  -0.83812394                 Carum carvi   Plantae Magnoliophyta
64  -0.36925265           Succisa pratensis   Plantae Magnoliophyta
65  -0.37798458           Succisa pratensis   Plantae Magnoliophyta
66  -0.38653722           Succisa pratensis   Plantae Magnoliophyta
67  -0.03538656           Succisa pratensis   Plantae Magnoliophyta
68   0.32090193      Ardisia escallonioides   Plantae Magnoliophyta
69  -0.59497021          Androsace elongata   Plantae Magnoliophyta
70  -0.37001193            Primula farinosa   Plantae  Tracheophyta
71  -0.29741967               Primula veris   Plantae Magnoliophyta
72  -0.34411841             Primula elatior   Plantae Magnoliophyta
73  -0.86292672            Primula vulgaris   Plantae Magnoliophyta
74  -0.78443947            Primula vulgaris   Plantae Magnoliophyta
75  -0.11362628            Primula vulgaris   Plantae Magnoliophyta
76  -0.56193794         Sarracenia purpurea   Plantae Magnoliophyta
77   1.25690733          Paronychia jamesii   Plantae Magnoliophyta
78   0.86974688          Atriplex canescens   Plantae  Tracheophyta
79  -0.30163189   Neobuxbaumia mezcalaensis   Plantae Magnoliophyta
80  -0.30163189   Neobuxbaumia mezcalaensis   Plantae Magnoliophyta
81  -0.30163189   Neobuxbaumia macrocephala   Plantae Magnoliophyta
82   0.21559050 Mammillaria huitzilopochtli   Plantae Magnoliophyta
83   0.20846126 Mammillaria huitzilopochtli   Plantae Magnoliophyta
84  -0.24287384     Mammillaria solisioides   Plantae Magnoliophyta
85   0.95716696       Ariocarpus fissuratus   Plantae Magnoliophyta
86   0.94874098       Ariocarpus fissuratus   Plantae Magnoliophyta
87   0.98725395       Escobaria robbinsorum   Plantae Magnoliophyta
88   0.21859866             Rumex rupestris   Plantae Magnoliophyta
89   0.04057466          Armeria caespitosa   Plantae Magnoliophyta
90  -0.02332064            Limonium erectum   Plantae Magnoliophyta
91   0.32163290         Ranunculus peltatus   Plantae Magnoliophyta
92   0.03820071              Actaea spicata   Plantae Magnoliophyta
93   0.06856271              Actaea spicata   Plantae Magnoliophyta
94   0.04085176         Dicentra canadensis   Plantae  Tracheophyta
95   0.02851837         Dicentra canadensis   Plantae  Tracheophyta
96  -0.09195498         Dicentra canadensis   Plantae  Tracheophyta
97   2.02884510         Chamaedorea elegans   Plantae Magnoliophyta
98   0.74686358       Chamaedorea radicalis   Plantae Magnoliophyta
99   0.25868305          Borassus aethiopum   Plantae Magnoliophyta
100  0.62282181                  Poa alpina   Plantae Magnoliophyta
101  0.79148913           Zea diploperennis   Plantae Magnoliophyta
102  0.18110723           Danthonia sericea   Plantae Magnoliophyta
103  0.76691034              Hilaria mutica   Plantae Magnoliophyta
104 -0.14444214           Catopsis compacta   Plantae Magnoliophyta
105 -0.03864572             Orchis purpurea   Plantae Magnoliophyta
106  0.91408058    Cypripedium fasciculatum   Plantae Magnoliophyta
107  0.83829973    Cypripedium fasciculatum   Plantae Magnoliophyta
108  0.65950726    Cypripedium fasciculatum   Plantae Magnoliophyta
109  0.55521569            Allium tricoccum   Plantae Magnoliophyta
110 -0.25452323       Trillium grandiflorum   Plantae Magnoliophyta
111 -0.35605880       Trillium grandiflorum   Plantae Magnoliophyta
112 -0.25529127       Trillium grandiflorum   Plantae Magnoliophyta
113 -0.31908468       Trillium grandiflorum   Plantae Magnoliophyta
114 -0.27161723       Trillium grandiflorum   Plantae Magnoliophyta
115 -0.33631872       Trillium grandiflorum   Plantae Magnoliophyta
116 -0.28504364       Trillium grandiflorum   Plantae Magnoliophyta
117 -0.35436699       Trillium grandiflorum   Plantae Magnoliophyta
118 -0.40946570       Trillium grandiflorum   Plantae Magnoliophyta
119  1.62879830         Calochortus lyallii   Plantae Magnoliophyta
120  1.66817327            Asarum canadense   Plantae Magnoliophyta
121  0.11992176               Pinus strobus   Plantae     Pinophyta
          Class.x        Order.x       OrganismType.x AngioGymno.x    lambda
1   Magnoliopsida   Malpighiales            Succulent   Angiosperm 0.9779625
2   Magnoliopsida        Theales Herbaceous perennial   Angiosperm 1.0243679
3   Magnoliopsida        Rosales Herbaceous perennial   Angiosperm 0.9283973
4   Magnoliopsida        Rosales                Shrub   Angiosperm 0.9751571
5   Magnoliopsida  Curcurbitales               Annual   Angiosperm 1.2408827
6   Magnoliopsida        Fagales                 Tree   Angiosperm 1.0088920
7   Magnoliopsida        Fagales                 Tree   Angiosperm 1.0067955
8   Magnoliopsida        Fagales                 Tree   Angiosperm 0.9940440
9   Magnoliopsida        Fagales                 Tree   Angiosperm 0.9934334
10  Magnoliopsida        Fagales                 Tree   Angiosperm 0.9818987
11  Magnoliopsida        Fabales Herbaceous perennial   Angiosperm 1.5999061
12  Magnoliopsida        Fabales Herbaceous perennial   Angiosperm 1.5506323
13  Magnoliopsida        Fabales Herbaceous perennial   Angiosperm 1.0965123
14  Magnoliopsida        Fabales Herbaceous perennial   Angiosperm 1.9158723
15  Magnoliopsida        Fabales Herbaceous perennial   Angiosperm 1.0510285
16  Magnoliopsida        Fabales Herbaceous perennial   Angiosperm 1.0111035
17  Magnoliopsida        Fabales Herbaceous perennial   Angiosperm 0.9262035
18  Magnoliopsida        Fabales Herbaceous perennial   Angiosperm 0.9799277
19  Magnoliopsida     Sapindales                 Tree   Angiosperm 0.9956000
20  Magnoliopsida     Sapindales                 Tree   Angiosperm 0.9644052
21  Magnoliopsida    Brassicales Herbaceous perennial   Angiosperm 1.0239866
22  Magnoliopsida    Brassicales Herbaceous perennial   Angiosperm 1.4037297
23  Magnoliopsida    Brassicales Herbaceous perennial   Angiosperm 0.7869247
24  Magnoliopsida    Brassicales Herbaceous perennial   Angiosperm 1.0359177
25  Magnoliopsida    Brassicales Herbaceous perennial   Angiosperm 0.9716492
26  Magnoliopsida    Brassicales Herbaceous perennial   Angiosperm 1.3648033
27  Magnoliopsida       Malvales Herbaceous perennial   Angiosperm 0.7611410
28  Magnoliopsida       Malvales Herbaceous perennial   Angiosperm 0.9308673
29  Magnoliopsida       Malvales Herbaceous perennial   Angiosperm 1.5407796
30  Magnoliopsida     Geraniales Herbaceous perennial   Angiosperm 0.9575419
31  Magnoliopsida     Geraniales Herbaceous perennial   Angiosperm 1.0879999
32  Magnoliopsida       Myrtales Herbaceous perennial   Angiosperm 0.8553326
33  Magnoliopsida   Saxifragales               Annual   Angiosperm 1.8316693
34  Magnoliopsida       Lamiales Herbaceous perennial   Angiosperm 0.5322755
35  Magnoliopsida       Lamiales Herbaceous perennial   Angiosperm 1.1257721
36  Magnoliopsida       Lamiales Herbaceous perennial   Angiosperm 1.7314892
37  Magnoliopsida       Lamiales Herbaceous perennial   Angiosperm 0.9656341
38  Magnoliopsida       Lamiales Herbaceous perennial   Angiosperm 0.9791057
39  Magnoliopsida       Lamiales Herbaceous perennial   Angiosperm 1.0326716
40  Magnoliopsida       Lamiales Herbaceous perennial   Angiosperm 0.9677607
41  Magnoliopsida       Lamiales               Annual   Angiosperm 1.6732773
42  Magnoliopsida    Gentianales Herbaceous perennial   Angiosperm 1.1326931
43  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.1230529
44  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 0.6215339
45  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 0.9919496
46  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.0365163
47  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.1283010
48  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.3243933
49  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.1443488
50  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.8015241
51  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.2362850
52  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.0875591
53  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.0558414
54  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.4936542
55  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 0.9146098
56  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.0535111
57  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 1.1119058
58  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 0.6170490
59  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 0.7721355
60  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 0.8874202
61  Magnoliopsida      Asterales Herbaceous perennial   Angiosperm 0.9634498
62  Magnoliopsida        Apiales Herbaceous perennial   Angiosperm 0.7839479
63  Magnoliopsida        Apiales Herbaceous perennial   Angiosperm 0.9832736
64  Magnoliopsida     Dipsacales Herbaceous perennial   Angiosperm 1.2656266
65  Magnoliopsida     Dipsacales Herbaceous perennial   Angiosperm 1.4304409
66  Magnoliopsida     Dipsacales Herbaceous perennial   Angiosperm 1.2955549
67  Magnoliopsida     Dipsacales Herbaceous perennial   Angiosperm 0.7613167
68  Magnoliopsida       Ericales                Shrub   Angiosperm 1.3372438
69  Magnoliopsida       Ericales               Annual   Angiosperm 0.6744272
70  Magnoliopsida       Ericales Herbaceous perennial   Angiosperm 1.1426327
71  Magnoliopsida       Ericales Herbaceous perennial   Angiosperm 0.8550317
72  Magnoliopsida       Ericales Herbaceous perennial   Angiosperm 1.0551724
73  Magnoliopsida       Ericales Herbaceous perennial   Angiosperm 0.8672650
74  Magnoliopsida       Ericales Herbaceous perennial   Angiosperm 0.9802187
75  Magnoliopsida       Ericales Herbaceous perennial   Angiosperm 0.8083969
76  Magnoliopsida       Ericales Herbaceous perennial   Angiosperm 1.0164304
77  Magnoliopsida Caryophyllales Herbaceous perennial   Angiosperm 0.6241799
78  Magnoliopsida Caryophyllales                Shrub   Angiosperm 1.7211020
79  Magnoliopsida Caryophyllales            Succulent   Angiosperm 1.0001012
80  Magnoliopsida Caryophyllales            Succulent   Angiosperm 1.0001012
81  Magnoliopsida Caryophyllales            Succulent   Angiosperm 1.0448792
82  Magnoliopsida Caryophyllales            Succulent   Angiosperm 0.8096500
83  Magnoliopsida Caryophyllales            Succulent   Angiosperm 1.2437146
84  Magnoliopsida Caryophyllales            Succulent   Angiosperm 0.7717743
85  Magnoliopsida Caryophyllales            Succulent   Angiosperm 0.8536424
86  Magnoliopsida Caryophyllales            Succulent   Angiosperm 0.9123507
87  Magnoliopsida Caryophyllales            Succulent   Angiosperm 1.0675543
88  Magnoliopsida Caryophyllales Herbaceous perennial   Angiosperm 0.6939522
89  Magnoliopsida Caryophyllales Herbaceous perennial   Angiosperm 1.1056787
90  Magnoliopsida Caryophyllales Herbaceous perennial   Angiosperm 0.8622434
91  Magnoliopsida   Ranunculales Herbaceous perennial   Angiosperm 0.6678511
92  Magnoliopsida   Ranunculales Herbaceous perennial   Angiosperm 1.0111375
93  Magnoliopsida   Ranunculales Herbaceous perennial   Angiosperm 0.9799315
94  Magnoliopsida   Ranunculales Herbaceous perennial   Angiosperm 1.0953694
95  Magnoliopsida   Ranunculales Herbaceous perennial   Angiosperm 1.0512885
96  Magnoliopsida   Ranunculales Herbaceous perennial   Angiosperm 1.1280523
97     Liliopsida       Arecales                 Palm   Angiosperm 1.1669544
98     Liliopsida       Arecales                 Palm   Angiosperm 1.1789035
99     Liliopsida       Arecales                 Palm   Angiosperm 1.0295980
100    Liliopsida         Poales Herbaceous perennial   Angiosperm 0.9987145
101    Liliopsida         Poales Herbaceous perennial   Angiosperm 0.5545652
102    Liliopsida         Poales Herbaceous perennial   Angiosperm 1.0100578
103    Liliopsida         Poales Herbaceous perennial   Angiosperm 1.7385142
104    Liliopsida         Poales             Epiphyte   Angiosperm 1.0615691
105    Liliopsida    Asparagales Herbaceous perennial   Angiosperm 0.9831117
106    Liliopsida    Asparagales Herbaceous perennial   Angiosperm 1.0643108
107    Liliopsida    Asparagales Herbaceous perennial   Angiosperm 1.0191296
108    Liliopsida    Asparagales Herbaceous perennial   Angiosperm 1.0732602
109    Liliopsida    Asparagales Herbaceous perennial   Angiosperm 1.1331204
110    Liliopsida       Liliales Herbaceous perennial   Angiosperm 1.0406040
111    Liliopsida       Liliales Herbaceous perennial   Angiosperm 1.0022867
112    Liliopsida       Liliales Herbaceous perennial   Angiosperm 0.9735535
113    Liliopsida       Liliales Herbaceous perennial   Angiosperm 0.9536967
114    Liliopsida       Liliales Herbaceous perennial   Angiosperm 1.0089756
115    Liliopsida       Liliales Herbaceous perennial   Angiosperm 0.9905149
116    Liliopsida       Liliales Herbaceous perennial   Angiosperm 0.9847658
117    Liliopsida       Liliales Herbaceous perennial   Angiosperm 1.0981481
118    Liliopsida       Liliales Herbaceous perennial   Angiosperm 0.9909749
119    Liliopsida       Liliales Herbaceous perennial   Angiosperm 1.0226717
120 Magnoliopsida      Piperales Herbaceous perennial   Angiosperm 1.0447722
121     Pinopsida        Pinales                 Tree   Gymnosperm 1.0184607
    Ecoregion.x                  Binomial.x                       phylo
1           MED      Euphorbia_fontqueriana      Euphorbia_fontqueriana
2           TCF        Hypericum_cumulicola        Hypericum_cumulicola
3           FGS         Agrimonia_eupatoria         Agrimonia_eupatoria
4           DES          Purshia_subintegra          Purshia_subintegra
5           TBM              Cucurbita_pepo              Cucurbita_pepo
6           TBM            Castanea_dentata            Castanea_dentata
7           TBM            Castanea_dentata            Castanea_dentata
8           TBM            Castanea_dentata            Castanea_dentata
9           TBM            Castanea_dentata            Castanea_dentata
10          TBM            Castanea_dentata            Castanea_dentata
11          DES       Astragalus_scaphoides       Astragalus_scaphoides
12          TBM       Astragalus_alopecurus       Astragalus_alopecurus
13          MED     Astragalus_tremolsianus     Astragalus_tremolsianus
14          MED        Dorycnium_spectabile        Dorycnium_spectabile
15          TBM        Anthyllis_vulneraria        Anthyllis_vulneraria
16          DES         Lupinus_tidestromii         Lupinus_tidestromii
17          DES         Lupinus_tidestromii         Lupinus_tidestromii
18          TCF             Lupinus_lepidus             Lupinus_lepidus
19          TMB           Carapa_guianensis           Carapa_guianensis
20          TBM              Acer_saccharum              Acer_saccharum
21          TBM          Alliaria_petiolata          Alliaria_petiolata
22          TBM          Alliaria_petiolata          Alliaria_petiolata
23          TBM          Alliaria_petiolata          Alliaria_petiolata
24          TBM          Alliaria_petiolata          Alliaria_petiolata
25          TBM          Alliaria_petiolata          Alliaria_petiolata
26          TBM          Alliaria_petiolata          Alliaria_petiolata
27          TGS        Sphaeralcea_coccinea        Sphaeralcea_coccinea
28          MED   Helianthemum_polygonoides   Helianthemum_polygonoides
29          MED     Helianthemum_teneriffae     Helianthemum_teneriffae
30          MED          Erodium_paularense          Erodium_paularense
31          MED          Erodium_paularense          Erodium_paularense
32          DES         Oenothera_deltoides         Oenothera_deltoides
33          TBM     Saxifraga_tridactylites     Saxifraga_tridactylites
34          MED          Plantago_coronopus          Plantago_coronopus
35          TBM          Plantago_coronopus          Plantago_coronopus
36          TBM          Plantago_coronopus          Plantago_coronopus
37          TBM    Dracocephalum_austriacum    Dracocephalum_austriacum
38          TBM    Dracocephalum_austriacum    Dracocephalum_austriacum
39          MED              Ramonda_myconi              Ramonda_myconi
40          MED              Ramonda_myconi              Ramonda_myconi
41          TBM        Myosotis_ramosissima        Myosotis_ramosissima
42          TBM       Gentiana_pneumonanthe       Gentiana_pneumonanthe
43          TBM        Hypochaeris_radicata        Hypochaeris_radicata
44          TGS      Echinacea_angustifolia      Echinacea_angustifolia
45          TGS      Echinacea_angustifolia      Echinacea_angustifolia
46          TGS      Echinacea_angustifolia      Echinacea_angustifolia
47          TGS        Ratibida_columnifera        Ratibida_columnifera
48          TGS            Liatris_scariosa            Liatris_scariosa
49          TCF            Artemisia_genipi            Artemisia_genipi
50          TGS             Solidago_mollis             Solidago_mollis
51          FGS            Cirsium_palustre            Cirsium_palustre
52          TBM           Cirsium_dissectum           Cirsium_dissectum
53          TBM           Cirsium_dissectum           Cirsium_dissectum
54          TBM           Cirsium_dissectum           Cirsium_dissectum
55          TGS            Cirsium_pitcheri            Cirsium_pitcheri
56          TGS            Cirsium_pitcheri            Cirsium_pitcheri
57          TGS           Cirsium_undulatum           Cirsium_undulatum
58          MED           Jurinea_fontqueri           Jurinea_fontqueri
59          TBM             Centaurea_jacea             Centaurea_jacea
60          TBM             Centaurea_jacea             Centaurea_jacea
61          MED    Cheirolophus_metlesicsii    Cheirolophus_metlesicsii
62          TBM                 Carum_carvi                 Carum_carvi
63          TBM                 Carum_carvi                 Carum_carvi
64          TBM           Succisa_pratensis           Succisa_pratensis
65          TBM           Succisa_pratensis           Succisa_pratensis
66          TBM           Succisa_pratensis           Succisa_pratensis
67          TBM           Succisa_pratensis           Succisa_pratensis
68          TMB      Ardisia_escallonioides      Ardisia_escallonioides
69          TBM          Androsace_elongata          Androsace_elongata
70          TBM            Primula_farinosa            Primula_farinosa
71          TBM               Primula_veris               Primula_veris
72          TBM             Primula_elatior             Primula_elatior
73          TBM            Primula_vulgaris            Primula_vulgaris
74          TBM            Primula_vulgaris            Primula_vulgaris
75          TBM            Primula_vulgaris            Primula_vulgaris
76          BOR         Sarracenia_purpurea         Sarracenia_purpurea
77          TGS          Paronychia_jamesii          Paronychia_jamesii
78          DES          Atriplex_canescens          Atriplex_canescens
79          TSC   Neobuxbaumia_mezcalaensis   Neobuxbaumia_mezcalaensis
80          DES   Neobuxbaumia_mezcalaensis   Neobuxbaumia_mezcalaensis
81          DES   Neobuxbaumia_macrocephala   Neobuxbaumia_macrocephala
82          TGV Mammillaria_huitzilopochtli Mammillaria_huitzilopochtli
83          DES Mammillaria_huitzilopochtli Mammillaria_huitzilopochtli
84          DES     Mammillaria_solisioides     Mammillaria_solisioides
85          DES       Ariocarpus_fissuratus       Ariocarpus_fissuratus
86          DES       Ariocarpus_fissuratus       Ariocarpus_fissuratus
87          DES       Escobaria_robbinsorum       Escobaria_robbinsorum
88          TBM             Rumex_rupestris             Rumex_rupestris
89          MED          Armeria_caespitosa          Armeria_caespitosa
90          MED            Limonium_erectum            Limonium_erectum
91          TBM         Ranunculus_peltatus         Ranunculus_peltatus
92          TBM              Actaea_spicata              Actaea_spicata
93          TBM              Actaea_spicata              Actaea_spicata
94          TBM         Dicentra_canadensis         Dicentra_canadensis
95          TBM         Dicentra_canadensis         Dicentra_canadensis
96          TBM         Dicentra_canadensis         Dicentra_canadensis
97          TSC         Chamaedorea_elegans         Chamaedorea_elegans
98          MED       Chamaedorea_radicalis       Chamaedorea_radicalis
99          TGV          Borassus_aethiopum          Borassus_aethiopum
100         TCF                  Poa_alpina                  Poa_alpina
101         MON           Zea_diploperennis           Zea_diploperennis
102         TCF           Danthonia_sericea           Danthonia_sericea
103         DES              Hilaria_mutica              Hilaria_mutica
104         TSC           Catopsis_compacta           Catopsis_compacta
105         TBM             Orchis_purpurea             Orchis_purpurea
106         TCF    Cypripedium_fasciculatum    Cypripedium_fasciculatum
107         TCF    Cypripedium_fasciculatum    Cypripedium_fasciculatum
108         TCF    Cypripedium_fasciculatum    Cypripedium_fasciculatum
109         TBM            Allium_tricoccum            Allium_tricoccum
110         TBM       Trillium_grandiflorum       Trillium_grandiflorum
111         TBM       Trillium_grandiflorum       Trillium_grandiflorum
112         TBM       Trillium_grandiflorum       Trillium_grandiflorum
113         TBM       Trillium_grandiflorum       Trillium_grandiflorum
114         TBM       Trillium_grandiflorum       Trillium_grandiflorum
115         TBM       Trillium_grandiflorum       Trillium_grandiflorum
116         TBM       Trillium_grandiflorum       Trillium_grandiflorum
117         TBM       Trillium_grandiflorum       Trillium_grandiflorum
118         TBM       Trillium_grandiflorum       Trillium_grandiflorum
119         TGS         Calochortus_lyallii         Calochortus_lyallii
120         TBM            Asarum_canadense            Asarum_canadense
121         TBM               Pinus_strobus               Pinus_strobus
              SpeciesAccepted.y Kingdom.y      Phylum.y       Class.y
1        Euphorbia fontqueriana   Plantae Magnoliophyta Magnoliopsida
2          Hypericum cumulicola   Plantae Magnoliophyta Magnoliopsida
3           Agrimonia eupatoria   Plantae Magnoliophyta Magnoliopsida
4            Purshia subintegra   Plantae Magnoliophyta Magnoliopsida
5                Cucurbita pepo   Plantae Magnoliophyta Magnoliopsida
6              Castanea dentata   Plantae  Tracheophyta Magnoliopsida
7              Castanea dentata   Plantae  Tracheophyta Magnoliopsida
8              Castanea dentata   Plantae  Tracheophyta Magnoliopsida
9              Castanea dentata   Plantae  Tracheophyta Magnoliopsida
10             Castanea dentata   Plantae  Tracheophyta Magnoliopsida
11        Astragalus scaphoides   Plantae Magnoliophyta Magnoliopsida
12        Astragalus alopecurus   Plantae Magnoliophyta Magnoliopsida
13      Astragalus tremolsianus   Plantae Magnoliophyta Magnoliopsida
14         Dorycnium spectabile   Plantae Magnoliophyta Magnoliopsida
15         Anthyllis vulneraria   Plantae Magnoliophyta Magnoliopsida
16          Lupinus tidestromii   Plantae Magnoliophyta Magnoliopsida
17          Lupinus tidestromii   Plantae Magnoliophyta Magnoliopsida
18              Lupinus lepidus   Plantae Magnoliophyta Magnoliopsida
19            Carapa guianensis   Plantae Magnoliophyta Magnoliopsida
20               Acer saccharum   Plantae Magnoliophyta Magnoliopsida
21           Alliaria petiolata   Plantae Magnoliophyta Magnoliopsida
22           Alliaria petiolata   Plantae Magnoliophyta Magnoliopsida
23           Alliaria petiolata   Plantae Magnoliophyta Magnoliopsida
24           Alliaria petiolata   Plantae Magnoliophyta Magnoliopsida
25           Alliaria petiolata   Plantae Magnoliophyta Magnoliopsida
26           Alliaria petiolata   Plantae Magnoliophyta Magnoliopsida
27         Sphaeralcea coccinea   Plantae Magnoliophyta Magnoliopsida
28    Helianthemum polygonoides   Plantae Magnoliophyta Magnoliopsida
29      Helianthemum teneriffae   Plantae Magnoliophyta Magnoliopsida
30           Erodium paularense   Plantae Magnoliophyta Magnoliopsida
31           Erodium paularense   Plantae Magnoliophyta Magnoliopsida
32          Oenothera deltoides   Plantae Magnoliophyta Magnoliopsida
33      Saxifraga tridactylites   Plantae Magnoliophyta Magnoliopsida
34           Plantago coronopus   Plantae Magnoliophyta Magnoliopsida
35           Plantago coronopus   Plantae Magnoliophyta Magnoliopsida
36           Plantago coronopus   Plantae Magnoliophyta Magnoliopsida
37     Dracocephalum austriacum   Plantae Magnoliophyta Magnoliopsida
38     Dracocephalum austriacum   Plantae Magnoliophyta Magnoliopsida
39               Ramonda myconi   Plantae Magnoliophyta Magnoliopsida
40               Ramonda myconi   Plantae Magnoliophyta Magnoliopsida
41         Myosotis ramosissima   Plantae Magnoliophyta Magnoliopsida
42        Gentiana pneumonanthe   Plantae Magnoliophyta Magnoliopsida
43         Hypochaeris radicata   Plantae Magnoliophyta Magnoliopsida
44       Echinacea angustifolia   Plantae Magnoliophyta Magnoliopsida
45       Echinacea angustifolia   Plantae Magnoliophyta Magnoliopsida
46       Echinacea angustifolia   Plantae Magnoliophyta Magnoliopsida
47         Ratibida columnifera   Plantae Magnoliophyta Magnoliopsida
48             Liatris scariosa   Plantae Magnoliophyta Magnoliopsida
49             Artemisia genipi   Plantae Magnoliophyta Magnoliopsida
50              Solidago mollis   Plantae Magnoliophyta Magnoliopsida
51             Cirsium palustre   Plantae Magnoliophyta Magnoliopsida
52            Cirsium dissectum   Plantae Magnoliophyta Magnoliopsida
53            Cirsium dissectum   Plantae Magnoliophyta Magnoliopsida
54            Cirsium dissectum   Plantae Magnoliophyta Magnoliopsida
55             Cirsium pitcheri   Plantae Magnoliophyta Magnoliopsida
56             Cirsium pitcheri   Plantae Magnoliophyta Magnoliopsida
57            Cirsium undulatum   Plantae Magnoliophyta Magnoliopsida
58            Jurinea fontqueri   Plantae Magnoliophyta Magnoliopsida
59              Centaurea jacea   Plantae Magnoliophyta Magnoliopsida
60              Centaurea jacea   Plantae Magnoliophyta Magnoliopsida
61     Cheirolophus metlesicsii   Plantae Magnoliophyta Magnoliopsida
62                  Carum carvi   Plantae Magnoliophyta Magnoliopsida
63                  Carum carvi   Plantae Magnoliophyta Magnoliopsida
64            Succisa pratensis   Plantae Magnoliophyta Magnoliopsida
65            Succisa pratensis   Plantae Magnoliophyta Magnoliopsida
66            Succisa pratensis   Plantae Magnoliophyta Magnoliopsida
67            Succisa pratensis   Plantae Magnoliophyta Magnoliopsida
68       Ardisia escallonioides   Plantae Magnoliophyta Magnoliopsida
69           Androsace elongata   Plantae Magnoliophyta Magnoliopsida
70             Primula farinosa   Plantae  Tracheophyta Magnoliopsida
71                Primula veris   Plantae Magnoliophyta Magnoliopsida
72              Primula elatior   Plantae Magnoliophyta Magnoliopsida
73             Primula vulgaris   Plantae Magnoliophyta Magnoliopsida
74             Primula vulgaris   Plantae Magnoliophyta Magnoliopsida
75             Primula vulgaris   Plantae Magnoliophyta Magnoliopsida
76          Sarracenia purpurea   Plantae Magnoliophyta Magnoliopsida
77           Paronychia jamesii   Plantae Magnoliophyta Magnoliopsida
78           Atriplex canescens   Plantae  Tracheophyta Magnoliopsida
79    Neobuxbaumia mezcalaensis   Plantae Magnoliophyta Magnoliopsida
80    Neobuxbaumia mezcalaensis   Plantae Magnoliophyta Magnoliopsida
81    Neobuxbaumia macrocephala   Plantae Magnoliophyta Magnoliopsida
82  Mammillaria huitzilopochtli   Plantae Magnoliophyta Magnoliopsida
83  Mammillaria huitzilopochtli   Plantae Magnoliophyta Magnoliopsida
84      Mammillaria solisioides   Plantae Magnoliophyta Magnoliopsida
85        Ariocarpus fissuratus   Plantae Magnoliophyta Magnoliopsida
86        Ariocarpus fissuratus   Plantae Magnoliophyta Magnoliopsida
87        Escobaria robbinsorum   Plantae Magnoliophyta Magnoliopsida
88              Rumex rupestris   Plantae Magnoliophyta Magnoliopsida
89           Armeria caespitosa   Plantae Magnoliophyta Magnoliopsida
90             Limonium erectum   Plantae Magnoliophyta Magnoliopsida
91          Ranunculus peltatus   Plantae Magnoliophyta Magnoliopsida
92               Actaea spicata   Plantae Magnoliophyta Magnoliopsida
93               Actaea spicata   Plantae Magnoliophyta Magnoliopsida
94          Dicentra canadensis   Plantae  Tracheophyta Magnoliopsida
95          Dicentra canadensis   Plantae  Tracheophyta Magnoliopsida
96          Dicentra canadensis   Plantae  Tracheophyta Magnoliopsida
97          Chamaedorea elegans   Plantae Magnoliophyta    Liliopsida
98        Chamaedorea radicalis   Plantae Magnoliophyta    Liliopsida
99           Borassus aethiopum   Plantae Magnoliophyta    Liliopsida
100                  Poa alpina   Plantae Magnoliophyta    Liliopsida
101           Zea diploperennis   Plantae Magnoliophyta    Liliopsida
102           Danthonia sericea   Plantae Magnoliophyta    Liliopsida
103              Hilaria mutica   Plantae Magnoliophyta    Liliopsida
104           Catopsis compacta   Plantae Magnoliophyta    Liliopsida
105             Orchis purpurea   Plantae Magnoliophyta    Liliopsida
106    Cypripedium fasciculatum   Plantae Magnoliophyta    Liliopsida
107    Cypripedium fasciculatum   Plantae Magnoliophyta    Liliopsida
108    Cypripedium fasciculatum   Plantae Magnoliophyta    Liliopsida
109            Allium tricoccum   Plantae Magnoliophyta    Liliopsida
110       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
111       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
112       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
113       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
114       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
115       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
116       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
117       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
118       Trillium grandiflorum   Plantae Magnoliophyta    Liliopsida
119         Calochortus lyallii   Plantae Magnoliophyta    Liliopsida
120            Asarum canadense   Plantae Magnoliophyta Magnoliopsida
121               Pinus strobus   Plantae     Pinophyta     Pinopsida
           Order.y       OrganismType.y AngioGymno.y Ecoregion.y
1     Malpighiales            Succulent   Angiosperm         MED
2          Theales Herbaceous perennial   Angiosperm         TCF
3          Rosales Herbaceous perennial   Angiosperm         FGS
4          Rosales                Shrub   Angiosperm         DES
5    Curcurbitales               Annual   Angiosperm         TBM
6          Fagales                 Tree   Angiosperm         TBM
7          Fagales                 Tree   Angiosperm         TBM
8          Fagales                 Tree   Angiosperm         TBM
9          Fagales                 Tree   Angiosperm         TBM
10         Fagales                 Tree   Angiosperm         TBM
11         Fabales Herbaceous perennial   Angiosperm         DES
12         Fabales Herbaceous perennial   Angiosperm         TBM
13         Fabales Herbaceous perennial   Angiosperm         MED
14         Fabales Herbaceous perennial   Angiosperm         MED
15         Fabales Herbaceous perennial   Angiosperm         TBM
16         Fabales Herbaceous perennial   Angiosperm         DES
17         Fabales Herbaceous perennial   Angiosperm         DES
18         Fabales Herbaceous perennial   Angiosperm         TCF
19      Sapindales                 Tree   Angiosperm         TMB
20      Sapindales                 Tree   Angiosperm         TBM
21     Brassicales Herbaceous perennial   Angiosperm         TBM
22     Brassicales Herbaceous perennial   Angiosperm         TBM
23     Brassicales Herbaceous perennial   Angiosperm         TBM
24     Brassicales Herbaceous perennial   Angiosperm         TBM
25     Brassicales Herbaceous perennial   Angiosperm         TBM
26     Brassicales Herbaceous perennial   Angiosperm         TBM
27        Malvales Herbaceous perennial   Angiosperm         TGS
28        Malvales Herbaceous perennial   Angiosperm         MED
29        Malvales Herbaceous perennial   Angiosperm         MED
30      Geraniales Herbaceous perennial   Angiosperm         MED
31      Geraniales Herbaceous perennial   Angiosperm         MED
32        Myrtales Herbaceous perennial   Angiosperm         DES
33    Saxifragales               Annual   Angiosperm         TBM
34        Lamiales Herbaceous perennial   Angiosperm         MED
35        Lamiales Herbaceous perennial   Angiosperm         TBM
36        Lamiales Herbaceous perennial   Angiosperm         TBM
37        Lamiales Herbaceous perennial   Angiosperm         TBM
38        Lamiales Herbaceous perennial   Angiosperm         TBM
39        Lamiales Herbaceous perennial   Angiosperm         MED
40        Lamiales Herbaceous perennial   Angiosperm         MED
41        Lamiales               Annual   Angiosperm         TBM
42     Gentianales Herbaceous perennial   Angiosperm         TBM
43       Asterales Herbaceous perennial   Angiosperm         TBM
44       Asterales Herbaceous perennial   Angiosperm         TGS
45       Asterales Herbaceous perennial   Angiosperm         TGS
46       Asterales Herbaceous perennial   Angiosperm         TGS
47       Asterales Herbaceous perennial   Angiosperm         TGS
48       Asterales Herbaceous perennial   Angiosperm         TGS
49       Asterales Herbaceous perennial   Angiosperm         TCF
50       Asterales Herbaceous perennial   Angiosperm         TGS
51       Asterales Herbaceous perennial   Angiosperm         FGS
52       Asterales Herbaceous perennial   Angiosperm         TBM
53       Asterales Herbaceous perennial   Angiosperm         TBM
54       Asterales Herbaceous perennial   Angiosperm         TBM
55       Asterales Herbaceous perennial   Angiosperm         TGS
56       Asterales Herbaceous perennial   Angiosperm         TGS
57       Asterales Herbaceous perennial   Angiosperm         TGS
58       Asterales Herbaceous perennial   Angiosperm         MED
59       Asterales Herbaceous perennial   Angiosperm         TBM
60       Asterales Herbaceous perennial   Angiosperm         TBM
61       Asterales Herbaceous perennial   Angiosperm         MED
62         Apiales Herbaceous perennial   Angiosperm         TBM
63         Apiales Herbaceous perennial   Angiosperm         TBM
64      Dipsacales Herbaceous perennial   Angiosperm         TBM
65      Dipsacales Herbaceous perennial   Angiosperm         TBM
66      Dipsacales Herbaceous perennial   Angiosperm         TBM
67      Dipsacales Herbaceous perennial   Angiosperm         TBM
68        Ericales                Shrub   Angiosperm         TMB
69        Ericales               Annual   Angiosperm         TBM
70        Ericales Herbaceous perennial   Angiosperm         TBM
71        Ericales Herbaceous perennial   Angiosperm         TBM
72        Ericales Herbaceous perennial   Angiosperm         TBM
73        Ericales Herbaceous perennial   Angiosperm         TBM
74        Ericales Herbaceous perennial   Angiosperm         TBM
75        Ericales Herbaceous perennial   Angiosperm         TBM
76        Ericales Herbaceous perennial   Angiosperm         BOR
77  Caryophyllales Herbaceous perennial   Angiosperm         TGS
78  Caryophyllales                Shrub   Angiosperm         DES
79  Caryophyllales            Succulent   Angiosperm         TSC
80  Caryophyllales            Succulent   Angiosperm         DES
81  Caryophyllales            Succulent   Angiosperm         DES
82  Caryophyllales            Succulent   Angiosperm         TGV
83  Caryophyllales            Succulent   Angiosperm         DES
84  Caryophyllales            Succulent   Angiosperm         DES
85  Caryophyllales            Succulent   Angiosperm         DES
86  Caryophyllales            Succulent   Angiosperm         DES
87  Caryophyllales            Succulent   Angiosperm         DES
88  Caryophyllales Herbaceous perennial   Angiosperm         TBM
89  Caryophyllales Herbaceous perennial   Angiosperm         MED
90  Caryophyllales Herbaceous perennial   Angiosperm         MED
91    Ranunculales Herbaceous perennial   Angiosperm         TBM
92    Ranunculales Herbaceous perennial   Angiosperm         TBM
93    Ranunculales Herbaceous perennial   Angiosperm         TBM
94    Ranunculales Herbaceous perennial   Angiosperm         TBM
95    Ranunculales Herbaceous perennial   Angiosperm         TBM
96    Ranunculales Herbaceous perennial   Angiosperm         TBM
97        Arecales                 Palm   Angiosperm         TSC
98        Arecales                 Palm   Angiosperm         MED
99        Arecales                 Palm   Angiosperm         TGV
100         Poales Herbaceous perennial   Angiosperm         TCF
101         Poales Herbaceous perennial   Angiosperm         MON
102         Poales Herbaceous perennial   Angiosperm         TCF
103         Poales Herbaceous perennial   Angiosperm         DES
104         Poales             Epiphyte   Angiosperm         TSC
105    Asparagales Herbaceous perennial   Angiosperm         TBM
106    Asparagales Herbaceous perennial   Angiosperm         TCF
107    Asparagales Herbaceous perennial   Angiosperm         TCF
108    Asparagales Herbaceous perennial   Angiosperm         TCF
109    Asparagales Herbaceous perennial   Angiosperm         TBM
110       Liliales Herbaceous perennial   Angiosperm         TBM
111       Liliales Herbaceous perennial   Angiosperm         TBM
112       Liliales Herbaceous perennial   Angiosperm         TBM
113       Liliales Herbaceous perennial   Angiosperm         TBM
114       Liliales Herbaceous perennial   Angiosperm         TBM
115       Liliales Herbaceous perennial   Angiosperm         TBM
116       Liliales Herbaceous perennial   Angiosperm         TBM
117       Liliales Herbaceous perennial   Angiosperm         TBM
118       Liliales Herbaceous perennial   Angiosperm         TBM
119       Liliales Herbaceous perennial   Angiosperm         TGS
120      Piperales Herbaceous perennial   Angiosperm         TBM
121        Pinales                 Tree   Gymnosperm         TBM
                     Binomial.y
1        Euphorbia_fontqueriana
2          Hypericum_cumulicola
3           Agrimonia_eupatoria
4            Purshia_subintegra
5                Cucurbita_pepo
6              Castanea_dentata
7              Castanea_dentata
8              Castanea_dentata
9              Castanea_dentata
10             Castanea_dentata
11        Astragalus_scaphoides
12        Astragalus_alopecurus
13      Astragalus_tremolsianus
14         Dorycnium_spectabile
15         Anthyllis_vulneraria
16          Lupinus_tidestromii
17          Lupinus_tidestromii
18              Lupinus_lepidus
19            Carapa_guianensis
20               Acer_saccharum
21           Alliaria_petiolata
22           Alliaria_petiolata
23           Alliaria_petiolata
24           Alliaria_petiolata
25           Alliaria_petiolata
26           Alliaria_petiolata
27         Sphaeralcea_coccinea
28    Helianthemum_polygonoides
29      Helianthemum_teneriffae
30           Erodium_paularense
31           Erodium_paularense
32          Oenothera_deltoides
33      Saxifraga_tridactylites
34           Plantago_coronopus
35           Plantago_coronopus
36           Plantago_coronopus
37     Dracocephalum_austriacum
38     Dracocephalum_austriacum
39               Ramonda_myconi
40               Ramonda_myconi
41         Myosotis_ramosissima
42        Gentiana_pneumonanthe
43         Hypochaeris_radicata
44       Echinacea_angustifolia
45       Echinacea_angustifolia
46       Echinacea_angustifolia
47         Ratibida_columnifera
48             Liatris_scariosa
49             Artemisia_genipi
50              Solidago_mollis
51             Cirsium_palustre
52            Cirsium_dissectum
53            Cirsium_dissectum
54            Cirsium_dissectum
55             Cirsium_pitcheri
56             Cirsium_pitcheri
57            Cirsium_undulatum
58            Jurinea_fontqueri
59              Centaurea_jacea
60              Centaurea_jacea
61     Cheirolophus_metlesicsii
62                  Carum_carvi
63                  Carum_carvi
64            Succisa_pratensis
65            Succisa_pratensis
66            Succisa_pratensis
67            Succisa_pratensis
68       Ardisia_escallonioides
69           Androsace_elongata
70             Primula_farinosa
71                Primula_veris
72              Primula_elatior
73             Primula_vulgaris
74             Primula_vulgaris
75             Primula_vulgaris
76          Sarracenia_purpurea
77           Paronychia_jamesii
78           Atriplex_canescens
79    Neobuxbaumia_mezcalaensis
80    Neobuxbaumia_mezcalaensis
81    Neobuxbaumia_macrocephala
82  Mammillaria_huitzilopochtli
83  Mammillaria_huitzilopochtli
84      Mammillaria_solisioides
85        Ariocarpus_fissuratus
86        Ariocarpus_fissuratus
87        Escobaria_robbinsorum
88              Rumex_rupestris
89           Armeria_caespitosa
90             Limonium_erectum
91          Ranunculus_peltatus
92               Actaea_spicata
93               Actaea_spicata
94          Dicentra_canadensis
95          Dicentra_canadensis
96          Dicentra_canadensis
97          Chamaedorea_elegans
98        Chamaedorea_radicalis
99           Borassus_aethiopum
100                  Poa_alpina
101           Zea_diploperennis
102           Danthonia_sericea
103              Hilaria_mutica
104           Catopsis_compacta
105             Orchis_purpurea
106    Cypripedium_fasciculatum
107    Cypripedium_fasciculatum
108    Cypripedium_fasciculatum
109            Allium_tricoccum
110       Trillium_grandiflorum
111       Trillium_grandiflorum
112       Trillium_grandiflorum
113       Trillium_grandiflorum
114       Trillium_grandiflorum
115       Trillium_grandiflorum
116       Trillium_grandiflorum
117       Trillium_grandiflorum
118       Trillium_grandiflorum
119         Calochortus_lyallii
120            Asarum_canadense
121               Pinus_strobus</code></pre>
</div>
</div>
<section id="ranking-buffering" class="level2">
<h2 class="anchored" data-anchor-id="ranking-buffering">10.1 Ranking buffering</h2>
<p>Rank more and less buffered populations. Again sum of stochastic elasticity within respect to variance <span class="math inline">\(| \sum E_v^\sigma |\)</span> is used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------------</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   RANKING BUFFERING</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#-----------------------------------------------------------------------------------</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>ToRank<span class="ot">&lt;-</span>final_data<span class="sc">%&gt;%</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">Cumulative_SigElas=</span><span class="fu">abs</span>(Cumulative_SigElas))<span class="sc">%&gt;%</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Kingdom)<span class="sc">%&gt;%</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(ID,Cumulative_SigElas,SpeciesAccepted,AngioGymno,Class)<span class="sc">%&gt;%</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank  =</span> <span class="fu">rank</span>(Cumulative_SigElas, <span class="at">ties.method =</span> <span class="st">"random"</span>))</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>ToRank<span class="ot">&lt;-</span>ToRank<span class="sc">%&gt;%</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Kingdom)<span class="sc">%&gt;%</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">min=</span><span class="fu">min</span>(Cumulative_SigElas),</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">max=</span><span class="fu">max</span>(Cumulative_SigElas))<span class="sc">%&gt;%</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(rank<span class="sc">==</span><span class="fu">min</span>(rank)<span class="sc">|</span>rank<span class="sc">==</span><span class="fu">max</span>(rank))<span class="sc">%&gt;%</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(min,max))<span class="sc">%&gt;%</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,Metadata<span class="sc">%&gt;%</span><span class="fu">select</span>(ID, CommonName,Family)<span class="sc">%&gt;%</span><span class="fu">distinct</span>(),<span class="at">by=</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">9</span>)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>ToRank<span class="sc">%&gt;%</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,ElasSigVR_full,<span class="at">by=</span><span class="st">"ID"</span>)<span class="sc">%&gt;%</span><span class="fu">mutate_if</span>(is.numeric,round,<span class="dv">3</span>)<span class="sc">%&gt;%</span><span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 21
# Groups:   Kingdom [1]
  Kingdom ID           Cumulative_SigElas  rank SpeciesAccepted AngioGymno Class
  &lt;chr&gt;   &lt;chr&gt;                     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;
1 Plantae Rmnd.445_12…               0        1 Ramonda myconi  Angiosperm Magn…
2 Plantae Rtbd.129_12…               2.01   121 Ratibida colum… Angiosperm Magn…
# ℹ 14 more variables: CommonName &lt;chr&gt;, Family &lt;chr&gt;, Mean_Reproduction &lt;dbl&gt;,
#   Mean_Growth &lt;dbl&gt;, Mean_Shrinking &lt;dbl&gt;, Mean_Clonality &lt;dbl&gt;,
#   Mean_Survival &lt;dbl&gt;, Mean_Cumulative &lt;dbl&gt;, SD_Reproduction &lt;dbl&gt;,
#   SD_Growth &lt;dbl&gt;, SD_Shrinking &lt;dbl&gt;, SD_Clonality &lt;dbl&gt;, SD_Survival &lt;dbl&gt;,
#   SD_Cumulative &lt;dbl&gt;</code></pre>
</div>
</div>
<section id="plot" class="level3">
<h3 class="anchored" data-anchor-id="plot">Plot</h3>
<div class="cell" data-result="hide">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">&lt;-</span>Stochslambs<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(final_data<span class="sc">$</span>ID))){</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">&lt;-</span><span class="fu">filter</span>(</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    Metadata,ID<span class="sc">==</span><span class="fu">unique</span>(final_data<span class="sc">$</span>ID)[i])<span class="sc">$</span>mat<span class="sc">%&gt;%</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">matA</span>()<span class="sc">%&gt;%</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stoch.growth.rate</span>(.,<span class="at">maxt =</span> <span class="dv">200</span>,<span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>Stochslambs<span class="sc">$</span>approx[[i]]<span class="ot">&lt;-</span>temp<span class="sc">$</span>approx</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>Stochslambs<span class="sc">$</span>sim[[i]]<span class="ot">&lt;-</span>temp<span class="sc">$</span>sim</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>Stochslambs<span class="sc">$</span>CIlow[[i]]<span class="ot">&lt;-</span>temp<span class="sc">$</span>sim.CI[[<span class="dv">1</span>]]</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>Stochslambs<span class="sc">$</span>CIhigh[[i]]<span class="ot">&lt;-</span>temp<span class="sc">$</span>sim.CI[[<span class="dv">2</span>]]</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co">#add verbose </span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span> <span class="sc">||</span> i<span class="sc">%%</span><span class="dv">40</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">message</span>(<span class="st">"Calculating mean Matrices"</span>, </span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>                 i)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(temp)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>Stochslambs_df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>(final_data<span class="sc">$</span>ID),</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lapply</span>(Stochslambs,cbind))<span class="sc">%&gt;%</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span> <span class="fu">unnest</span>()<span class="sc">%&gt;%</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate_if</span>(is.numeric,exp)<span class="sc">%&gt;%</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(., <span class="at">ID =</span> unique.final_data.ID.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An accessory function is necessary to better represent very small numbers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>scientific_10 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parse</span>(<span class="at">text=</span><span class="fu">gsub</span>(<span class="st">"e"</span>, <span class="st">" %*% 10^"</span>, scales<span class="sc">::</span><span class="fu">scientific_format</span>()(x)))</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">select</span>(ID<span class="sc">:</span>Cumulative_SigElas,Buffmx<span class="sc">:</span>MatRep,OrganismType,Kingdom,lambda)<span class="sc">%&gt;%</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(ID,MatRep<span class="sc">:</span>lambda))<span class="sc">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">values=</span><span class="fu">ifelse</span>(value<span class="sc">==</span><span class="dv">0</span>,<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">1e-7</span>,<span class="fl">1e-7</span>),value))<span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">left_join</span>(.,Stochslambs_df,<span class="at">by=</span><span class="st">'ID'</span>)<span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"Cumulative_SigElas"</span> <span class="sc">&amp;</span> Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a> <span class="co">#filter(!(value&gt;quantile(value,.95)))%&gt;%</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a> <span class="co">#filter(!(value&lt;quantile(value,.025)))%&gt;%</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">y=</span>approx,<span class="at">x=</span><span class="fu">abs</span>(value)))<span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_point(aes(size=sqrt(MatRep),fill=Kingdom),shape=21)</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co">#geom_point(aes(size=sqrt(MatRep),fill=Kingdom),shape=21)+</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>CIlow,<span class="at">ymax=</span>CIhigh),<span class="at">shape=</span><span class="dv">21</span>,<span class="at">fill=</span><span class="st">"#1f9a59"</span>,<span class="at">size=</span>.<span class="dv">9</span>)<span class="sc">+</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">1</span>,<span class="at">linetype=</span><span class="dv">2</span>,<span class="at">color=</span><span class="st">"grey50"</span>,<span class="at">size=</span>.<span class="dv">9</span>)<span class="sc">+</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_continuous</span>(<span class="at">trans =</span><span class="st">'log'</span>,</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.000001</span>,<span class="fl">0.0001</span>,<span class="fl">0.001</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="at">label =</span> scientific_10)<span class="sc">+</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a><span class="co">#annotation_logticks() + </span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a><span class="co">#xlab(expression("(More Buffered)            -       " %&lt;-% "        "~Sigma~"E"^"s"^~mu~"        " %-&gt;%  "       +            (More Labile)")) +</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a><span class="fu">xlab</span>(<span class="fu">bquote</span>(<span class="st">"More Buffered     -         "</span> </span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>    <span class="sc">%&lt;-%</span> <span class="st">"Relatative effect of environmental variation ("</span><span class="sc">~</span> <span class="fu">abs</span>(<span class="fu">sum</span>(E[v]<span class="sc">^</span>sigma))<span class="sc">~</span><span class="st">" )"</span> <span class="sc">%-&gt;%</span>  </span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"       +            More Labile"</span>))<span class="sc">+</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ylab</span>(<span class="fu">bquote</span>(<span class="st">"Stochastic growth rate ("</span><span class="sc">~</span>lambda[s]<span class="sc">~</span><span class="st">")"</span>))<span class="sc">+</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="co">#facet_grid(.~name,scales="free")+</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a><span class="co">#theme(legend.position="top")+</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">21</span>)<span class="sc">+</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">aspect.ratio=</span><span class="dv">6</span><span class="sc">/</span><span class="dv">18</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave(file="Figures/Buffering continuum.svg")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="proportional-contribution" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="proportional-contribution">10.3. Proportional contribution</h2>
<p>Quantify proportional contribution of each vital rate to <span class="math inline">\(| \sum E_v^\sigma |\)</span>. We used percentage <code>RelContrib*100</code> to improve readability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>RelContrib<span class="ot">&lt;-</span>final_data<span class="sc">%&gt;%</span><span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(ID,Reproduction_SigElas<span class="sc">:</span>Survival_SigElas)<span class="sc">%&gt;%</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_if</span>(is.numeric,abs)<span class="sc">%&gt;%</span>  <span class="co"># Make sure valures are in their absolute form. (This is likely to be removed in next version because it is already done in the final dataset  but confirm before remove this line)</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">NewCumulative=</span><span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric))))<span class="sc">%&gt;%</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co">#mutate_if(is.numeric,round,4)%&gt;%glimpse()</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(ID,NewCumulative))<span class="sc">%&gt;%</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">RelativeProp=</span>(value<span class="sc">/</span>NewCumulative))<span class="sc">%&gt;%</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(.,MetadataClean<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span>lambda)<span class="sc">%&gt;%</span><span class="fu">distinct</span>(),<span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>RelContrib<span class="sc">%&gt;%</span><span class="fu">mutate_if</span>(is.numeric,round,<span class="dv">5</span>)<span class="sc">%&gt;%</span><span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 605 × 14
   ID    NewCumulative name    value RelativeProp SpeciesAccepted Kingdom Phylum
   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;   &lt;chr&gt; 
 1 Ephr…       0.00266 Repr… 0.00037       0.141  Euphorbia font… Plantae Magno…
 2 Ephr…       0.00266 Grow… 0.00076       0.285  Euphorbia font… Plantae Magno…
 3 Ephr…       0.00266 Shri… 0.00003       0.0123 Euphorbia font… Plantae Magno…
 4 Ephr…       0.00266 Clon… 0             0      Euphorbia font… Plantae Magno…
 5 Ephr…       0.00266 Surv… 0.00149       0.562  Euphorbia font… Plantae Magno…
 6 Hypr…       0.191   Repr… 0.0647        0.339  Hypericum cumu… Plantae Magno…
 7 Hypr…       0.191   Grow… 0.00419       0.0220 Hypericum cumu… Plantae Magno…
 8 Hypr…       0.191   Shri… 0.00199       0.0104 Hypericum cumu… Plantae Magno…
 9 Hypr…       0.191   Clon… 0             0      Hypericum cumu… Plantae Magno…
10 Hypr…       0.191   Surv… 0.120         0.629  Hypericum cumu… Plantae Magno…
# ℹ 595 more rows
# ℹ 6 more variables: Class &lt;chr&gt;, Order &lt;chr&gt;, OrganismType &lt;chr&gt;,
#   AngioGymno &lt;chr&gt;, Ecoregion &lt;chr&gt;, Binomial &lt;chr&gt;</code></pre>
</div>
</div>
<section id="kingdoms" class="level3">
<h3 class="anchored" data-anchor-id="kingdoms">10.3.1 Kingdoms</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>RelContrib_df<span class="ot">&lt;-</span>RelContrib<span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(name,Kingdom)<span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="at">Relativemean=</span><span class="fu">mean</span>(RelativeProp),   <span class="co">#Relative contribution (mean for each kingdom)</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">SD=</span><span class="fu">sd</span>(RelativeProp),</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>RelContrib_df<span class="sc">%&gt;%</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Relativemean=</span>Relativemean<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">SD=</span>SD<span class="sc">*</span><span class="dv">100</span>)<span class="sc">%&gt;%</span><span class="fu">mutate_if</span>(is.numeric,round,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
# Groups:   name [5]
  name                 Kingdom Relativemean    SD     n
  &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Clonality_SigElas    Plantae         4.82  18.6   121
2 Growth_SigElas       Plantae        21.1   21.0   121
3 Reproduction_SigElas Plantae        18.1   27.1   121
4 Shrinking_SigElas    Plantae         5.67  10.1   121
5 Survival_SigElas     Plantae        50.3   27.6   121</code></pre>
</div>
</div>
<section id="by-organism-types" class="level4">
<h4 class="anchored" data-anchor-id="by-organism-types">By Organism types</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Relative contribution by organismType</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>RelContrib_orgType<span class="ot">&lt;-</span>RelContrib<span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Taxa=</span><span class="fu">ifelse</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>, OrganismType,Phylum))<span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Kingdom,name,Taxa)<span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Relativemean=</span><span class="fu">mean</span>(RelativeProp),</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD=</span><span class="fu">sd</span>(RelativeProp))</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>RelContrib_orgType<span class="sc">%&gt;%</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Relativemean=</span>(Relativemean<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">SD=</span>SD<span class="sc">*</span><span class="dv">100</span>)<span class="sc">%&gt;%</span><span class="fu">mutate_if</span>(is.numeric,round,<span class="dv">3</span>)<span class="sc">%&gt;%</span><span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>)<span class="sc">%&gt;%</span><span class="fu">ungroup</span>()<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">-</span>Kingdom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 5
   name              Taxa                 Relativemean     n     SD
   &lt;chr&gt;             &lt;chr&gt;                       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Clonality_SigElas Annual                      0         4  0    
 2 Clonality_SigElas Epiphyte                    0         1 NA    
 3 Clonality_SigElas Herbaceous perennial        6.3      92 21.1  
 4 Clonality_SigElas Palm                        1.05      3  1.83 
 5 Clonality_SigElas Shrub                       0         3  0    
 6 Clonality_SigElas Succulent                   0        10  0    
 7 Clonality_SigElas Tree                        0         8  0    
 8 Growth_SigElas    Annual                      0.041     4  0.081
 9 Growth_SigElas    Epiphyte                    1.77      1 NA    
10 Growth_SigElas    Herbaceous perennial       20.7      92 22.1  
# ℹ 25 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="plots" class="level3 tabset">
<h3 class="tabset anchored" data-anchor-id="plots">10.3.3. Plots</h3>
<p>Plots need editing on proper software.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>taxaLev<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Chordata"</span>,<span class="st">"Arthropoda"</span>,<span class="st">"Cnidaria"</span>,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Annual"</span>,<span class="st">"Herbaceous perennial"</span>,<span class="st">"Succulent"</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Epiphyte"</span>,<span class="st">"Shrub"</span>,<span class="st">"Tree"</span>,<span class="st">"Palm"</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>traitLev<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Cumulative"</span>,<span class="st">"Survival"</span>,<span class="st">"Reproduction"</span>,<span class="st">"Growth"</span>,<span class="st">"Shrinking"</span>,<span class="st">"Clonality"</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>plotbuff_data<span class="ot">&lt;-</span>final_data<span class="sc">%&gt;%</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">Taxa=</span><span class="fu">ifelse</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>, OrganismType,Phylum))<span class="sc">%&gt;%</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="fu">c</span>(Reproduction_SigElas<span class="sc">:</span>Survival_Base),MatRep,Kingdom,Taxa)<span class="sc">%&gt;%</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(Kingdom,MatRep,Taxa),<span class="at">names_to=</span><span class="st">"Variable"</span>,<span class="at">values_to=</span><span class="st">"Value"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(Kingdom,Taxa,Variable)<span class="sc">%&gt;%</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="at">Mean=</span><span class="fu">mean</span>(Value),</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">SD=</span><span class="fu">sd</span>(Value),</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">Populations=</span><span class="fu">n</span>(),</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">MatRep=</span><span class="fu">sum</span>(MatRep),</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">SE=</span>SD<span class="sc">/</span><span class="fu">sqrt</span>(Populations),</span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">CI=</span><span class="fl">1.96</span><span class="sc">*</span>(SD<span class="sc">/</span><span class="fu">sqrt</span>(Populations)))<span class="sc">%&gt;%</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(Variable, <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Form"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">Taxa =</span> <span class="fu">factor</span>(Taxa , <span class="at">levels =</span> taxaLev))<span class="sc">%&gt;%</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">Variable =</span> <span class="fu">factor</span>(Variable, <span class="at">levels =</span> traitLev))</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="co">#plotbuff_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="edited-figure-for-plants" class="level4">
<h4 class="anchored" data-anchor-id="edited-figure-for-plants">Edited figure for plants</h4>
</section>
<section id="plot-elasticities" class="level4">
<h4 class="anchored" data-anchor-id="plot-elasticities">Plot Elasticities</h4>
<p>Plot shows stochastic elasticities of each vital rate (A) and its relative effect on <span class="math inline">\(\lambda_{s}\)</span>, it means <span class="math inline">\(E_{v}^\sigma\)</span></p>
<!--# mutate(IsMean="NO") it is important to highlight what points represent the mean for the Kingdom-->
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>plotbuff<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  plotbuff_data<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">IsMean=</span><span class="st">"NO"</span>),</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  final_data<span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">c</span>(Reproduction_SigElas<span class="sc">:</span>Survival_Base),MatRep,Kingdom)<span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(Kingdom,MatRep),<span class="at">names_to=</span><span class="st">"Variable"</span>,<span class="at">values_to=</span><span class="st">"Value"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Kingdom,Variable)<span class="sc">%&gt;%</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Mean=</span><span class="fu">mean</span>(Value),</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">SD=</span><span class="fu">sd</span>(Value),</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">Populations=</span><span class="fu">n</span>(),</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">MatRep=</span><span class="fu">sum</span>(MatRep),</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">SE=</span>SD<span class="sc">/</span><span class="fu">sqrt</span>(Populations),</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">CI=</span><span class="fl">1.96</span><span class="sc">*</span>(SD<span class="sc">/</span><span class="fu">sqrt</span>(Populations)))<span class="sc">%&gt;%</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">separate</span>(Variable, <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Form"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Taxa =</span><span class="fu">ifelse</span>(Kingdom<span class="sc">==</span><span class="st">"Animalia"</span>, <span class="st">"All_animals"</span>,<span class="st">"All_plants"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">IsMean=</span><span class="st">"YES"</span>)</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>)<span class="sc">%&gt;%</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Taxa=</span><span class="fu">fct_relevel</span>(Taxa, <span class="st">"All_plants"</span>, <span class="st">"All_animals"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  filter(Form=="Base")%&gt;%</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variable=</span><span class="fu">factor</span>(Variable, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Cumulative"</span>,<span class="st">"Survival"</span>, <span class="st">"Growth"</span>, <span class="st">"Shrinking"</span>, <span class="st">"Reproduction"</span>,<span class="st">"Clonality"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Variable,<span class="at">y=</span>Mean,<span class="at">group=</span>Taxa))<span class="sc">+</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.4</span>),</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">ymin =</span> Mean<span class="sc">-</span>SE, <span class="at">ymax =</span> Mean<span class="sc">+</span>SE,</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fill=</span>Taxa,<span class="at">shape=</span>Kingdom,<span class="at">color=</span>IsMean),<span class="at">linewidth =</span> <span class="fl">1.3</span>,<span class="at">size=</span> <span class="fl">1.1</span>,<span class="at">alpha=</span>.<span class="dv">9</span>)<span class="sc">+</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">21</span>))<span class="sc">+</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))<span class="sc">+</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_viridis_d()+</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#guides(fill = guide_legend(override.aes=list(shape=c(23,21))))+</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span> <span class="st">"none"</span>,</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">shape=</span><span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">21</span>),<span class="at">alpha=</span><span class="dv">1</span>)))<span class="sc">+</span></span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size=</span><span class="dv">18</span>)<span class="sc">+</span></span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Form<span class="sc">~</span>Kingdom,<span class="at">scales=</span><span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>plotbuff_base<span class="ot">&lt;-</span>plotbuff_sigElas<span class="ot">&lt;-</span>plotbuff</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>plotbuff_base<span class="sc">$</span>data<span class="ot">&lt;-</span>plotbuff<span class="sc">$</span>data<span class="sc">%&gt;%</span></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Form<span class="sc">==</span><span class="st">"Base"</span>)</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>plotbuff_base</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-proportional-contribution" class="level4">
<h4 class="anchored" data-anchor-id="plot-proportional-contribution">Plot proportional contribution</h4>
<p>Proportional contribution of each <span class="math inline">\(|E_{v}^\sigma|\)</span> to <span class="math inline">\(|\sum E_{v}^\sigma|\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>RelContrib_plot<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  RelContrib_orgType<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">IsMean=</span><span class="st">"NO"</span>),</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  RelContrib_df<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">Taxa =</span><span class="fu">ifelse</span>(Kingdom<span class="sc">==</span><span class="st">"Animalia"</span>, <span class="st">"All_animals"</span>,<span class="st">"All_plants"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">IsMean=</span><span class="st">"YES"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(Kingdom<span class="sc">==</span><span class="st">"Plantae"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_remove</span>(name, <span class="st">"_SigElas"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Cumulative"</span>,<span class="st">"Survival"</span>, <span class="st">"Growth"</span>, <span class="st">"Shrinking"</span>, <span class="st">"Reproduction"</span>,<span class="st">"Clonality"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Taxa=</span><span class="fu">fct_relevel</span>(Taxa, <span class="st">"All_plants"</span>, <span class="st">"All_animals"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Form=</span><span class="st">"SigElas"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(Kingdom=="Plantae")%&gt;%</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>Relativemean))<span class="sc">+</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.4</span>),</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">ymin =</span> <span class="fu">pmax</span>(Relativemean<span class="sc">-</span>SD, <span class="dv">0</span>), <span class="at">ymax =</span> <span class="fu">pmin</span>(Relativemean<span class="sc">+</span>SD, <span class="dv">1</span>),</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fill=</span>Taxa,<span class="at">group=</span>Taxa,<span class="at">color=</span>IsMean),<span class="at">shape=</span><span class="dv">21</span>,<span class="at">linewidth =</span> <span class="dv">1</span>,<span class="at">size=</span> <span class="fl">1.1</span>,<span class="at">alpha=</span>.<span class="dv">9</span>)<span class="sc">+</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">23</span>,<span class="dv">21</span>))<span class="sc">+</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))<span class="sc">+</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())<span class="sc">+</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_color_viridis_d()+</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#guides(fill = guide_legend(override.aes=list(shape=c(23,21))))+</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># guides(</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#    alpha= "none",</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill = guide_legend(</span></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#    override.aes=list(shape=rep(c(23, 21), </span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                length.out=nlevels(factor(RelContrib$OrganismType))), alpha=1)))+</span></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>(<span class="at">base_size=</span><span class="dv">18</span>)<span class="sc">+</span></span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Form<span class="sc">~</span>Kingdom,<span class="at">scales=</span><span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>RelContrib_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="raw-figure" class="level4">
<h4 class="anchored" data-anchor-id="raw-figure">Raw figure</h4>
<p>Provide the raw figure for posterior editing in proper software</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_widths=</span><span class="fu">c</span>(.<span class="dv">7</span>,.<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">1</span>,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>        plotbuff_base<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Vital rate elasticity ( "</span>,E[v],<span class="st">" )"</span>))),</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>        RelContrib_plot<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="fu">bquote</span>(<span class="st">"Proportional contribution to ("</span><span class="sc">~</span> <span class="fu">sum</span>(E[v]<span class="sc">^</span>sigma)<span class="sc">~</span><span class="st">" )"</span>)),</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol=</span><span class="dv">2</span>,<span class="at">labels=</span><span class="st">"AUTO"</span>),</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">get_legend</span>(plotbuff_base)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="1536"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="mcmcglmm-results-and-tidy" class="level1">
<h1>11. MCMCglmm results and tidy</h1>
<p>Use <code>Data/MCMCglmm_output.rds</code> to check estimates and hypotheses testing</p>
<section id="loading-glmm-outputs" class="level2">
<h2 class="anchored" data-anchor-id="loading-glmm-outputs">11.1 Loading GLMM outputs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>MCMCglmm_output<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">"Data/MCMCglmm_output.rds"</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(MCMCglmm_output,names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Simple_models
[1] "Plants"  "Animals"

$Phylogenetic_models
[1] "Plants"  "Animals"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Phylogenetic models</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>MCMCglmm_phylo_plants<span class="ot">&lt;-</span>MCMCglmm_output<span class="sc">$</span>Phylogenetic_models[[<span class="dv">1</span>]]</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-Phylogenetic (simple) models</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>MCMCglmm_simple_plants<span class="ot">&lt;-</span>MCMCglmm_output<span class="sc">$</span>Simple_models[[<span class="dv">1</span>]]</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(MCMCglmm_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-harmonization" class="level2">
<h2 class="anchored" data-anchor-id="data-harmonization">11.2. Data Harmonization</h2>
</section>
<section id="as-summary" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="as-summary">11.2.1 As summary</h2>
<!--REMOVED:
Output shows all `pMCMC<=0.1` for each model for each vital rate
It works better for script but not for notebook/markdown report
-->
<p>Use this for data summary along the text</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>Phylo_models_plants<span class="ot">&lt;-</span><span class="fu">lapply</span>(MCMCglmm_phylo_plants,<span class="cf">function</span>(inner_list) <span class="fu">summary</span>(inner_list))</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>Simple_models_plants<span class="ot">&lt;-</span><span class="fu">lapply</span>(MCMCglmm_simple_plants,<span class="cf">function</span>(inner_list) <span class="fu">summary</span>(inner_list))</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>Phylo_models_plants_coefs<span class="ot">&lt;-</span><span class="fu">lapply</span>(Phylo_models_plants,<span class="cf">function</span>(inner_list) inner_list[[<span class="dv">5</span>]])</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>Simple_models_plants_coefs<span class="ot">&lt;-</span><span class="fu">lapply</span>(Simple_models_plants,<span class="cf">function</span>(inner_list) inner_list[[<span class="dv">5</span>]])</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>Phylo_models_plants_coefs<span class="ot">&lt;-</span><span class="fu">lapply</span>(Phylo_models_plants_coefs,as.data.frame)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>Simple_models_plants_coefs<span class="ot">&lt;-</span><span class="fu">lapply</span>(Simple_models_plants_coefs,as.data.frame)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>Phylo_models_df_plants<span class="ot">&lt;-</span><span class="fu">lapply</span>(Phylo_models_plants_coefs,rownames_to_column, <span class="at">var =</span> <span class="st">"Statistics"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Map</span>(cbind, <span class="at">Trait =</span> <span class="fu">names</span>(.),<span class="at">Taxa=</span><span class="st">"Plants"</span>, <span class="at">Model=</span><span class="st">"Phylo"</span>, .)<span class="sc">%&gt;%</span><span class="fu">do.call</span>(rbind,.)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>Simple_models_df_plants<span class="ot">&lt;-</span><span class="fu">lapply</span>(Simple_models_plants_coefs,rownames_to_column, <span class="at">var =</span> <span class="st">"Statistics"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Map</span>(cbind, <span class="at">Trait =</span> <span class="fu">names</span>(.),<span class="at">Taxa=</span><span class="st">"Plants"</span>, <span class="at">Model=</span><span class="st">"Simple"</span>, .)<span class="sc">%&gt;%</span><span class="fu">do.call</span>(rbind,.)</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>GLMMs_df<span class="ot">&lt;-</span><span class="fu">rbind</span>(Phylo_models_df_plants,</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>                Simple_models_df_plants)</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(GLMMs_df)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Trait"</span>,<span class="st">"Taxa"</span>,<span class="st">"Model"</span>,<span class="st">"Statistics"</span>,<span class="st">"post.mean"</span>,<span class="st">"low95"</span>,<span class="st">"high95"</span>,<span class="st">"eff.samp"</span>,<span class="st">"pMCMC"</span>)</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------</span></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="co"># -----  SUMMARY SINTHESIS  -----  </span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------------------------------</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>GLMMs_df_summary<span class="ot">&lt;-</span>GLMMs_df<span class="sc">%&gt;%</span></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig=</span><span class="fu">ifelse</span>(pMCMC<span class="sc">&lt;=</span><span class="fl">0.05</span>,<span class="st">"Sig"</span>,<span class="st">"Non-Sig"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Statistics<span class="sc">!=</span><span class="st">"(Intercept)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plants" class="level3">
<h3 class="anchored" data-anchor-id="plants">Plants</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PLANTs x Cumulative only</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>GLMMs_df_summary<span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Taxa<span class="sc">==</span><span class="st">"Plants"</span> <span class="sc">&amp;</span> Trait <span class="sc">==</span> <span class="st">"Cumulative_SigElas"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 10
# Groups:   Trait [1]
   Trait     Taxa  Model Statistics post.mean    low95   high95 eff.samp   pMCMC
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 Cumulati… Plan… Phylo LHPC.1      -0.0105  -0.0205  -2.92e-4    9232. 0.0404 
 2 Cumulati… Plan… Phylo LHPC.2      -0.00525 -0.0225   1.12e-2    9900. 0.533  
 3 Cumulati… Plan… Phylo ClimPC.1     0.0166  -0.0180   4.91e-2    8833. 0.328  
 4 Cumulati… Plan… Phylo ClimPC.2     0.0364   0.0112   6.15e-2    9900. 0.00626
 5 Cumulati… Plan… Phylo LHPC.1:LH…   0.00597 -0.00312  1.46e-2    8631. 0.184  
 6 Cumulati… Plan… Phylo ClimPC.1:…   0.0131  -0.00571  3.25e-2    9900. 0.171  
 7 Cumulati… Plan… Simp… LHPC.1      -0.0178  -0.0394   4.16e-3    9900. 0.112  
 8 Cumulati… Plan… Simp… LHPC.2      -0.0260  -0.0657   1.33e-2    9900. 0.203  
 9 Cumulati… Plan… Simp… ClimPC.1     0.0417   0.0102   7.04e-2    9900. 0.00788
10 Cumulati… Plan… Simp… ClimPC.2     0.0204  -0.0140   5.72e-2    9900  0.258  
11 Cumulati… Plan… Simp… LHPC.1:LH…   0.0227   0.00151  4.26e-2    9900. 0.0311 
12 Cumulati… Plan… Simp… ClimPC.1:…   0.0404   0.0158   6.36e-2    9116. 0.00162
# ℹ 1 more variable: sig &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By vital rates - Plants &amp; Animals</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>GLMMs_df_summary<span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Taxa<span class="sc">==</span><span class="st">"Plants"</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">c</span>(Trait <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Cumulative_SigElas"</span>,<span class="st">"Buffmx"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Trait)<span class="sc">%&gt;%</span><span class="fu">group_split</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;list_of&lt;
  tbl_df&lt;
    Trait     : character
    Taxa      : character
    Model     : character
    Statistics: character
    post.mean : double
    low95     : double
    high95    : double
    eff.samp  : double
    pMCMC     : double
    sig       : character
  &gt;
&gt;[5]&gt;
[[1]]
# A tibble: 12 × 10
   Trait  Taxa  Model Statistics post.mean    low95  high95 eff.samp pMCMC sig  
   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
 1 Clona… Plan… Phylo LHPC.1     -0.00261  -0.00896 0.00331    9565. 0.394 Non-…
 2 Clona… Plan… Phylo LHPC.2     -0.000916 -0.0116  0.00913    9900. 0.863 Non-…
 3 Clona… Plan… Phylo ClimPC.1    0.00158  -0.0104  0.0125    10809. 0.782 Non-…
 4 Clona… Plan… Phylo ClimPC.2   -0.00398  -0.0160  0.00769    9900. 0.505 Non-…
 5 Clona… Plan… Phylo LHPC.1:LH…  0.00120  -0.00427 0.00660    9457. 0.670 Non-…
 6 Clona… Plan… Phylo ClimPC.1:… -0.00174  -0.00935 0.00576   10363. 0.644 Non-…
 7 Clona… Plan… Simp… LHPC.1     -0.000518 -0.00723 0.00632    9900. 0.875 Non-…
 8 Clona… Plan… Simp… LHPC.2     -0.00602  -0.0184  0.00651    9900. 0.341 Non-…
 9 Clona… Plan… Simp… ClimPC.1    0.00183  -0.00759 0.0113     9900. 0.712 Non-…
10 Clona… Plan… Simp… ClimPC.2   -0.00286  -0.0142  0.00823    9900. 0.606 Non-…
11 Clona… Plan… Simp… LHPC.1:LH…  0.000597 -0.00601 0.00674    9900. 0.848 Non-…
12 Clona… Plan… Simp… ClimPC.1:… -0.00194  -0.00971 0.00552    9900. 0.604 Non-…

[[2]]
# A tibble: 12 × 10
   Trait     Taxa  Model Statistics post.mean    low95   high95 eff.samp   pMCMC
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 Growth_S… Plan… Phylo LHPC.1       4.44e-5 -2.83e-3  2.88e-3    9900. 9.79e-1
 2 Growth_S… Plan… Phylo LHPC.2      -1.13e-3 -6.28e-3  3.86e-3   10280. 6.58e-1
 3 Growth_S… Plan… Phylo ClimPC.1    -8.02e-4 -5.83e-3  3.83e-3    9579. 7.53e-1
 4 Growth_S… Plan… Phylo ClimPC.2     5.94e-3  7.03e-4  1.12e-2   10441. 2.67e-2
 5 Growth_S… Plan… Phylo LHPC.1:LH…  -1.82e-5 -2.54e-3  2.62e-3    9900. 9.95e-1
 6 Growth_S… Plan… Phylo ClimPC.1:…  -3.46e-3 -6.85e-3 -1.30e-4   10248. 4.48e-2
 7 Growth_S… Plan… Simp… LHPC.1      -2.15e-4 -1.55e-3  1.20e-3    9900. 7.65e-1
 8 Growth_S… Plan… Simp… LHPC.2      -1.65e-3 -4.14e-3  8.30e-4    9900. 1.93e-1
 9 Growth_S… Plan… Simp… ClimPC.1    -4.68e-4 -2.28e-3  1.54e-3   10368. 6.28e-1
10 Growth_S… Plan… Simp… ClimPC.2     4.79e-3  2.52e-3  6.98e-3    9900. 1.01e-4
11 Growth_S… Plan… Simp… LHPC.1:LH…  -2.03e-4 -1.54e-3  1.04e-3    9900. 7.57e-1
12 Growth_S… Plan… Simp… ClimPC.1:…  -2.77e-3 -4.32e-3 -1.30e-3    9477. 2.02e-4
# ℹ 1 more variable: sig &lt;chr&gt;

[[3]]
# A tibble: 12 × 10
   Trait      Taxa  Model Statistics post.mean    low95  high95 eff.samp   pMCMC
   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 Reproduct… Plan… Phylo LHPC.1     -0.00353  -1.11e-2 0.00355    9900. 0.340  
 2 Reproduct… Plan… Phylo LHPC.2     -0.00341  -1.57e-2 0.00926   10210. 0.590  
 3 Reproduct… Plan… Phylo ClimPC.1    0.00842  -1.35e-2 0.0275     9900. 0.411  
 4 Reproduct… Plan… Phylo ClimPC.2    0.00146  -1.60e-2 0.0190     9900. 0.879  
 5 Reproduct… Plan… Phylo LHPC.1:LH…  0.00411  -2.70e-3 0.0111     9441. 0.230  
 6 Reproduct… Plan… Phylo ClimPC.1:…  0.0109   -1.20e-3 0.0231     9900. 0.0756 
 7 Reproduct… Plan… Simp… LHPC.1     -0.000740 -1.20e-2 0.0110     9900. 0.888  
 8 Reproduct… Plan… Simp… LHPC.2     -0.00187  -2.26e-2 0.0189     9900. 0.856  
 9 Reproduct… Plan… Simp… ClimPC.1    0.0192    2.91e-3 0.0355     9900. 0.0188 
10 Reproduct… Plan… Simp… ClimPC.2   -0.00263  -2.15e-2 0.0158     9900. 0.781  
11 Reproduct… Plan… Simp… LHPC.1:LH…  0.0103   -3.64e-4 0.0212     9900. 0.0628 
12 Reproduct… Plan… Simp… ClimPC.1:…  0.0169    4.47e-3 0.0299     9900. 0.00848
# ℹ 1 more variable: sig &lt;chr&gt;

[[4]]
# A tibble: 12 × 10
   Trait  Taxa  Model Statistics post.mean    low95  high95 eff.samp pMCMC sig  
   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
 1 Shrin… Plan… Phylo LHPC.1       7.97e-5 -2.79e-3 0.00283    9900. 0.952 Non-…
 2 Shrin… Plan… Phylo LHPC.2      -3.92e-5 -4.93e-3 0.00467    9900. 0.991 Non-…
 3 Shrin… Plan… Phylo ClimPC.1     7.37e-4 -3.89e-3 0.00542    9832. 0.759 Non-…
 4 Shrin… Plan… Phylo ClimPC.2    -1.62e-4 -5.15e-3 0.00510    9900  0.958 Non-…
 5 Shrin… Plan… Phylo LHPC.1:LH…   2.93e-4 -2.21e-3 0.00277    9900. 0.814 Non-…
 6 Shrin… Plan… Phylo ClimPC.1:…  -9.03e-5 -3.26e-3 0.00312    9900. 0.949 Non-…
 7 Shrin… Plan… Simp… LHPC.1       2.38e-4 -9.77e-4 0.00151   10376. 0.715 Non-…
 8 Shrin… Plan… Simp… LHPC.2       1.31e-4 -2.06e-3 0.00242    9900. 0.905 Non-…
 9 Shrin… Plan… Simp… ClimPC.1     5.09e-4 -1.22e-3 0.00221    9976. 0.555 Non-…
10 Shrin… Plan… Simp… ClimPC.2    -3.15e-4 -2.35e-3 0.00174    9900  0.760 Non-…
11 Shrin… Plan… Simp… LHPC.1:LH…   3.05e-4 -8.74e-4 0.00145    9900. 0.596 Non-…
12 Shrin… Plan… Simp… ClimPC.1:…   9.29e-5 -1.24e-3 0.00147    9900. 0.889 Non-…

[[5]]
# A tibble: 12 × 10
   Trait      Taxa  Model Statistics post.mean    low95  high95 eff.samp   pMCMC
   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 Survival_… Plan… Phylo LHPC.1       -0.0144 -2.91e-2 8.90e-4    1593. 6.42e-2
 2 Survival_… Plan… Phylo LHPC.2       -0.0172 -4.29e-2 8.72e-3    9224. 1.92e-1
 3 Survival_… Plan… Phylo ClimPC.1      0.0245  3.13e-3 4.78e-2    9599. 3.17e-2
 4 Survival_… Plan… Phylo ClimPC.2      0.0179 -7.86e-3 4.19e-2   10269. 1.53e-1
 5 Survival_… Plan… Phylo LHPC.1:LH…    0.0135  1.88e-4 2.69e-2    4356. 4.46e-2
 6 Survival_… Plan… Phylo ClimPC.1:…    0.0267  1.01e-2 4.31e-2    1785. 2.42e-3
 7 Survival_… Plan… Simp… LHPC.1       -0.0131 -2.70e-2 2.66e-4    9900. 6.18e-2
 8 Survival_… Plan… Simp… LHPC.2       -0.0177 -4.21e-2 7.60e-3    9900. 1.64e-1
 9 Survival_… Plan… Simp… ClimPC.1      0.0249  6.24e-3 4.45e-2   10710. 9.49e-3
10 Survival_… Plan… Simp… ClimPC.2      0.0172 -3.84e-3 3.99e-2    9900. 1.21e-1
11 Survival_… Plan… Simp… LHPC.1:LH…    0.0136  1.06e-3 2.67e-2    9900. 3.68e-2
12 Survival_… Plan… Simp… ClimPC.1:…    0.0284  1.41e-2 4.35e-2    9900. 1.01e-4
# ℹ 1 more variable: sig &lt;chr&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="posterior-distribution" class="level2">
<h2 class="anchored" data-anchor-id="posterior-distribution">11.2.2 Posterior distribution</h2>
<p>Better for figures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>Phylo_posterior_plants<span class="ot">&lt;-</span><span class="fu">lapply</span>(MCMCglmm_phylo_plants,<span class="cf">function</span>(inner_list) <span class="fu">data.frame</span>(inner_list<span class="sc">$</span>Sol,<span class="at">Taxa=</span><span class="st">"Plants"</span>,<span class="at">Model=</span><span class="st">"Phylo"</span>))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>Simple_posterior_plants<span class="ot">&lt;-</span><span class="fu">lapply</span>(MCMCglmm_simple_plants,<span class="cf">function</span>(inner_list) <span class="fu">data.frame</span>(inner_list<span class="sc">$</span>Sol,<span class="at">Taxa=</span><span class="st">"Plants"</span>,<span class="at">Model=</span><span class="st">"Simple"</span>))</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>Posterior_data<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind,Phylo_posterior_plants),</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind,Simple_posterior_plants))<span class="sc">%&gt;%</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(., <span class="at">var =</span> <span class="st">"VAR"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(VAR,<span class="fu">c</span>(<span class="st">"Trait"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span><span class="fu">c</span>(Trait,Taxa,Model),<span class="at">values_to=</span><span class="st">"Values"</span>,<span class="at">names_to=</span><span class="st">"Variables"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variables=</span><span class="fu">ifelse</span>(Variables<span class="sc">==</span><span class="st">"LHPC.1.LHPC.2"</span>,<span class="st">"LHPC.1:LHPC.2"</span>,Variables))<span class="sc">%&gt;%</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Variables=</span><span class="fu">ifelse</span>(Variables<span class="sc">==</span><span class="st">"ClimPC.1.ClimPC.2"</span>,<span class="st">"ClimPC.1:ClimPC.2"</span>,Variables))<span class="sc">%&gt;%</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Variables<span class="sc">!=</span><span class="st">"X.Intercept."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 1 pieces. Additional pieces discarded in 138600 rows [1, 2, 3, 4, 5,
6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>Posterior_data<span class="ot">&lt;-</span><span class="fu">left_join</span>(Posterior_data,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>                          GLMMs_df<span class="sc">%&gt;%</span><span class="fu">separate</span>(Trait,<span class="st">"Trait"</span>),</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Trait"</span>,<span class="st">"Taxa"</span>,<span class="st">"Model"</span>,<span class="st">"Variables"</span><span class="ot">=</span><span class="st">"Statistics"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig=</span><span class="fu">ifelse</span>(pMCMC<span class="sc">&lt;=</span><span class="fl">0.05</span>,<span class="st">"Sig"</span>,<span class="st">"Non-Sig"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected 1 pieces. Additional pieces discarded in 84 rows [1, 2, 3, 4, 5, 6, 7,
8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>Posterior_data<span class="sc">%&gt;%</span><span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 831,600 × 11
   Trait      Taxa  Model Variables   Values post.mean    low95  high95 eff.samp
   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1 Reproduct… Plan… Phylo LHPC.1     2.94e-4  -0.00353 -0.0111  0.00355    9900.
 2 Reproduct… Plan… Phylo LHPC.2    -1.12e-3  -0.00341 -0.0157  0.00926   10210.
 3 Reproduct… Plan… Phylo ClimPC.1   2.26e-2   0.00842 -0.0135  0.0275     9900.
 4 Reproduct… Plan… Phylo ClimPC.2  -1.28e-2   0.00146 -0.0160  0.0190     9900.
 5 Reproduct… Plan… Phylo LHPC.1:L…  1.66e-4   0.00411 -0.00270 0.0111     9441.
 6 Reproduct… Plan… Phylo ClimPC.1…  1.57e-2   0.0109  -0.00120 0.0231     9900.
 7 Reproduct… Plan… Phylo LHPC.1    -2.34e-3  -0.00353 -0.0111  0.00355    9900.
 8 Reproduct… Plan… Phylo LHPC.2    -3.83e-3  -0.00341 -0.0157  0.00926   10210.
 9 Reproduct… Plan… Phylo ClimPC.1  -2.64e-3   0.00842 -0.0135  0.0275     9900.
10 Reproduct… Plan… Phylo ClimPC.2   4.94e-3   0.00146 -0.0160  0.0190     9900.
# ℹ 831,590 more rows
# ℹ 2 more variables: pMCMC &lt;dbl&gt;, sig &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="ggplot-posterior-distribution" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="ggplot-posterior-distribution">11.3. GGPLOT Posterior distribution</h2>
<section id="code" class="level3">
<h3 class="anchored" data-anchor-id="code">Code</h3>
<p>Code only</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>ggplot_posteriors<span class="ot">&lt;-</span>Posterior_data<span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Trait<span class="sc">!=</span><span class="st">"Buffmx"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait =</span> <span class="fu">factor</span>(Trait , <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Cumulative"</span>, <span class="st">"Survival"</span>,<span class="st">"Growth"</span>,<span class="st">"Shrinking"</span>, <span class="st">"Reproduction"</span>, <span class="st">"Clonality"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(.,<span class="fu">aes</span>(<span class="at">x=</span>Variables,<span class="at">y=</span>Values,<span class="at">group=</span>Model))<span class="sc">+</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">2</span>,<span class="at">color=</span><span class="st">"grey50"</span>,<span class="at">linewidth=</span><span class="fl">1.4</span>)<span class="sc">+</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pointinterval</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">5</span>),<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">66</span>, .<span class="dv">95</span>),</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> Variables,<span class="at">color=</span>sig,<span class="at">shape=</span>Model,<span class="at">fill=</span>Model,<span class="at">alpha=</span>sig))<span class="sc">+</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values=</span><span class="fu">c</span>(.<span class="dv">2</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#da1438"</span>,<span class="st">"#a783ce"</span>))<span class="sc">+</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"grey30"</span>,<span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">21</span>))<span class="sc">+</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Variables"</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"Posterior distribution"</span>)<span class="sc">+</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  ggh4x<span class="sc">::</span><span class="fu">facet_grid2</span>(Trait<span class="sc">~</span>Taxa,<span class="at">scales=</span><span class="st">"free_x"</span>,<span class="at">independent =</span> <span class="st">"x"</span>)<span class="sc">+</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">16</span>)<span class="sc">+</span><span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axis.text.x = element_text(angle = 45, hjust=1),</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position=</span><span class="st">"top"</span>)<span class="sc">+</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)))</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>ggplot_posteriors_vr<span class="ot">&lt;-</span>ggplot_posteriors_cumu<span class="ot">&lt;-</span>ggplot_posteriors</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>ggplot_posteriors_cumu<span class="sc">$</span>data<span class="ot">&lt;-</span><span class="fu">filter</span>(ggplot_posteriors<span class="sc">$</span>data,Taxa<span class="sc">==</span><span class="st">"Plants"</span> <span class="sc">&amp;</span> Trait <span class="sc">==</span> <span class="st">"Cumulative"</span>)</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>ggplot_posteriors_vr<span class="sc">$</span>data<span class="ot">&lt;-</span><span class="fu">filter</span>(ggplot_posteriors<span class="sc">$</span>data,Taxa<span class="sc">==</span><span class="st">"Plants"</span> <span class="sc">&amp;</span> Trait <span class="sc">!=</span> <span class="st">"Cumulative"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cumulative" class="level3">
<h3 class="anchored" data-anchor-id="cumulative">Cumulative</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  cumulative  &amp; Plants only</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>ggplot_posteriors_cumu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="vital-rates" class="level3">
<h3 class="anchored" data-anchor-id="vital-rates">Vital rates</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  cumulative vr &amp; Plants only</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>ggplot_posteriors_vr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="estimating-phylogenetic-signal" class="level1">
<h1>12. Estimating Phylogenetic signal</h1>
<!-- #          PHYLO 1
# No longer necessary but I Don't why it was necessary
# Exclude in next versions
#Phylo_df<-lapply(Phylo_models_plants,function(inner_list) inner_list[[6]])%>%
#  Map(cbind, Trait = names(.),.)%>%do.call(rbind,.)%>%
#  as_tibble()%>%
#  mutate(across(c("post.mean":"eff.samp"),as.numeric))
-->
<section id="create-an-anxiliary-function-creates-the-new-anxilliary-function-my.fake.lamb." class="level2">
<h2 class="anchored" data-anchor-id="create-an-anxiliary-function-creates-the-new-anxilliary-function-my.fake.lamb.">11.1. Create an anxiliary function Creates the new anxilliary function <code>my.fake.lamb</code>.</h2>
<p>This function was created based on <span class="citation" data-cites="garamszegi2014">Garamszegi (<a href="#ref-garamszegi2014" role="doc-biblioref">2014</a>)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>my.fake.lamb<span class="ot">&lt;-</span><span class="cf">function</span>(model){</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span>  model<span class="sc">$</span>VCV[,<span class="st">"phylo"</span>]<span class="sc">/</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    (model<span class="sc">$</span>VCV[,<span class="st">"phylo"</span>]<span class="sc">+</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>       <span class="co">#            model$VCV[,"species"]+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>       model<span class="sc">$</span>VCV[,<span class="st">"units"</span>])</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  mean.Lambda<span class="ot">=</span><span class="fu">mean</span>(out)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  SE.lambda<span class="ot">=</span>(<span class="fu">sd</span>(out)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(out)))</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimating-phylogenetic-signal-for-all-models" class="level2">
<h2 class="anchored" data-anchor-id="estimating-phylogenetic-signal-for-all-models">12.2. Estimating phylogenetic signal for all models</h2>
<p>Code below use <code>my.fake.lamb</code> to estimate phylogenetic signal for all models in a list.</p>
<p>package <code>ggridges</code> is necessary. Dependency for <code>geom_density_ridges</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#InterestingVars&lt;-c("Survival","Growth","Shrinking","Reproduction","Clonality","Buffmx","Cumulative")</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>traits<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Reproduction_SigElas"</span>, <span class="st">"Growth_SigElas"</span>, <span class="st">"Shrinking_SigElas"</span>,  <span class="st">"Clonality_SigElas"</span>, <span class="st">"Survival_SigElas"</span>,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Cumulative_SigElas"</span>,<span class="st">"Buffmx"</span>)  </span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply(MCMCglmm_phylo_animals,function(inner_list) inner_list$VCV)</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>Phylo_signal_plants<span class="ot">&lt;-</span><span class="fu">lapply</span>(MCMCglmm_phylo_plants,<span class="cf">function</span>(inner_list) <span class="fu">as.data.frame</span>(<span class="fu">my.fake.lamb</span>(inner_list)))<span class="sc">%&gt;%</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(cbind,.)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Phylo_signal_plants)<span class="ot">&lt;-</span><span class="fu">str_split_i</span>(traits, <span class="st">"_"</span>, <span class="dv">1</span>)</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>Phylo_signal_df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(Phylo_signal_plants,<span class="at">Taxa=</span><span class="st">"Plants"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>Taxa,<span class="at">names_to=</span><span class="st">"Trait"</span>,<span class="at">values_to=</span><span class="st">"Values"</span>)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>Phylo_signal_df<span class="sc">%&gt;%</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Taxa,Trait)<span class="sc">%&gt;%</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mean=</span><span class="fu">mean</span>(Values),</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD=</span><span class="fu">sd</span>(Values),</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">N=</span><span class="fu">n</span>(),</span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">gaussianCI=</span><span class="fl">1.96</span><span class="sc">*</span>(SD<span class="sc">/</span><span class="fu">sqrt</span>(N)),</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower95=</span><span class="fu">quantile</span>(Values,.<span class="dv">025</span>),</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">higher95=</span><span class="fu">quantile</span>(Values,.<span class="dv">975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Taxa'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 8
# Groups:   Taxa [1]
  Taxa   Trait         Mean     SD     N gaussianCI lower95 higher95
  &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1 Plants Buffmx       0.570 0.173   9900   0.00340    0.235    0.849
2 Plants Clonality    0.815 0.0575  9900   0.00113    0.677    0.902
3 Plants Cumulative   0.991 0.0193  9900   0.000381   0.985    0.996
4 Plants Growth       0.658 0.0552  9900   0.00109    0.545    0.759
5 Plants Reproduction 0.969 0.0125  9900   0.000247   0.937    0.985
6 Plants Shrinking    0.669 0.0538  9900   0.00106    0.558    0.768
7 Plants Survival     0.267 0.143   9900   0.00281    0.107    0.610</code></pre>
</div>
</div>
</section>
<section id="comparing-phylogenetic-signal" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="comparing-phylogenetic-signal">12.3. Comparing phylogenetic signal</h2>
<p>without significant correlation between phylogenetic signal and contribution to buffering capacity</p>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise phylogenetic signal</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>Phylo_summary <span class="ot">&lt;-</span> Phylo_signal_df <span class="sc">%&gt;%</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Trait <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Cumulative"</span>,<span class="st">"Buffmx"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Taxa,Trait) <span class="sc">%&gt;%</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">MEDIAN =</span> <span class="fu">median</span>(Values),</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sd</span>(Values),</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()) )<span class="sc">%&gt;%</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trait=</span><span class="fu">factor</span>(Trait,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Survival"</span>, <span class="st">"Growth"</span>, <span class="st">"Shrinking"</span>, <span class="st">"Reproduction"</span>, <span class="st">"Clonality"</span>)))</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge phylogenetic signal (summarized) with relative contribution</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>phylo_buffer_df<span class="ot">&lt;-</span><span class="fu">left_join</span>(</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>Phylo_summary<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">Kingdom=</span><span class="fu">ifelse</span>(Taxa<span class="sc">==</span><span class="st">"Animals"</span>, <span class="st">"Animalia"</span>, <span class="st">"Plantae"</span>)),</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>RelContrib_df<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_remove</span>(name, <span class="st">"_SigElas"</span>)),</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a><span class="at">by=</span><span class="fu">c</span>(<span class="st">"Trait"</span> <span class="ot">=</span> <span class="st">"name"</span>, <span class="st">"Kingdom"</span>),<span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">".phylo"</span>, <span class="st">".buffer"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Kingdom)</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="at">method=</span><span class="st">"spearman"</span>,</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phylo_buffer_df,Taxa<span class="sc">==</span><span class="st">"Plants"</span>)<span class="sc">$</span>MEDIAN,</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(phylo_buffer_df,Taxa<span class="sc">==</span><span class="st">"Plants"</span>)<span class="sc">$</span>Relativemean</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Spearman's rank correlation rho</code></pre>
<p>data: filter(phylo_buffer_df, Taxa == “Plants”)<span class="math inline">\(MEDIAN and filter(phylo_buffer_df, Taxa == "Plants")\)</span>Relativemean S = 34, p-value = 0.2333 alternative hypothesis: true rho is not equal to 0 sample estimates: rho -0.7</p>
<p>Detailed values for plants</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>Phylo_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
# Groups:   Taxa [1]
  Taxa   Trait        MEDIAN     SD       SE
  &lt;chr&gt;  &lt;fct&gt;         &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1 Plants Clonality     0.823 0.0575 0.000578
2 Plants Growth        0.660 0.0552 0.000554
3 Plants Reproduction  0.971 0.0125 0.000126
4 Plants Shrinking     0.670 0.0538 0.000541
5 Plants Survival      0.239 0.143  0.00143 </code></pre>
</div>
</div>
<section id="bar-plot" class="level3 tabset">
<h3 class="tabset anchored" data-anchor-id="bar-plot">Bar Plot</h3>
<section id="plants-1" class="level4">
<h4 class="anchored" data-anchor-id="plants-1">Plants</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>Phylo_summary<span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x =</span> Trait, <span class="at">y =</span> MEDIAN, <span class="at">fill =</span> Taxa)) <span class="sc">+</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span>  <span class="co"># Barras com transparência leve</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> MEDIAN <span class="sc">-</span> SD, <span class="at">ymax=</span><span class="fu">pmin</span>(MEDIAN <span class="sc">+</span> SD, <span class="dv">1</span>)), </span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#1f9a59"</span>))<span class="sc">+</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Phylogenetic signal </span><span class="sc">\n</span><span class="st"> (Pagel's lambda)"</span>) <span class="sc">+</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size=</span><span class="dv">18</span>)<span class="sc">+</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="phylo-x-buffer-plot" class="level3">
<h3 class="anchored" data-anchor-id="phylo-x-buffer-plot">Phylo x buffer plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>phylo_buffer_df<span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>.,<span class="fu">aes</span>(<span class="at">x=</span>Relativemean,<span class="at">y=</span>MEDIAN))<span class="sc">+</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>MEDIAN<span class="sc">-</span>SD.phylo,<span class="at">ymax=</span>MEDIAN<span class="sc">+</span>SD.phylo))<span class="sc">+</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Taxa)<span class="sc">+</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Relative contribution to buffering capacity"</span>,</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Phylogenetic signal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="0---Script-Framework_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!--

#### Traceplot if necessary 
It is interesting to show model is fine but it is not required. Think carefully how it can be included in the model and rearrange it if necessary. 


It is likely tracepplot will be moved to model or tidy model so it is closer to where it is required. 

#==========================================================================
#   TRACEPLOT
#==========================================================================

#require(plotMCMC)

Check_traces<-function(X){
  windows(record=TRUE) # opens a window and starts recording
  op <- par(ask=TRUE)
  allChains <- NULL
  for(i in 1:length(X)){
    allChains <-coda::as.mcmc(cbind(X[[i]]$Sol,X[[i]]$VCV))
    plotMCMC::plotTrace(allChains,
                        main=X[[i]]$Fixed$formula,cex.main = .6)
    print ("Click on plot to continue")
    #readline(prompt="Press [enter] to continue")
  }
  windows.options(record=FALSE) #stops recording.
}

#Check_traces(MCMCglmm_phylo_plants)
#Check_traces(MCMCglmm_phylo_animals)
#Check_traces(MCMCglmm_simple_plants)
#Check_traces(MCMCglmm_simple_animals)
-->
</section>
</section>
</section>
<section id="references" class="level1 unnumbered">


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bernard2023" class="csl-entry" role="listitem">
Bernard, Connor, Gabriel Silva Santos, Jacques A. Deere, Roberto Rodriguez-Caro, Pol Capdevila, Erik Kusch, Samuel J. L. Gascoigne, John Jackson, and Roberto Salguero-Gómez. 2023. <span>“MOSAIC - A Unified Trait Database to Complement Structured Population Models.”</span> <em>Scientific Data</em> 10 (1): 335. <a href="https://doi.org/10.1038/s41597-023-02070-w">https://doi.org/10.1038/s41597-023-02070-w</a>.
</div>
<div id="ref-demetrius1974" class="csl-entry" role="listitem">
Demetrius, Lloyd. 1974. <span>“Demographic Parameters and Natural Selection.”</span> <em>Proceedings of the National Academy of Sciences</em> 71 (12): 4645–47. <a href="https://doi.org/10.1073/pnas.71.12.4645">https://doi.org/10.1073/pnas.71.12.4645</a>.
</div>
<div id="ref-garamszegi2014" class="csl-entry" role="listitem">
Garamszegi, László Zsolt. 2014. <em>Modern Phylogenetic Comparative Methods and Their Application in Evolutionary Biology</em>.
</div>
<div id="ref-jones2022" class="csl-entry" role="listitem">
Jones, Owen R., Patrick Barks, Iain Stott, Tamora D. James, Sam Levin, William K. Petry, Pol Capdevila, et al. 2022. <span>“Rcompadre and Rage<span></span>Two R Packages to Facilitate the Use of the COMPADRE and COMADRE Databases and Calculation of Life<span>-</span>History Traits from Matrix Population Models.”</span> <em>Methods in Ecology and Evolution</em> 13 (4): 770–81. <a href="https://doi.org/10.1111/2041-210X.13792">https://doi.org/10.1111/2041-210X.13792</a>.
</div>
<div id="ref-karger2017" class="csl-entry" role="listitem">
Karger, Dirk Nikolaus, Olaf Conrad, Jürgen Böhner, Tobias Kawohl, Holger Kreft, Rodrigo Wilber Soria-Auza, Niklaus E. Zimmermann, H. Peter Linder, and Michael Kessler. 2017. <span>“Climatologies at High Resolution for the Earth<span>’</span>s Land Surface Areas.”</span> <em>Scientific Data</em> 4 (1): 170122. <a href="https://doi.org/10.1038/sdata.2017.122">https://doi.org/10.1038/sdata.2017.122</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Remember that absolute sum of stochastic elasticity within respect to variance <span class="math inline">\(| \sum E_v^\sigma |\)</span> is extremaly important to the analyses because our question is about the demographic position, not what determine the contribution of these vital rates. If we use raw values we could answers other question but not their position about buffering capacity<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>